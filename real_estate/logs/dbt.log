[0m19:44:43.092990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e563350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e650140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4b26f0>]}


============================== 19:44:43.097781 | 161a58b4-0618-4a03-af76-085bc1b3643d ==============================
[0m19:44:43.097781 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:44:43.098209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:44:43.098535 [info ] [MainThread]: dbt version: 1.5.0
[0m19:44:43.098858 [info ] [MainThread]: python version: 3.12.8
[0m19:44:43.099104 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:44:43.099423 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m19:44:43.099663 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m19:44:43.100012 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m19:44:43.100280 [info ] [MainThread]: Configuration:
[0m19:44:43.120344 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m19:44:43.131271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:44:43.131584 [info ] [MainThread]: Required dependencies:
[0m19:44:43.131900 [debug] [MainThread]: Executing "git --help"
[0m19:44:43.132727 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:44:43.132964 [info ] [MainThread]: [31m2 checks failed:[0m
[0m19:44:43.133226 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev" invalid: 'port' is a required property


[0m19:44:43.133492 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m19:44:43.133860 [debug] [MainThread]: Command `dbt debug` failed at 19:44:43.133800 after 0.05 seconds
[0m19:44:43.134062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5b1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e56b8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e563350>]}
[0m19:44:43.134262 [debug] [MainThread]: Flushing usage events
[0m19:47:25.214748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ad7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8364a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830bcb00>]}


============================== 19:47:25.218955 | 568deef3-e2de-4060-bd6f-632d289c9d36 ==============================
[0m19:47:25.218955 [info ] [MainThread]: Running with dbt=1.5.0
[0m19:47:25.219293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:47:25.219640 [info ] [MainThread]: dbt version: 1.5.0
[0m19:47:25.219902 [info ] [MainThread]: python version: 3.12.8
[0m19:47:25.220291 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m19:47:25.220663 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m19:47:25.220943 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m19:47:25.221234 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m19:47:25.221494 [info ] [MainThread]: Configuration:
[0m19:47:25.242840 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:47:25.254501 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:47:25.254808 [info ] [MainThread]: Required dependencies:
[0m19:47:25.255175 [debug] [MainThread]: Executing "git --help"
[0m19:47:25.255809 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m19:47:25.256036 [info ] [MainThread]: Connection:
[0m19:47:25.256308 [info ] [MainThread]:   host: postgres
[0m19:47:25.256552 [info ] [MainThread]:   port: 5432
[0m19:47:25.256825 [info ] [MainThread]:   user: airflow
[0m19:47:25.257086 [info ] [MainThread]:   database: airflow
[0m19:47:25.257379 [info ] [MainThread]:   schema: public
[0m19:47:25.257696 [info ] [MainThread]:   search_path: None
[0m19:47:25.257959 [info ] [MainThread]:   keepalives_idle: 0
[0m19:47:25.258248 [info ] [MainThread]:   sslmode: None
[0m19:47:25.258690 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:47:25.258861 [debug] [MainThread]: Using postgres connection "debug"
[0m19:47:25.259011 [debug] [MainThread]: On debug: select 1 as id
[0m19:47:25.259149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:25.263823 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m19:47:25.264473 [debug] [MainThread]: On debug: Close
[0m19:47:25.264685 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:47:25.264936 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:47:25.265252 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m19:47:25.265832 [debug] [MainThread]: Command `dbt debug` failed at 19:47:25.265736 after 0.06 seconds
[0m19:47:25.266090 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:47:25.266293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830a2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83621070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f04890>]}
[0m19:47:25.266525 [debug] [MainThread]: Flushing usage events
[0m14:16:37.090558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d95190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d96650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc4fd0>]}


============================== 14:16:37.093515 | 589042d8-de80-4839-8baf-553fcff70d52 ==============================
[0m14:16:37.093515 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:16:37.093988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:37.104775 [info ] [MainThread]: dbt version: 1.9.2
[0m14:16:37.105037 [info ] [MainThread]: python version: 3.11.10
[0m14:16:37.105206 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:16:37.105352 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:16:37.151928 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:16:37.152232 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:16:37.152377 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:16:37.152802 [info ] [MainThread]: adapter type: postgres
[0m14:16:37.152933 [info ] [MainThread]: adapter version: 1.9.0
[0m14:16:37.195357 [info ] [MainThread]: Configuration:
[0m14:16:37.195643 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:37.195781 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:16:37.195906 [info ] [MainThread]: Required dependencies:
[0m14:16:37.196077 [debug] [MainThread]: Executing "git --help"
[0m14:16:37.217586 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:16:37.218233 [debug] [MainThread]: STDERR: "b''"
[0m14:16:37.218452 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:16:37.218648 [info ] [MainThread]: Connection:
[0m14:16:37.218836 [info ] [MainThread]:   host: postgres
[0m14:16:37.218959 [info ] [MainThread]:   port: 5432
[0m14:16:37.219086 [info ] [MainThread]:   user: airflow
[0m14:16:37.219200 [info ] [MainThread]:   database: airflow
[0m14:16:37.219314 [info ] [MainThread]:   schema: public
[0m14:16:37.219437 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:37.219581 [info ] [MainThread]:   role: None
[0m14:16:37.219697 [info ] [MainThread]:   search_path: None
[0m14:16:37.219805 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:37.219917 [info ] [MainThread]:   sslmode: None
[0m14:16:37.220028 [info ] [MainThread]:   sslcert: None
[0m14:16:37.220136 [info ] [MainThread]:   sslkey: None
[0m14:16:37.220312 [info ] [MainThread]:   sslrootcert: None
[0m14:16:37.220518 [info ] [MainThread]:   application_name: dbt
[0m14:16:37.220650 [info ] [MainThread]:   retries: 1
[0m14:16:37.221000 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:16:37.287226 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:37.320173 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:37.320422 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:37.320569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:37.338070 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m14:16:37.340666 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:16:37.340834 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:16:37.340997 [debug] [MainThread]: On debug: No close available on handle
[0m14:16:37.341183 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:16:37.341446 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:16:37.341610 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:16:37.342866 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2882657, "process_in_blocks": "0", "process_kernel_time": 0.149108, "process_mem_max_rss": "116506624", "process_out_blocks": "0", "process_user_time": 0.686641}
[0m14:16:37.343116 [debug] [MainThread]: Command `dbt debug` failed at 14:16:37.343058 after 0.29 seconds
[0m14:16:37.343311 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:16:37.343509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e11490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102897f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e09fd0>]}
[0m14:16:37.343731 [debug] [MainThread]: Flushing usage events
[0m14:16:38.481294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:18.793970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105129d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105188fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105189650>]}


============================== 14:26:18.797220 | 9a4e74cc-e51b-4c72-8249-b188d9b3d18e ==============================
[0m14:26:18.797220 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:26:18.797607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:18.808528 [info ] [MainThread]: dbt version: 1.9.2
[0m14:26:18.808802 [info ] [MainThread]: python version: 3.11.10
[0m14:26:18.808971 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:26:18.809114 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:26:18.858052 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:26:18.858397 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:26:18.858585 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:26:18.859048 [info ] [MainThread]: adapter type: postgres
[0m14:26:18.859339 [info ] [MainThread]: adapter version: 1.9.0
[0m14:26:18.901501 [info ] [MainThread]: Configuration:
[0m14:26:18.901853 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:26:18.901994 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:26:18.902126 [info ] [MainThread]: Required dependencies:
[0m14:26:18.902311 [debug] [MainThread]: Executing "git --help"
[0m14:26:18.930095 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:26:18.930677 [debug] [MainThread]: STDERR: "b''"
[0m14:26:18.930851 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:26:18.931017 [info ] [MainThread]: Connection:
[0m14:26:18.931185 [info ] [MainThread]:   host: postgres
[0m14:26:18.931310 [info ] [MainThread]:   port: 5432
[0m14:26:18.931426 [info ] [MainThread]:   user: airflow
[0m14:26:18.931544 [info ] [MainThread]:   database: airflow
[0m14:26:18.931655 [info ] [MainThread]:   schema: public
[0m14:26:18.931767 [info ] [MainThread]:   connect_timeout: 10
[0m14:26:18.931884 [info ] [MainThread]:   role: None
[0m14:26:18.931995 [info ] [MainThread]:   search_path: None
[0m14:26:18.932107 [info ] [MainThread]:   keepalives_idle: 0
[0m14:26:18.932214 [info ] [MainThread]:   sslmode: None
[0m14:26:18.932323 [info ] [MainThread]:   sslcert: None
[0m14:26:18.932429 [info ] [MainThread]:   sslkey: None
[0m14:26:18.932538 [info ] [MainThread]:   sslrootcert: None
[0m14:26:18.932663 [info ] [MainThread]:   application_name: dbt
[0m14:26:18.932770 [info ] [MainThread]:   retries: 1
[0m14:26:18.933086 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:18.978145 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:26:19.003875 [debug] [MainThread]: Using postgres connection "debug"
[0m14:26:19.004100 [debug] [MainThread]: On debug: select 1 as id
[0m14:26:19.004240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:19.012450 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m14:26:19.014427 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:26:19.014578 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:26:19.014728 [debug] [MainThread]: On debug: No close available on handle
[0m14:26:19.014877 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:26:19.015036 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:26:19.015166 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:26:19.016287 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.26591596, "process_in_blocks": "0", "process_kernel_time": 0.194563, "process_mem_max_rss": "115507200", "process_out_blocks": "0", "process_user_time": 0.701796}
[0m14:26:19.016511 [debug] [MainThread]: Command `dbt debug` failed at 14:26:19.016461 after 0.27 seconds
[0m14:26:19.016689 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:26:19.016869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ddbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ed4d10>]}
[0m14:26:19.017071 [debug] [MainThread]: Flushing usage events
[0m14:26:20.272687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:54.617454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113694710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113710a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e6cd0>]}


============================== 14:26:54.620115 | f19ab4e4-7e45-4133-adda-398e11cac026 ==============================
[0m14:26:54.620115 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:26:54.620437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:54.630796 [info ] [MainThread]: dbt version: 1.9.2
[0m14:26:54.631061 [info ] [MainThread]: python version: 3.11.10
[0m14:26:54.631223 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:26:54.631361 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:26:54.676739 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:26:54.677024 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:26:54.677170 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:26:54.677581 [info ] [MainThread]: adapter type: postgres
[0m14:26:54.677719 [info ] [MainThread]: adapter version: 1.9.0
[0m14:26:54.720457 [info ] [MainThread]: Configuration:
[0m14:26:54.720803 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:26:54.720948 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:26:54.721077 [info ] [MainThread]: Required dependencies:
[0m14:26:54.721256 [debug] [MainThread]: Executing "git --help"
[0m14:26:54.744752 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:26:54.745568 [debug] [MainThread]: STDERR: "b''"
[0m14:26:54.745784 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:26:54.745952 [info ] [MainThread]: Connection:
[0m14:26:54.746154 [info ] [MainThread]:   host: 172.19.0.2
[0m14:26:54.746273 [info ] [MainThread]:   port: 5432
[0m14:26:54.746383 [info ] [MainThread]:   user: airflow
[0m14:26:54.746490 [info ] [MainThread]:   database: airflow
[0m14:26:54.746600 [info ] [MainThread]:   schema: public
[0m14:26:54.746706 [info ] [MainThread]:   connect_timeout: 10
[0m14:26:54.746814 [info ] [MainThread]:   role: None
[0m14:26:54.746919 [info ] [MainThread]:   search_path: None
[0m14:26:54.747024 [info ] [MainThread]:   keepalives_idle: 0
[0m14:26:54.747129 [info ] [MainThread]:   sslmode: None
[0m14:26:54.747233 [info ] [MainThread]:   sslcert: None
[0m14:26:54.747335 [info ] [MainThread]:   sslkey: None
[0m14:26:54.747440 [info ] [MainThread]:   sslrootcert: None
[0m14:26:54.747546 [info ] [MainThread]:   application_name: dbt
[0m14:26:54.747649 [info ] [MainThread]:   retries: 1
[0m14:26:54.747969 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:26:54.793656 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:26:54.818149 [debug] [MainThread]: Using postgres connection "debug"
[0m14:26:54.818371 [debug] [MainThread]: On debug: select 1 as id
[0m14:26:54.818513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:04.823133 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: timeout expired

[0m14:27:14.828279 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:27:14.830230 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:27:14.831254 [debug] [MainThread]: On debug: No close available on handle
[0m14:27:14.832301 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:27:14.832830 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:27:14.833166 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:27:14.838019 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.256132, "process_in_blocks": "0", "process_kernel_time": 0.17284, "process_mem_max_rss": "117473280", "process_out_blocks": "0", "process_user_time": 0.706446}
[0m14:27:14.838800 [debug] [MainThread]: Command `dbt debug` failed at 14:27:14.838650 after 20.26 seconds
[0m14:27:14.839313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:27:14.839774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113710c90>]}
[0m14:27:14.840313 [debug] [MainThread]: Flushing usage events
[0m14:27:15.965012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:47.967288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104341150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046accd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ad350>]}


============================== 14:28:47.970240 | d505ccff-5d64-446b-a8e3-bf2a41cc43be ==============================
[0m14:28:47.970240 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:28:47.970582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:28:47.981284 [info ] [MainThread]: dbt version: 1.9.2
[0m14:28:47.981531 [info ] [MainThread]: python version: 3.11.10
[0m14:28:47.981701 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:28:47.981843 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:28:48.027217 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:28:48.027504 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:28:48.027651 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:28:48.028070 [info ] [MainThread]: adapter type: postgres
[0m14:28:48.028241 [info ] [MainThread]: adapter version: 1.9.0
[0m14:28:48.069465 [info ] [MainThread]: Configuration:
[0m14:28:48.069775 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:28:48.069917 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:28:48.070044 [info ] [MainThread]: Required dependencies:
[0m14:28:48.070231 [debug] [MainThread]: Executing "git --help"
[0m14:28:48.089954 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:28:48.090575 [debug] [MainThread]: STDERR: "b''"
[0m14:28:48.090758 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:28:48.090922 [info ] [MainThread]: Connection:
[0m14:28:48.091101 [info ] [MainThread]:   host: postgres
[0m14:28:48.091219 [info ] [MainThread]:   port: 5432
[0m14:28:48.091333 [info ] [MainThread]:   user: airflow
[0m14:28:48.091447 [info ] [MainThread]:   database: airflow
[0m14:28:48.091564 [info ] [MainThread]:   schema: public
[0m14:28:48.091677 [info ] [MainThread]:   connect_timeout: 10
[0m14:28:48.091839 [info ] [MainThread]:   role: None
[0m14:28:48.091999 [info ] [MainThread]:   search_path: None
[0m14:28:48.092118 [info ] [MainThread]:   keepalives_idle: 0
[0m14:28:48.092336 [info ] [MainThread]:   sslmode: None
[0m14:28:48.092600 [info ] [MainThread]:   sslcert: None
[0m14:28:48.092791 [info ] [MainThread]:   sslkey: None
[0m14:28:48.092920 [info ] [MainThread]:   sslrootcert: None
[0m14:28:48.093038 [info ] [MainThread]:   application_name: dbt
[0m14:28:48.093150 [info ] [MainThread]:   retries: 1
[0m14:28:48.093508 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:48.139172 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:28:48.164077 [debug] [MainThread]: Using postgres connection "debug"
[0m14:28:48.164292 [debug] [MainThread]: On debug: select 1 as id
[0m14:28:48.164431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:48.168131 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m14:28:48.170280 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:28:48.170453 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:28:48.170606 [debug] [MainThread]: On debug: No close available on handle
[0m14:28:48.170783 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:28:48.170943 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:28:48.171082 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:28:48.172240 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.24330312, "process_in_blocks": "0", "process_kernel_time": 0.184293, "process_mem_max_rss": "115900416", "process_out_blocks": "0", "process_user_time": 0.707123}
[0m14:28:48.172451 [debug] [MainThread]: Command `dbt debug` failed at 14:28:48.172403 after 0.24 seconds
[0m14:28:48.172619 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:28:48.172792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002e3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038b65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003dce10>]}
[0m14:28:48.173018 [debug] [MainThread]: Flushing usage events
[0m14:28:49.347089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:09.983665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c61750>]}


============================== 14:30:09.986343 | 4f589fd4-aa8e-4f25-b269-ae7ae5bdc756 ==============================
[0m14:30:09.986343 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:30:09.986685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:30:09.996386 [info ] [MainThread]: dbt version: 1.9.2
[0m14:30:09.996692 [info ] [MainThread]: python version: 3.11.10
[0m14:30:09.996860 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:30:09.997011 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:30:10.044905 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:30:10.045244 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:30:10.045397 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:30:10.045865 [info ] [MainThread]: adapter type: postgres
[0m14:30:10.046040 [info ] [MainThread]: adapter version: 1.9.0
[0m14:30:10.087071 [info ] [MainThread]: Configuration:
[0m14:30:10.087360 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:10.087499 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:10.087625 [info ] [MainThread]: Required dependencies:
[0m14:30:10.087804 [debug] [MainThread]: Executing "git --help"
[0m14:30:10.114032 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:10.114649 [debug] [MainThread]: STDERR: "b''"
[0m14:30:10.114841 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:10.115015 [info ] [MainThread]: Connection:
[0m14:30:10.115221 [info ] [MainThread]:   host: localhost
[0m14:30:10.115348 [info ] [MainThread]:   port: 5432
[0m14:30:10.115465 [info ] [MainThread]:   user: airflow
[0m14:30:10.115582 [info ] [MainThread]:   database: airflow
[0m14:30:10.115697 [info ] [MainThread]:   schema: public
[0m14:30:10.115811 [info ] [MainThread]:   connect_timeout: 10
[0m14:30:10.115929 [info ] [MainThread]:   role: None
[0m14:30:10.116048 [info ] [MainThread]:   search_path: None
[0m14:30:10.116167 [info ] [MainThread]:   keepalives_idle: 0
[0m14:30:10.116282 [info ] [MainThread]:   sslmode: None
[0m14:30:10.116394 [info ] [MainThread]:   sslcert: None
[0m14:30:10.116505 [info ] [MainThread]:   sslkey: None
[0m14:30:10.116618 [info ] [MainThread]:   sslrootcert: None
[0m14:30:10.116731 [info ] [MainThread]:   application_name: dbt
[0m14:30:10.116843 [info ] [MainThread]:   retries: 1
[0m14:30:10.117158 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:10.161202 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:30:10.186650 [debug] [MainThread]: Using postgres connection "debug"
[0m14:30:10.186922 [debug] [MainThread]: On debug: select 1 as id
[0m14:30:10.187079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:10.218860 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m14:30:10.219466 [debug] [MainThread]: On debug: Close
[0m14:30:10.219664 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:30:10.219838 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:30:10.221093 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27321658, "process_in_blocks": "0", "process_kernel_time": 0.187289, "process_mem_max_rss": "121438208", "process_out_blocks": "0", "process_user_time": 0.709611}
[0m14:30:10.221347 [debug] [MainThread]: Command `dbt debug` succeeded at 14:30:10.221293 after 0.27 seconds
[0m14:30:10.221521 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:10.221692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c61590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c375d0>]}
[0m14:30:10.221899 [debug] [MainThread]: Flushing usage events
[0m14:30:11.389574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:36.675694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a195550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1e6cd0>]}


============================== 14:30:36.678613 | ec2821eb-4cfc-4635-bd8c-c005da724eb5 ==============================
[0m14:30:36.678613 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:30:36.678943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:36.689840 [info ] [MainThread]: dbt version: 1.9.2
[0m14:30:36.690130 [info ] [MainThread]: python version: 3.11.10
[0m14:30:36.690300 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:30:36.690446 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:30:36.736703 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:30:36.737027 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:30:36.737175 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:30:36.737576 [info ] [MainThread]: adapter type: postgres
[0m14:30:36.737704 [info ] [MainThread]: adapter version: 1.9.0
[0m14:30:36.778683 [info ] [MainThread]: Configuration:
[0m14:30:36.778989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:36.779125 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:36.779250 [info ] [MainThread]: Required dependencies:
[0m14:30:36.779443 [debug] [MainThread]: Executing "git --help"
[0m14:30:36.801542 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:36.802114 [debug] [MainThread]: STDERR: "b''"
[0m14:30:36.802304 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:36.802481 [info ] [MainThread]: Connection:
[0m14:30:36.802664 [info ] [MainThread]:   host: localhost
[0m14:30:36.802788 [info ] [MainThread]:   port: 5432
[0m14:30:36.802908 [info ] [MainThread]:   user: airflow
[0m14:30:36.803023 [info ] [MainThread]:   database: airflow
[0m14:30:36.803138 [info ] [MainThread]:   schema: public
[0m14:30:36.803256 [info ] [MainThread]:   connect_timeout: 10
[0m14:30:36.803367 [info ] [MainThread]:   role: None
[0m14:30:36.803482 [info ] [MainThread]:   search_path: None
[0m14:30:36.803593 [info ] [MainThread]:   keepalives_idle: 0
[0m14:30:36.803701 [info ] [MainThread]:   sslmode: None
[0m14:30:36.803808 [info ] [MainThread]:   sslcert: None
[0m14:30:36.803913 [info ] [MainThread]:   sslkey: None
[0m14:30:36.804023 [info ] [MainThread]:   sslrootcert: None
[0m14:30:36.804134 [info ] [MainThread]:   application_name: dbt
[0m14:30:36.804245 [info ] [MainThread]:   retries: 1
[0m14:30:36.804559 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:36.851384 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:30:36.876571 [debug] [MainThread]: Using postgres connection "debug"
[0m14:30:36.876849 [debug] [MainThread]: On debug: select 1 as id
[0m14:30:36.877003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:36.906450 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "airflow"

[0m14:30:36.914342 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:30:36.914570 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:30:36.914745 [debug] [MainThread]: On debug: No close available on handle
[0m14:30:36.914924 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:30:36.915132 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:30:36.915316 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "airflow"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:30:36.916608 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.27876672, "process_in_blocks": "0", "process_kernel_time": 0.160264, "process_mem_max_rss": "122372096", "process_out_blocks": "0", "process_user_time": 0.713449}
[0m14:30:36.916849 [debug] [MainThread]: Command `dbt debug` failed at 14:30:36.916798 after 0.28 seconds
[0m14:30:36.917038 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:36.917231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b03f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a95e250>]}
[0m14:30:36.917455 [debug] [MainThread]: Flushing usage events
[0m14:30:38.088227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:43.328605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c9110>]}


============================== 14:30:43.330858 | 53d4ff74-fe86-4a80-9cbc-cfb5a7d2bd85 ==============================
[0m14:30:43.330858 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:30:43.331196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:43.336418 [info ] [MainThread]: dbt version: 1.9.2
[0m14:30:43.336756 [info ] [MainThread]: python version: 3.11.10
[0m14:30:43.336999 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m14:30:43.337154 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m14:30:43.366743 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m14:30:43.367059 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m14:30:43.367206 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m14:30:43.367465 [info ] [MainThread]: adapter type: postgres
[0m14:30:43.367598 [info ] [MainThread]: adapter version: 1.9.0
[0m14:30:43.409583 [info ] [MainThread]: Configuration:
[0m14:30:43.409857 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:30:43.409995 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:30:43.410116 [info ] [MainThread]: Required dependencies:
[0m14:30:43.410284 [debug] [MainThread]: Executing "git --help"
[0m14:30:43.430383 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:30:43.431059 [debug] [MainThread]: STDERR: "b''"
[0m14:30:43.431250 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:30:43.431420 [info ] [MainThread]: Connection:
[0m14:30:43.431614 [info ] [MainThread]:   host: localhost
[0m14:30:43.431745 [info ] [MainThread]:   port: 5432
[0m14:30:43.431869 [info ] [MainThread]:   user: airflow
[0m14:30:43.431989 [info ] [MainThread]:   database: airflow
[0m14:30:43.432107 [info ] [MainThread]:   schema: public
[0m14:30:43.432220 [info ] [MainThread]:   connect_timeout: 10
[0m14:30:43.432339 [info ] [MainThread]:   role: None
[0m14:30:43.432459 [info ] [MainThread]:   search_path: None
[0m14:30:43.432684 [info ] [MainThread]:   keepalives_idle: 0
[0m14:30:43.432875 [info ] [MainThread]:   sslmode: None
[0m14:30:43.433009 [info ] [MainThread]:   sslcert: None
[0m14:30:43.433129 [info ] [MainThread]:   sslkey: None
[0m14:30:43.433248 [info ] [MainThread]:   sslrootcert: None
[0m14:30:43.433362 [info ] [MainThread]:   application_name: dbt
[0m14:30:43.433478 [info ] [MainThread]:   retries: 1
[0m14:30:43.433820 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:43.475885 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:30:43.493103 [debug] [MainThread]: Using postgres connection "debug"
[0m14:30:43.493343 [debug] [MainThread]: On debug: select 1 as id
[0m14:30:43.493484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:43.513541 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m14:30:43.514086 [debug] [MainThread]: On debug: Close
[0m14:30:43.514274 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:30:43.514438 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:30:43.515582 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.22178975, "process_in_blocks": "0", "process_kernel_time": 0.151719, "process_mem_max_rss": "121896960", "process_out_blocks": "0", "process_user_time": 0.708055}
[0m14:30:43.515854 [debug] [MainThread]: Command `dbt debug` succeeded at 14:30:43.515791 after 0.22 seconds
[0m14:30:43.516038 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:30:43.516227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dffa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105875bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb8690>]}
[0m14:30:43.516440 [debug] [MainThread]: Flushing usage events
[0m14:30:44.513625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:41.284711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107095990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e6cd0>]}


============================== 14:31:41.287559 | 29f17140-6f0e-49bd-8c98-c6bab9f62e52 ==============================
[0m14:31:41.287559 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:31:41.287900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:31:41.445453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606250>]}
[0m14:31:41.469404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10369bb10>]}
[0m14:31:41.470032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:31:41.520097 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:31:41.520563 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:31:41.520768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df6810>]}
[0m14:31:42.071295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f76050>]}
[0m14:31:42.108150 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:31:42.110787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:31:42.123267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca5e90>]}
[0m14:31:42.123533 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:31:42.123699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110879510>]}
[0m14:31:42.124640 [info ] [MainThread]: 
[0m14:31:42.124809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:31:42.124939 [info ] [MainThread]: 
[0m14:31:42.125162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:31:42.127027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:31:42.157068 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:31:42.157325 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:31:42.157468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:42.191759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m14:31:42.192535 [debug] [ThreadPool]: On list_airflow: Close
[0m14:31:42.193243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:31:42.196092 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:31:42.196250 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:31:42.196379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:31:42.204679 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:31:42.204890 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:31:42.205047 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:31:42.207430 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.002 seconds
[0m14:31:42.208566 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:31:42.209157 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:31:42.214430 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.214685 [debug] [MainThread]: On master: BEGIN
[0m14:31:42.214812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:31:42.224215 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:31:42.224425 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.224617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:31:42.227340 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:31:42.228068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f83150>]}
[0m14:31:42.228337 [debug] [MainThread]: On master: ROLLBACK
[0m14:31:42.228882 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.229063 [debug] [MainThread]: On master: BEGIN
[0m14:31:42.229987 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:31:42.230164 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.230299 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.230426 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.230903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:31:42.231087 [debug] [MainThread]: On master: Close
[0m14:31:42.231926 [debug] [Thread-1 (]: Began running node model.real_estate.stg_staging_table
[0m14:31:42.232190 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_staging_table .......................... [RUN]
[0m14:31:42.232432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.stg_staging_table)
[0m14:31:42.232598 [debug] [Thread-1 (]: Began compiling node model.real_estate.stg_staging_table
[0m14:31:42.236385 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.stg_staging_table"
[0m14:31:42.237079 [debug] [Thread-1 (]: Began executing node model.real_estate.stg_staging_table
[0m14:31:42.255947 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.stg_staging_table"
[0m14:31:42.256683 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:31:42.256856 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: BEGIN
[0m14:31:42.257005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:42.268082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:31:42.268340 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:31:42.268540 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */

  
    

  create  table "airflow"."public"."stg_staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:31:42.277352 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.009 seconds
[0m14:31:42.280647 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:31:42.280843 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table__dbt_tmp" rename to "stg_staging_table"
[0m14:31:42.281644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:31:42.289629 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:31:42.289820 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:31:42.289978 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:31:42.318529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m14:31:42.322146 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_staging_table__dbt_backup"
[0m14:31:42.324547 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:31:42.324752 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
drop table if exists "airflow"."public"."stg_staging_table__dbt_backup" cascade
[0m14:31:42.325611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:31:42.326820 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: Close
[0m14:31:42.327913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd0a50>]}
[0m14:31:42.328261 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_staging_table ..................... [[32mSELECT 4374[0m in 0.09s]
[0m14:31:42.328544 [debug] [Thread-1 (]: Finished running node model.real_estate.stg_staging_table
[0m14:31:42.328966 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:31:42.329183 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:31:42.329405 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:31:42.329578 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:31:42.329791 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:31:42.330062 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:31:42.330295 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:31:42.330526 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:31:42.330807 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:31:42.331044 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:31:42.331261 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:31:42.331536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.stg_staging_table, now model.real_estate.fact_all_apartment)
[0m14:31:42.331720 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:31:42.331891 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:31:42.332064 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:31:42.332223 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:31:42.333689 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:31:42.335231 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:31:42.336820 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:31:42.338493 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:31:42.339275 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:31:42.339525 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:31:42.339719 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:31:42.342022 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:31:42.344220 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:31:42.344450 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:31:42.346643 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:31:42.349530 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:31:42.349976 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:31:42.350158 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:31:42.350365 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:31:42.350666 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:31:42.350934 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:31:42.351153 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:31:42.351372 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:31:42.351579 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:31:42.351772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:31:42.351948 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:31:42.352218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:31:42.352466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:42.363538 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:31:42.363839 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:31:42.364067 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1;
  );
  
[0m14:31:42.364642 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:31:42.364983 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:31:42.365184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:31:42.365410 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1;
  );
  
[0m14:31:42.365579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:31:42.365753 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO dim_project 
         ^

[0m14:31:42.365903 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:31:42.366155 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:31:42.366369 [debug] [Thread-2 (]: On model.real_estate.dim_project: ROLLBACK
[0m14:31:42.366592 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."stg_staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1;
  );
  
[0m14:31:42.366814 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO dim_post
         ^

[0m14:31:42.367089 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."stg_staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1;
  );
  
[0m14:31:42.367402 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m14:31:42.367874 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:31:42.368100 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO fact_all_apartment
         ^

[0m14:31:42.368322 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO dim_broker 
         ^

[0m14:31:42.369145 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:31:42.369343 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m14:31:42.369559 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m14:31:42.371123 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:31:42.371353 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:31:42.376733 [debug] [Thread-3 (]: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:31:42.377504 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO fact_all_apartment
           ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:31:42.378119 [debug] [Thread-4 (]: Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_post
           ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql
[0m14:31:42.378698 [debug] [Thread-2 (]: Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_project 
           ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql
[0m14:31:42.378972 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11116c890>]}
[0m14:31:42.379177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117fad0>]}
[0m14:31:42.379388 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117c710>]}
[0m14:31:42.379583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29f17140-6f0e-49bd-8c98-c6bab9f62e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111160910>]}
[0m14:31:42.379945 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model public.dim_broker ........................ [[31mERROR[0m in 0.05s]
[0m14:31:42.380367 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.05s]
[0m14:31:42.380686 [error] [Thread-4 (]: 3 of 5 ERROR creating sql table model public.dim_post .......................... [[31mERROR[0m in 0.05s]
[0m14:31:42.380990 [error] [Thread-2 (]: 4 of 5 ERROR creating sql table model public.dim_project ....................... [[31mERROR[0m in 0.05s]
[0m14:31:42.381260 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:31:42.381490 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:31:42.381722 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:31:42.381945 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:31:42.382177 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_broker' to be skipped because of status 'error'.  Reason: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql.
[0m14:31:42.382826 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO fact_all_apartment
           ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m14:31:42.383046 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_post' to be skipped because of status 'error'.  Reason: Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_post
           ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql.
[0m14:31:42.383298 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_project' to be skipped because of status 'error'.  Reason: Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_project 
           ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql.
[0m14:31:42.384044 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.384190 [debug] [MainThread]: On master: BEGIN
[0m14:31:42.384333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:31:42.392847 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:31:42.393185 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.393343 [debug] [MainThread]: Using postgres connection "master"
[0m14:31:42.393498 [debug] [MainThread]: On master: COMMIT
[0m14:31:42.394267 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:31:42.394522 [debug] [MainThread]: On master: Close
[0m14:31:42.394741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:42.394870 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:31:42.394990 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:31:42.395105 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:31:42.395212 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:31:42.395385 [info ] [MainThread]: 
[0m14:31:42.395535 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:31:42.396095 [debug] [MainThread]: Command end result
[0m14:31:42.406686 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:31:42.407682 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:31:42.411011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:31:42.411352 [info ] [MainThread]: 
[0m14:31:42.411568 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m14:31:42.411724 [info ] [MainThread]: 
[0m14:31:42.411897 [error] [MainThread]:   Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:31:42.412035 [info ] [MainThread]: 
[0m14:31:42.412188 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO fact_all_apartment
           ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:31:42.412321 [info ] [MainThread]: 
[0m14:31:42.412468 [error] [MainThread]:   Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_post
           ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql
[0m14:31:42.412591 [info ] [MainThread]: 
[0m14:31:42.412733 [error] [MainThread]:   Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_project 
           ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql
[0m14:31:42.412860 [info ] [MainThread]: 
[0m14:31:42.412995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m14:31:42.414238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1671286, "process_in_blocks": "0", "process_kernel_time": 0.235521, "process_mem_max_rss": "135659520", "process_out_blocks": "0", "process_user_time": 1.450796}
[0m14:31:42.414466 [debug] [MainThread]: Command `dbt run` failed at 14:31:42.414423 after 1.17 seconds
[0m14:31:42.414668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e8bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b755d0>]}
[0m14:31:42.414845 [debug] [MainThread]: Flushing usage events
[0m14:31:43.747015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:34.150287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109295090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e6cd0>]}


============================== 14:43:34.153444 | 0ed90651-fe6d-455a-8f43-774a2a2c2387 ==============================
[0m14:43:34.153444 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:43:34.153870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:43:34.296859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10933c710>]}
[0m14:43:34.321744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928b490>]}
[0m14:43:34.322488 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:43:34.373892 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:43:34.454548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:43:34.454950 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/fact_all_apartment.sql
[0m14:43:34.455135 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_post.sql
[0m14:43:34.455306 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_project.sql
[0m14:43:34.633919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32d0d0>]}
[0m14:43:34.670987 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:43:34.673975 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:43:34.687858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a510090>]}
[0m14:43:34.688194 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:43:34.688376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a356e10>]}
[0m14:43:34.723862 [info ] [MainThread]: 
[0m14:43:34.724190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:43:34.724329 [info ] [MainThread]: 
[0m14:43:34.724702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:34.726981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:43:34.758760 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:43:34.759021 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:43:34.759157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:34.790955 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m14:43:34.791684 [debug] [ThreadPool]: On list_airflow: Close
[0m14:43:34.792350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:43:34.795171 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:43:34.795337 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:43:34.795462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:34.804191 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:43:34.804435 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:43:34.804597 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:43:34.806998 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m14:43:34.808215 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:43:34.808824 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:43:34.813837 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.814043 [debug] [MainThread]: On master: BEGIN
[0m14:43:34.814173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:34.822454 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:43:34.822668 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.822869 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:34.827907 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:43:34.828525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ba310>]}
[0m14:43:34.828788 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:34.829306 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.829447 [debug] [MainThread]: On master: BEGIN
[0m14:43:34.830193 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:43:34.830330 [debug] [MainThread]: On master: COMMIT
[0m14:43:34.830460 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.830580 [debug] [MainThread]: On master: COMMIT
[0m14:43:34.831027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:43:34.831165 [debug] [MainThread]: On master: Close
[0m14:43:34.832128 [debug] [Thread-1 (]: Began running node model.real_estate.stg_staging_table
[0m14:43:34.832463 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_staging_table .......................... [RUN]
[0m14:43:34.832750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.stg_staging_table)
[0m14:43:34.832929 [debug] [Thread-1 (]: Began compiling node model.real_estate.stg_staging_table
[0m14:43:34.836893 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.stg_staging_table"
[0m14:43:34.837551 [debug] [Thread-1 (]: Began executing node model.real_estate.stg_staging_table
[0m14:43:34.857286 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.stg_staging_table"
[0m14:43:34.857881 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.858069 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: BEGIN
[0m14:43:34.858232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:34.868275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:43:34.868591 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.868775 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */

  
    

  create  table "airflow"."public"."stg_staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:43:34.879390 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.010 seconds
[0m14:43:34.883060 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.883270 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table" rename to "stg_staging_table__dbt_backup"
[0m14:43:34.883970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:43:34.885374 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.885546 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table__dbt_tmp" rename to "stg_staging_table"
[0m14:43:34.886122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:43:34.895305 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:43:34.895532 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.895694 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:43:34.899755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:43:34.902858 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_staging_table__dbt_backup"
[0m14:43:34.905081 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:43:34.905264 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
drop table if exists "airflow"."public"."stg_staging_table__dbt_backup" cascade
[0m14:43:34.908098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:43:34.909298 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: Close
[0m14:43:34.910403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b86d0>]}
[0m14:43:34.910773 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_staging_table ..................... [[32mSELECT 4374[0m in 0.08s]
[0m14:43:34.911049 [debug] [Thread-1 (]: Finished running node model.real_estate.stg_staging_table
[0m14:43:34.911458 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:43:34.911630 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:43:34.911832 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:43:34.912002 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:43:34.912229 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:43:34.912586 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:43:34.912816 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:43:34.913071 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:43:34.913328 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:43:34.913545 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:43:34.913741 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:43:34.913917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.stg_staging_table, now model.real_estate.fact_all_apartment)
[0m14:43:34.914073 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:43:34.914221 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:43:34.914365 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:43:34.914506 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:43:34.916139 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:43:34.917603 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:43:34.919040 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:43:34.920653 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:43:34.921184 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:43:34.921461 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:43:34.923578 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:43:34.923779 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:43:34.923934 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:43:34.925850 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:43:34.928840 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:43:34.930806 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:43:34.931119 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:43:34.931368 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:43:34.931548 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:43:34.931746 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:43:34.931903 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:43:34.932052 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:43:34.932209 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:43:34.932370 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:43:34.932531 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:43:34.932801 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:43:34.932997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:43:34.933301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:34.948399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:43:34.948681 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m14:43:34.948844 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:43:34.948987 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:43:34.949118 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m14:43:34.949267 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:43:34.949412 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:43:34.949605 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."stg_staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1;
  );
  
[0m14:43:34.949796 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:43:34.949958 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."stg_staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1;
  );
  
[0m14:43:34.950158 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1;
  );
  
[0m14:43:34.950405 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1;
  );
  
[0m14:43:34.951047 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 52: WHERE rn = 1;
                     ^

[0m14:43:34.951223 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m14:43:34.952040 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:43:34.952272 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO dim_broker 
         ^

[0m14:43:34.952447 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 56: WHERE rn = 1;
                     ^

[0m14:43:34.952619 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 44: WHERE rn = 1;
                     ^

[0m14:43:34.953470 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m14:43:34.953744 [debug] [Thread-2 (]: On model.real_estate.dim_project: ROLLBACK
[0m14:43:34.953929 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m14:43:34.954649 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:43:34.954844 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:43:34.955048 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:43:34.961141 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near ";"
  LINE 52: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:43:34.961843 [debug] [Thread-4 (]: Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near ";"
  LINE 44: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql
[0m14:43:34.962456 [debug] [Thread-2 (]: Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near ";"
  LINE 56: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql
[0m14:43:34.962735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d0e50>]}
[0m14:43:34.963419 [debug] [Thread-3 (]: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:43:34.963659 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bb610>]}
[0m14:43:34.963881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d0d10>]}
[0m14:43:34.964394 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ed90651-fe6d-455a-8f43-774a2a2c2387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bacd0>]}
[0m14:43:34.964218 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.05s]
[0m14:43:34.964713 [error] [Thread-4 (]: 3 of 5 ERROR creating sql table model public.dim_post .......................... [[31mERROR[0m in 0.05s]
[0m14:43:34.964983 [error] [Thread-2 (]: 4 of 5 ERROR creating sql table model public.dim_project ....................... [[31mERROR[0m in 0.05s]
[0m14:43:34.965271 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model public.dim_broker ........................ [[31mERROR[0m in 0.05s]
[0m14:43:34.965529 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:43:34.965755 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:43:34.965962 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:43:34.966162 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:43:34.966394 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near ";"
  LINE 52: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m14:43:34.967092 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_post' to be skipped because of status 'error'.  Reason: Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near ";"
  LINE 44: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql.
[0m14:43:34.967321 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_project' to be skipped because of status 'error'.  Reason: Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near ";"
  LINE 56: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql.
[0m14:43:34.967524 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_broker' to be skipped because of status 'error'.  Reason: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql.
[0m14:43:34.968178 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.968355 [debug] [MainThread]: On master: BEGIN
[0m14:43:34.968492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:34.976123 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:43:34.976356 [debug] [MainThread]: On master: COMMIT
[0m14:43:34.976505 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:34.976633 [debug] [MainThread]: On master: COMMIT
[0m14:43:34.977151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:43:34.977334 [debug] [MainThread]: On master: Close
[0m14:43:34.977650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:34.977909 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:43:34.978097 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:43:34.978248 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:43:34.978364 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:43:34.978554 [info ] [MainThread]: 
[0m14:43:34.978800 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:43:34.979370 [debug] [MainThread]: Command end result
[0m14:43:34.990369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:43:34.991333 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:43:34.994589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:43:34.994778 [info ] [MainThread]: 
[0m14:43:34.994960 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m14:43:34.995115 [info ] [MainThread]: 
[0m14:43:34.995293 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  syntax error at or near ";"
  LINE 52: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:43:34.995429 [info ] [MainThread]: 
[0m14:43:34.995584 [error] [MainThread]:   Database Error in model dim_post (models/marts/dim_post.sql)
  syntax error at or near ";"
  LINE 44: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_post.sql
[0m14:43:34.995715 [info ] [MainThread]: 
[0m14:43:34.995864 [error] [MainThread]:   Database Error in model dim_project (models/marts/dim_project.sql)
  syntax error at or near ";"
  LINE 56: WHERE rn = 1;
                       ^
  compiled code at target/run/real_estate/models/marts/dim_project.sql
[0m14:43:34.995995 [info ] [MainThread]: 
[0m14:43:34.996141 [error] [MainThread]:   Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:43:34.996269 [info ] [MainThread]: 
[0m14:43:34.996411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m14:43:34.997704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88600904, "process_in_blocks": "0", "process_kernel_time": 0.235148, "process_mem_max_rss": "134299648", "process_out_blocks": "0", "process_user_time": 1.204967}
[0m14:43:34.997949 [debug] [MainThread]: Command `dbt run` failed at 14:43:34.997907 after 0.89 seconds
[0m14:43:34.998140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a3bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eec6d0>]}
[0m14:43:34.998313 [debug] [MainThread]: Flushing usage events
[0m14:43:36.560067 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:18.940147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f94c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f96650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f970d0>]}


============================== 14:44:18.942670 | 0c76f6d1-108e-4e78-a6af-6f424ba3f912 ==============================
[0m14:44:18.942670 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:44:18.943043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:19.027949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111da85d0>]}
[0m14:44:19.051849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b4190>]}
[0m14:44:19.052329 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:44:19.099025 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:44:19.176220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m14:44:19.176672 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/fact_all_apartment.sql
[0m14:44:19.176885 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_project.sql
[0m14:44:19.177098 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_post.sql
[0m14:44:19.177342 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_broker.sql
[0m14:44:19.367152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114451c10>]}
[0m14:44:19.404486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:44:19.407866 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:44:19.415367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1159a1f10>]}
[0m14:44:19.415667 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:44:19.415832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141aced0>]}
[0m14:44:19.451005 [info ] [MainThread]: 
[0m14:44:19.451349 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:19.451500 [info ] [MainThread]: 
[0m14:44:19.451745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:19.453668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:44:19.475742 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:44:19.476012 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:44:19.476154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:19.497211 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m14:44:19.497971 [debug] [ThreadPool]: On list_airflow: Close
[0m14:44:19.498668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:44:19.501522 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:44:19.501678 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:44:19.501801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:19.511142 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:44:19.511408 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:44:19.511566 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:19.513784 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m14:44:19.514941 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:44:19.515594 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:44:19.520674 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.520874 [debug] [MainThread]: On master: BEGIN
[0m14:44:19.520996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:19.528808 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:44:19.529035 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.529289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:19.531555 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:44:19.532138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cdfbd0>]}
[0m14:44:19.532386 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:19.532906 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.533060 [debug] [MainThread]: On master: BEGIN
[0m14:44:19.534010 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:44:19.534241 [debug] [MainThread]: On master: COMMIT
[0m14:44:19.534389 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.534512 [debug] [MainThread]: On master: COMMIT
[0m14:44:19.535011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:19.535203 [debug] [MainThread]: On master: Close
[0m14:44:19.536035 [debug] [Thread-1 (]: Began running node model.real_estate.stg_staging_table
[0m14:44:19.536290 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_staging_table .......................... [RUN]
[0m14:44:19.536531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.stg_staging_table)
[0m14:44:19.536699 [debug] [Thread-1 (]: Began compiling node model.real_estate.stg_staging_table
[0m14:44:19.540472 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.stg_staging_table"
[0m14:44:19.540908 [debug] [Thread-1 (]: Began executing node model.real_estate.stg_staging_table
[0m14:44:19.559422 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.stg_staging_table"
[0m14:44:19.559963 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.560141 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: BEGIN
[0m14:44:19.560301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:19.568939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:44:19.569218 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.569391 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */

  
    

  create  table "airflow"."public"."stg_staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:44:19.578085 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.008 seconds
[0m14:44:19.581758 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.581992 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table" rename to "stg_staging_table__dbt_backup"
[0m14:44:19.582940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.584487 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.584688 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table__dbt_tmp" rename to "stg_staging_table"
[0m14:44:19.585387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.594843 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:44:19.595058 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.595211 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:44:19.596127 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:19.599381 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_staging_table__dbt_backup"
[0m14:44:19.601533 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:19.601713 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
drop table if exists "airflow"."public"."stg_staging_table__dbt_backup" cascade
[0m14:44:19.603814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:19.605146 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: Close
[0m14:44:19.606021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114269850>]}
[0m14:44:19.606364 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_staging_table ..................... [[32mSELECT 4374[0m in 0.07s]
[0m14:44:19.606628 [debug] [Thread-1 (]: Finished running node model.real_estate.stg_staging_table
[0m14:44:19.607138 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:44:19.607330 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:44:19.607501 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:44:19.607666 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:44:19.607924 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:44:19.608275 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:44:19.608504 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:44:19.608733 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:44:19.608993 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:44:19.609208 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:44:19.609404 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:44:19.609575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.stg_staging_table, now model.real_estate.fact_all_apartment)
[0m14:44:19.609740 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:44:19.609897 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:44:19.610061 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:44:19.610205 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:44:19.611761 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:44:19.613090 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:44:19.614519 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:44:19.615852 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:44:19.616363 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:44:19.618434 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:44:19.618722 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:44:19.618918 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:44:19.620828 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:44:19.621008 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.621155 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:44:19.623800 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:44:19.624021 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:44:19.625915 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:44:19.626136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:19.626311 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.626536 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:19.626798 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:44:19.626958 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:44:19.627131 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.627306 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:44:19.627456 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:19.627734 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:44:19.628126 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:19.641195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:44:19.641475 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.641653 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m14:44:19.641818 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m14:44:19.641974 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m14:44:19.642171 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."stg_staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m14:44:19.642374 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:19.642522 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.642675 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.642881 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."stg_staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m14:44:19.643086 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m14:44:19.643413 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m14:44:19.644526 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 14: INSERT INTO dim_broker 
         ^

[0m14:44:19.644854 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m14:44:19.645627 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:44:19.647844 [debug] [Thread-3 (]: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:44:19.648181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115dd5450>]}
[0m14:44:19.648514 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model public.dim_broker ........................ [[31mERROR[0m in 0.04s]
[0m14:44:19.648790 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:44:19.649015 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.dim_broker' to be skipped because of status 'error'.  Reason: Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql.
[0m14:44:19.649518 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.006 seconds
[0m14:44:19.651342 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.651528 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m14:44:19.692290 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.047 seconds
[0m14:44:19.704337 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.704698 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m14:44:19.721840 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.079 seconds
[0m14:44:19.723659 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.723836 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m14:44:19.724562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.725826 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.725991 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m14:44:19.726841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.727736 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m14:44:19.727918 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.728067 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m14:44:19.731089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:44:19.731324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m14:44:19.731596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.080 seconds
[0m14:44:19.732804 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m14:44:19.734185 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.735422 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.735788 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:19.735973 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m14:44:19.736143 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m14:44:19.736308 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m14:44:19.737035 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.737199 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:19.737939 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:44:19.738625 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:44:19.738781 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.738928 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.739068 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:44:19.739207 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:44:19.740299 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:19.741497 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m14:44:19.741689 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:44:19.742001 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:19.742144 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:44:19.743204 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m14:44:19.743411 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m14:44:19.744929 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:44:19.745271 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:19.745490 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m14:44:19.745771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f4a910>]}
[0m14:44:19.746126 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.14s]
[0m14:44:19.746396 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:44:19.747142 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:19.747764 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:44:19.747915 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:19.748500 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:44:19.748731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f69950>]}
[0m14:44:19.749326 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c76f6d1-108e-4e78-a6af-6f424ba3f912', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f69990>]}
[0m14:44:19.749045 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.14s]
[0m14:44:19.749736 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.14s]
[0m14:44:19.749993 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:44:19.750218 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:44:19.750940 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.751088 [debug] [MainThread]: On master: BEGIN
[0m14:44:19.751210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:19.758154 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:44:19.758350 [debug] [MainThread]: On master: COMMIT
[0m14:44:19.758489 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:19.758608 [debug] [MainThread]: On master: COMMIT
[0m14:44:19.759160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:19.759384 [debug] [MainThread]: On master: Close
[0m14:44:19.759589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:19.759799 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:44:19.759932 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:44:19.760048 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:44:19.760156 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:44:19.760327 [info ] [MainThread]: 
[0m14:44:19.760475 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:44:19.760954 [debug] [MainThread]: Command end result
[0m14:44:19.770675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:44:19.771648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:44:19.774541 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:44:19.774706 [info ] [MainThread]: 
[0m14:44:19.774877 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:19.775028 [info ] [MainThread]: 
[0m14:44:19.775200 [error] [MainThread]:   Database Error in model dim_broker (models/marts/dim_broker.sql)
  syntax error at or near "INSERT"
  LINE 14: INSERT INTO dim_broker 
           ^
  compiled code at target/run/real_estate/models/marts/dim_broker.sql
[0m14:44:19.775342 [info ] [MainThread]: 
[0m14:44:19.775589 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:44:19.776546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.87301147, "process_in_blocks": "0", "process_kernel_time": 0.180299, "process_mem_max_rss": "134676480", "process_out_blocks": "0", "process_user_time": 1.236954}
[0m14:44:19.776769 [debug] [MainThread]: Command `dbt run` failed at 14:44:19.776728 after 0.87 seconds
[0m14:44:19.776958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ff5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c8c90>]}
[0m14:44:19.777126 [debug] [MainThread]: Flushing usage events
[0m14:44:21.215121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:57.080562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f94990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121fe7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ff5e10>]}


============================== 14:44:57.082857 | 5065eb3b-5f04-4043-b131-dfb9d96cbd2d ==============================
[0m14:44:57.082857 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:44:57.083172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -f', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:44:57.170510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122476010>]}
[0m14:44:57.196227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107576c50>]}
[0m14:44:57.196695 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:44:57.242709 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:44:57.321112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:57.321561 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_broker.sql
[0m14:44:57.501418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123030c10>]}
[0m14:44:57.538208 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:44:57.540859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:44:57.547953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233a3c50>]}
[0m14:44:57.548233 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:44:57.548402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122510b90>]}
[0m14:44:57.581455 [info ] [MainThread]: 
[0m14:44:57.581779 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:57.581916 [info ] [MainThread]: 
[0m14:44:57.582140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:57.584041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:44:57.614994 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:44:57.615264 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:44:57.615408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:57.636034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m14:44:57.636787 [debug] [ThreadPool]: On list_airflow: Close
[0m14:44:57.637484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:44:57.640372 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:44:57.640614 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:44:57.640774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:57.649906 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:44:57.650141 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:44:57.650298 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:57.654711 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m14:44:57.655828 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:44:57.656386 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:44:57.661424 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.661615 [debug] [MainThread]: On master: BEGIN
[0m14:44:57.661740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:57.668804 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:44:57.669032 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.669242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:57.671747 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:44:57.672337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207ad810>]}
[0m14:44:57.672584 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:57.673091 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.673227 [debug] [MainThread]: On master: BEGIN
[0m14:44:57.673973 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:44:57.674110 [debug] [MainThread]: On master: COMMIT
[0m14:44:57.674235 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.674357 [debug] [MainThread]: On master: COMMIT
[0m14:44:57.674808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:57.674939 [debug] [MainThread]: On master: Close
[0m14:44:57.675707 [debug] [Thread-1 (]: Began running node model.real_estate.stg_staging_table
[0m14:44:57.675999 [info ] [Thread-1 (]: 1 of 5 START sql table model public.stg_staging_table .......................... [RUN]
[0m14:44:57.676250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.stg_staging_table)
[0m14:44:57.676470 [debug] [Thread-1 (]: Began compiling node model.real_estate.stg_staging_table
[0m14:44:57.680565 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.stg_staging_table"
[0m14:44:57.680988 [debug] [Thread-1 (]: Began executing node model.real_estate.stg_staging_table
[0m14:44:57.700512 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.stg_staging_table"
[0m14:44:57.700977 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.701139 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: BEGIN
[0m14:44:57.701285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:57.708491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:44:57.708759 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.708942 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */

  
    

  create  table "airflow"."public"."stg_staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:44:57.715485 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.006 seconds
[0m14:44:57.719033 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.719227 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table" rename to "stg_staging_table__dbt_backup"
[0m14:44:57.719958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.721320 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.721491 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
alter table "airflow"."public"."stg_staging_table__dbt_tmp" rename to "stg_staging_table"
[0m14:44:57.722105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:57.730989 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:44:57.731202 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.731350 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: COMMIT
[0m14:44:57.735769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:57.738706 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_staging_table__dbt_backup"
[0m14:44:57.740803 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.stg_staging_table"
[0m14:44:57.740976 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.stg_staging_table"} */
drop table if exists "airflow"."public"."stg_staging_table__dbt_backup" cascade
[0m14:44:57.742985 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:57.744208 [debug] [Thread-1 (]: On model.real_estate.stg_staging_table: Close
[0m14:44:57.745325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12260d7d0>]}
[0m14:44:57.745684 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.stg_staging_table ..................... [[32mSELECT 4374[0m in 0.07s]
[0m14:44:57.745999 [debug] [Thread-1 (]: Finished running node model.real_estate.stg_staging_table
[0m14:44:57.746466 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:44:57.746649 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:44:57.746833 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:44:57.746997 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:44:57.747307 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:44:57.747551 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:44:57.747807 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:44:57.748050 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:44:57.748315 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:44:57.748524 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:44:57.748720 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:44:57.748889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.stg_staging_table, now model.real_estate.fact_all_apartment)
[0m14:44:57.749046 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:44:57.749190 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:44:57.749336 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:44:57.749484 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:44:57.751032 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:44:57.752312 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:44:57.753692 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:44:57.754991 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:44:57.755580 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:44:57.757773 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:44:57.757973 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:44:57.760092 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:44:57.760314 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:44:57.760491 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:44:57.763685 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:44:57.763946 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.766181 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:44:57.766439 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:44:57.766627 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.766872 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:57.767049 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:44:57.767250 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:44:57.767420 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.767615 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:44:57.767920 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:57.768108 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:44:57.768320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:57.768592 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:57.777042 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:44:57.777426 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.777729 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m14:44:57.778576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:44:57.778839 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:44:57.779047 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."stg_staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m14:44:57.779655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m14:44:57.779829 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:44:57.780056 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.780293 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpo.post_id does not exist
LINE 17:     dpo.post_id,
             ^

[0m14:44:57.780497 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.780733 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."stg_staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m14:44:57.780958 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m14:44:57.781138 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."stg_staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m14:44:57.781888 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:44:57.785456 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.004 seconds
[0m14:44:57.787292 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.787463 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.006 seconds
[0m14:44:57.787659 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m14:44:57.789184 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.789416 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m14:44:57.790030 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.790231 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.790968 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:44:57.792397 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.793947 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.794315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12369c2d0>]}
[0m14:44:57.794559 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m14:44:57.794752 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m14:44:57.795081 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.05s]
[0m14:44:57.795476 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:44:57.795756 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m14:44:57.795944 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.796093 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.797314 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:44:57.798111 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:44:57.798285 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.798453 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.798612 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:44:57.798759 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:44:57.799897 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:57.800042 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:57.801272 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m14:44:57.802481 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m14:44:57.802891 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:44:57.803222 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:44:57.803391 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m14:44:57.803554 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m14:44:57.805317 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:57.805976 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:44:57.806149 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:44:57.806681 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:44:57.806956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235d5790>]}
[0m14:44:57.807455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235804d0>]}
[0m14:44:57.807249 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.06s]
[0m14:44:57.807816 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.06s]
[0m14:44:57.808181 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:44:57.808482 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:44:57.814289 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.036 seconds
[0m14:44:57.816223 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.816397 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m14:44:57.817217 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:57.818441 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.818588 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m14:44:57.819177 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:57.819957 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:44:57.820104 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.820236 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:44:57.822126 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:44:57.823251 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m14:44:57.823571 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:44:57.823722 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m14:44:57.825245 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:44:57.825862 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:44:57.826160 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5065eb3b-5f04-4043-b131-dfb9d96cbd2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1235d4c10>]}
[0m14:44:57.826558 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.08s]
[0m14:44:57.826933 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:44:57.830667 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.830926 [debug] [MainThread]: On master: BEGIN
[0m14:44:57.831074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:57.838177 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:44:57.838438 [debug] [MainThread]: On master: COMMIT
[0m14:44:57.838585 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:57.838705 [debug] [MainThread]: On master: COMMIT
[0m14:44:57.839121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:57.839258 [debug] [MainThread]: On master: Close
[0m14:44:57.839527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:57.839698 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:44:57.839847 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:44:57.839967 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:44:57.840081 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:44:57.840267 [info ] [MainThread]: 
[0m14:44:57.840452 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:44:57.841063 [debug] [MainThread]: Command end result
[0m14:44:57.852892 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:44:57.853828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:44:57.856743 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:44:57.856906 [info ] [MainThread]: 
[0m14:44:57.857093 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:57.857242 [info ] [MainThread]: 
[0m14:44:57.857431 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:44:57.857680 [info ] [MainThread]: 
[0m14:44:57.857911 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:44:57.859211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8148305, "process_in_blocks": "0", "process_kernel_time": 0.209574, "process_mem_max_rss": "133398528", "process_out_blocks": "0", "process_user_time": 1.227203}
[0m14:44:57.859464 [debug] [MainThread]: Command `dbt run` failed at 14:44:57.859413 after 0.82 seconds
[0m14:44:57.859674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ff5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c68090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121ca87d0>]}
[0m14:44:57.859868 [debug] [MainThread]: Flushing usage events
[0m14:44:59.299554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:47.691097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090acf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090adb90>]}


============================== 14:49:47.694576 | 5654780c-51e3-48c4-9f92-02e4c5aaeadb ==============================
[0m14:49:47.694576 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:49:47.694995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -f', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:47.834752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fec90>]}
[0m14:49:47.858468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b3f90>]}
[0m14:49:47.859126 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:49:47.909776 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:49:47.988640 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m14:49:47.988966 [debug] [MainThread]: Partial parsing: added file: real_estate://models/staging/staging_table.sql
[0m14:49:47.989251 [debug] [MainThread]: Partial parsing: deleted file: real_estate://models/staging/stg_staging_table.sql
[0m14:49:47.989413 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_project.sql
[0m14:49:47.989553 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_broker.sql
[0m14:49:47.989688 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_post.sql
[0m14:49:47.989819 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/fact_all_apartment.sql
[0m14:49:48.176418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa3350>]}
[0m14:49:48.212654 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:49:48.215731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:49:48.258686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f84210>]}
[0m14:49:48.258985 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:49:48.259154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a09c690>]}
[0m14:49:48.259993 [info ] [MainThread]: 
[0m14:49:48.260160 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:48.260293 [info ] [MainThread]: 
[0m14:49:48.260509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:48.262306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:49:48.291392 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:49:48.291635 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:49:48.291772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:48.323879 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m14:49:48.324642 [debug] [ThreadPool]: On list_airflow: Close
[0m14:49:48.325368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:49:48.328318 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:49:48.328506 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:49:48.328636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:48.336535 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:49:48.336778 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:49:48.336933 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:49:48.339168 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m14:49:48.340283 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:49:48.340823 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:49:48.345872 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.346059 [debug] [MainThread]: On master: BEGIN
[0m14:49:48.346184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:48.355912 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:49:48.356156 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.356367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:48.358669 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:49:48.359352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f42c90>]}
[0m14:49:48.359617 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:48.360167 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.360352 [debug] [MainThread]: On master: BEGIN
[0m14:49:48.361148 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:49:48.361360 [debug] [MainThread]: On master: COMMIT
[0m14:49:48.361513 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.361643 [debug] [MainThread]: On master: COMMIT
[0m14:49:48.362128 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:48.362315 [debug] [MainThread]: On master: Close
[0m14:49:48.363182 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m14:49:48.363444 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m14:49:48.363682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m14:49:48.363850 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m14:49:48.367725 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m14:49:48.368227 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m14:49:48.387008 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m14:49:48.387789 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.387970 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m14:49:48.388119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:48.398589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:48.398870 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.399053 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:49:48.406472 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.007 seconds
[0m14:49:48.410076 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.410303 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m14:49:48.411012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.412462 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.412642 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m14:49:48.413203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:48.422215 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m14:49:48.422407 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.422563 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m14:49:48.427283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:49:48.430389 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m14:49:48.432575 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:49:48.432760 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m14:49:48.434963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:49:48.436156 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m14:49:48.437238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a380610>]}
[0m14:49:48.437606 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.07s]
[0m14:49:48.437878 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m14:49:48.438306 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:49:48.438515 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:49:48.438727 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:49:48.439006 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:49:48.439206 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:49:48.439400 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:49:48.439698 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:49:48.439909 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:49:48.440163 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:49:48.440379 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:49:48.440577 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:49:48.440744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m14:49:48.440908 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:49:48.441057 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:49:48.441200 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:49:48.441341 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:49:48.442844 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:49:48.444338 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:49:48.445822 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:49:48.447122 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:49:48.447728 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:49:48.450144 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:49:48.450395 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:49:48.453239 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:49:48.453439 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:49:48.455484 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:49:48.455657 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:49:48.455850 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.457848 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:49:48.458021 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:49:48.458187 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.458435 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.458644 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:48.458820 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:49:48.458991 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:49:48.459143 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:49:48.459391 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:49:48.459664 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:48.459888 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:49:48.460132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:48.468311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:48.468574 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.468762 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m14:49:48.469044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:49:48.469253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:48.469438 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:49:48.469606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:48.469865 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.470140 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m14:49:48.470385 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.470624 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m14:49:48.470911 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m14:49:48.473828 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpo.post_id does not exist
LINE 17:     dpo.post_id,
             ^

[0m14:49:48.474101 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.005 seconds
[0m14:49:48.474308 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m14:49:48.476181 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.476445 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m14:49:48.477009 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:49:48.477196 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.477930 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.007 seconds
[0m14:49:48.479385 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.480976 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.481152 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m14:49:48.481395 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m14:49:48.482250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.482481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.483833 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.484678 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:49:48.484862 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m14:49:48.485087 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.485290 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:49:48.485759 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:48.486625 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:49:48.486819 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:48.487011 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.488217 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m14:49:48.488394 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:49:48.488723 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:49:48.488942 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m14:49:48.489571 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:48.490696 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m14:49:48.490879 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:49:48.491243 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:49:48.491903 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:49:48.492079 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m14:49:48.492419 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a3690>]}
[0m14:49:48.493380 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:49:48.493670 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:49:48.494176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4afc10>]}
[0m14:49:48.493977 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.05s]
[0m14:49:48.494821 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:49:48.495114 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.05s]
[0m14:49:48.495377 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:49:48.495634 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:49:48.495906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3da550>]}
[0m14:49:48.496317 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m14:49:48.496630 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.06s]
[0m14:49:48.497241 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:49:48.508254 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.037 seconds
[0m14:49:48.510225 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.510412 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m14:49:48.511271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.512687 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.512876 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m14:49:48.513679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:48.514547 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:49:48.514738 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.514883 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:49:48.516753 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:49:48.519241 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m14:49:48.519634 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:49:48.519808 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m14:49:48.521337 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:49:48.522017 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:49:48.522311 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5654780c-51e3-48c4-9f92-02e4c5aaeadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a557710>]}
[0m14:49:48.522626 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.08s]
[0m14:49:48.522914 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:49:48.523596 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.523843 [debug] [MainThread]: On master: BEGIN
[0m14:49:48.523987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:48.530701 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:49:48.530904 [debug] [MainThread]: On master: COMMIT
[0m14:49:48.531054 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:48.531178 [debug] [MainThread]: On master: COMMIT
[0m14:49:48.531693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:48.531941 [debug] [MainThread]: On master: Close
[0m14:49:48.532167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:48.532294 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:49:48.532410 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:49:48.532521 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:49:48.532629 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:49:48.532816 [info ] [MainThread]: 
[0m14:49:48.532967 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:49:48.533491 [debug] [MainThread]: Command end result
[0m14:49:48.543406 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:49:48.544361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:49:48.547530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:49:48.547738 [info ] [MainThread]: 
[0m14:49:48.547975 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:49:48.548157 [info ] [MainThread]: 
[0m14:49:48.548339 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:49:48.548492 [info ] [MainThread]: 
[0m14:49:48.548646 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:49:48.549879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.89869493, "process_in_blocks": "0", "process_kernel_time": 0.236896, "process_mem_max_rss": "133496832", "process_out_blocks": "0", "process_user_time": 1.210875}
[0m14:49:48.550131 [debug] [MainThread]: Command `dbt run` failed at 14:49:48.550088 after 0.90 seconds
[0m14:49:48.550350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ad050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5c4d0>]}
[0m14:49:48.550544 [debug] [MainThread]: Flushing usage events
[0m14:49:49.976778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:17.758942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e51050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb20d0>]}


============================== 14:54:17.762389 | 3dd4afaa-3299-4ae0-b226-b85aaae374fe ==============================
[0m14:54:17.762389 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:54:17.762758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -f', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:54:17.903237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740e310>]}
[0m14:54:17.928015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb7d90>]}
[0m14:54:17.928866 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:54:17.979315 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:54:18.060987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:18.061299 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:18.083121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107406b10>]}
[0m14:54:18.124402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:54:18.128336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:54:18.143868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf2010>]}
[0m14:54:18.144207 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m14:54:18.144402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749d3d0>]}
[0m14:54:18.145405 [info ] [MainThread]: 
[0m14:54:18.145597 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:54:18.145733 [info ] [MainThread]: 
[0m14:54:18.145991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:18.148028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:54:18.179371 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:54:18.179638 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:54:18.179781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:18.204516 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m14:54:18.205308 [debug] [ThreadPool]: On list_airflow: Close
[0m14:54:18.206180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m14:54:18.209480 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:54:18.209744 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m14:54:18.209900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:18.216911 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:54:18.217102 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m14:54:18.217367 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:54:18.219568 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.002 seconds
[0m14:54:18.220620 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m14:54:18.221137 [debug] [ThreadPool]: On list_airflow_public: Close
[0m14:54:18.226028 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.226324 [debug] [MainThread]: On master: BEGIN
[0m14:54:18.226454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:18.233854 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:54:18.234142 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.234339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:18.236582 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:54:18.237206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a78150>]}
[0m14:54:18.237459 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:18.237988 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.238133 [debug] [MainThread]: On master: BEGIN
[0m14:54:18.239083 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:54:18.239260 [debug] [MainThread]: On master: COMMIT
[0m14:54:18.239398 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.239517 [debug] [MainThread]: On master: COMMIT
[0m14:54:18.240011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:18.240152 [debug] [MainThread]: On master: Close
[0m14:54:18.241050 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m14:54:18.241316 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m14:54:18.241549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m14:54:18.241721 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m14:54:18.245536 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m14:54:18.246161 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m14:54:18.267481 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m14:54:18.268006 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.268171 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m14:54:18.268312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.275534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:54:18.275810 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.276002 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m14:54:18.282638 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.006 seconds
[0m14:54:18.286181 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.286402 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m14:54:18.287254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:54:18.288750 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.288928 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m14:54:18.289574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:54:18.298811 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m14:54:18.299045 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.299219 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m14:54:18.305159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:54:18.308237 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m14:54:18.310467 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m14:54:18.310657 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m14:54:18.312289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:54:18.313481 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m14:54:18.314603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108027c10>]}
[0m14:54:18.314998 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.07s]
[0m14:54:18.315279 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m14:54:18.315727 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m14:54:18.315931 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m14:54:18.316294 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m14:54:18.316132 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m14:54:18.316489 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m14:54:18.316690 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m14:54:18.317134 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m14:54:18.316927 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m14:54:18.317557 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m14:54:18.317375 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m14:54:18.317747 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m14:54:18.317941 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m14:54:18.318089 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m14:54:18.318257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m14:54:18.319851 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m14:54:18.320033 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m14:54:18.321356 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m14:54:18.321584 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m14:54:18.323091 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m14:54:18.324505 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m14:54:18.324721 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m14:54:18.324969 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m14:54:18.327040 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m14:54:18.329241 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m14:54:18.329400 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m14:54:18.329579 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m14:54:18.332761 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m14:54:18.364905 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m14:54:18.365287 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:54:18.365489 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:54:18.365713 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m14:54:18.365884 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:54:18.366101 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m14:54:18.366301 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:54:18.366453 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:54:18.366605 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m14:54:18.366747 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:54:18.366994 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m14:54:18.367146 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:54:18.367391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:18.380064 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:54:18.380305 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m14:54:18.380464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:54:18.380643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m14:54:18.380810 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:54:18.380974 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:54:18.381127 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m14:54:18.381272 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:54:18.381452 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_post
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ),
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m14:54:18.381642 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_broker 
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank),
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m14:54:18.381849 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m14:54:18.382074 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO dim_project 
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ),
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m14:54:18.382974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dim_broker" does not exist
LINE 30:                     LEFT JOIN dim_broker db ON s.broker_name...
                                       ^

[0m14:54:18.383178 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m14:54:18.383893 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m14:54:18.387007 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.005 seconds
[0m14:54:18.388631 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:54:18.388846 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m14:54:18.389018 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.007 seconds
[0m14:54:18.390476 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:54:18.390658 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m14:54:18.390819 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:54:18.391628 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:54:18.391808 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:54:18.391984 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:54:18.392196 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m14:54:18.392900 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:54:18.393164 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:54:18.393347 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m14:54:18.393956 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:54:18.395065 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m14:54:18.395402 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m14:54:18.395585 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:54:18.395830 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m14:54:18.396559 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  relation "dim_broker" does not exist
  LINE 30:                     LEFT JOIN dim_broker db ON s.broker_name...
                                         ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:54:18.397667 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m14:54:18.397948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bd990>]}
[0m14:54:18.398306 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m14:54:18.398473 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:54:18.398930 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m14:54:18.398790 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.08s]
[0m14:54:18.399558 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m14:54:18.399824 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m14:54:18.400114 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:54:18.400430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea2ed0>]}
[0m14:54:18.400662 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  relation "dim_broker" does not exist
  LINE 30:                     LEFT JOIN dim_broker db ON s.broker_name...
                                         ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m14:54:18.401271 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m14:54:18.401581 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.08s]
[0m14:54:18.402294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d02d50>]}
[0m14:54:18.402543 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m14:54:18.402817 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m14:54:18.403126 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m14:54:18.421395 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.039 seconds
[0m14:54:18.423250 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:54:18.423440 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m14:54:18.424170 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:54:18.424908 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:54:18.425078 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:54:18.425231 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m14:54:18.427820 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:54:18.428980 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m14:54:18.429306 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m14:54:18.429464 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m14:54:18.429973 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:54:18.430553 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m14:54:18.430834 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dd4afaa-3299-4ae0-b226-b85aaae374fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c4050>]}
[0m14:54:18.431132 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.11s]
[0m14:54:18.431377 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m14:54:18.432130 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.432297 [debug] [MainThread]: On master: BEGIN
[0m14:54:18.432428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:18.439396 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:54:18.439605 [debug] [MainThread]: On master: COMMIT
[0m14:54:18.439747 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:18.439875 [debug] [MainThread]: On master: COMMIT
[0m14:54:18.440471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:18.440733 [debug] [MainThread]: On master: Close
[0m14:54:18.440944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:18.441074 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m14:54:18.441191 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m14:54:18.441306 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m14:54:18.441420 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m14:54:18.441669 [info ] [MainThread]: 
[0m14:54:18.441874 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:54:18.442403 [debug] [MainThread]: Command end result
[0m14:54:18.453852 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m14:54:18.454805 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m14:54:18.457741 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m14:54:18.457918 [info ] [MainThread]: 
[0m14:54:18.458105 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:54:18.458247 [info ] [MainThread]: 
[0m14:54:18.458460 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  relation "dim_broker" does not exist
  LINE 30:                     LEFT JOIN dim_broker db ON s.broker_name...
                                         ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m14:54:18.458666 [info ] [MainThread]: 
[0m14:54:18.458833 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:54:18.460086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7422173, "process_in_blocks": "0", "process_kernel_time": 0.238762, "process_mem_max_rss": "129925120", "process_out_blocks": "0", "process_user_time": 1.061945}
[0m14:54:18.460424 [debug] [MainThread]: Command `dbt run` failed at 14:54:18.460317 after 0.74 seconds
[0m14:54:18.460679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b10090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bfcfd0>]}
[0m14:54:18.460877 [debug] [MainThread]: Flushing usage events
[0m14:54:19.938951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:07.429209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125996050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259fd650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259e6cd0>]}


============================== 15:06:07.432196 | 5ace4302-1d7b-4398-b0d7-5f43777ceb3c ==============================
[0m15:06:07.432196 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:06:07.432540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:07.572780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1259e8390>]}
[0m15:06:07.596209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb41d0>]}
[0m15:06:07.596849 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:06:07.646581 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:06:07.727456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:07.727706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:07.748703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1255a5350>]}
[0m15:06:07.786529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:06:07.789410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:06:07.808331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b98210>]}
[0m15:06:07.808628 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m15:06:07.808796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fdf210>]}
[0m15:06:07.809727 [info ] [MainThread]: 
[0m15:06:07.809902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:07.810032 [info ] [MainThread]: 
[0m15:06:07.810274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:07.812136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m15:06:07.842539 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:06:07.842792 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:06:07.842932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:07.877511 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:06:07.877769 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:06:07.877933 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:06:07.880610 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m15:06:07.881672 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:06:07.882906 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:06:07.888215 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.888416 [debug] [MainThread]: On master: BEGIN
[0m15:06:07.888545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:07.898115 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:06:07.898360 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.898566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:07.901733 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:06:07.902458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ace4302-1d7b-4398-b0d7-5f43777ceb3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126b9aed0>]}
[0m15:06:07.902734 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:07.903319 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.903477 [debug] [MainThread]: On master: BEGIN
[0m15:06:07.904350 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:06:07.904529 [debug] [MainThread]: On master: COMMIT
[0m15:06:07.904673 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.904807 [debug] [MainThread]: On master: COMMIT
[0m15:06:07.905304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:07.905451 [debug] [MainThread]: On master: Close
[0m15:06:07.906354 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:06:07.906564 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:06:07.906736 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m15:06:07.907034 [info ] [Thread-2 (]: 2 of 2 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m15:06:07.907315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m15:06:07.907543 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1'
[0m15:06:07.907717 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:06:07.907880 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:06:07.918348 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:06:07.920394 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:06:07.923874 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:06:07.929984 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:06:07.932505 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:06:07.932852 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:06:07.933313 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:06:07.933485 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m15:06:07.933637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:07.933908 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:06:07.934090 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m15:06:07.934246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:06:07.947415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m15:06:07.947675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:06:07.947859 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:06:07.948042 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:06:07.948211 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m15:06:07.948394 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:06:07.949303 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "broker_id" does not exist
LINE 13: select broker_id
                ^

[0m15:06:07.949513 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m15:06:07.949810 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "post_id" does not exist
LINE 18:     select post_id as to_field
                    ^

[0m15:06:07.950067 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m15:06:07.950444 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m15:06:07.950667 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m15:06:07.956327 [debug] [Thread-2 (]: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  column "post_id" does not exist
  LINE 18:     select post_id as to_field
                      ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m15:06:07.956703 [error] [Thread-2 (]: 2 of 2 ERROR relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ .. [[31mERROR[0m in 0.05s]
[0m15:06:07.957342 [debug] [Thread-1 (]: Database Error in test not_null_dim_broker_broker_id (models/marts/schema.yml)
  column "broker_id" does not exist
  LINE 13: select broker_id
                  ^
  compiled code at target/run/real_estate/models/marts/schema.yml/not_null_dim_broker_broker_id.sql
[0m15:06:07.957616 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:06:07.957834 [error] [Thread-1 (]: 1 of 2 ERROR not_null_dim_broker_broker_id ..................................... [[31mERROR[0m in 0.05s]
[0m15:06:07.958097 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  column "post_id" does not exist
  LINE 18:     select post_id as to_field
                      ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql.
[0m15:06:07.958335 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:06:07.958882 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.not_null_dim_broker_broker_id.b2317a90a1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_broker_broker_id (models/marts/schema.yml)
  column "broker_id" does not exist
  LINE 13: select broker_id
                  ^
  compiled code at target/run/real_estate/models/marts/schema.yml/not_null_dim_broker_broker_id.sql.
[0m15:06:07.959517 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.959664 [debug] [MainThread]: On master: BEGIN
[0m15:06:07.959789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:07.967070 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:06:07.967282 [debug] [MainThread]: On master: COMMIT
[0m15:06:07.967418 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:07.967536 [debug] [MainThread]: On master: COMMIT
[0m15:06:07.968073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:07.968237 [debug] [MainThread]: On master: Close
[0m15:06:07.968434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:07.968589 [debug] [MainThread]: Connection 'test.real_estate.not_null_dim_broker_broker_id.b2317a90a1' was properly closed.
[0m15:06:07.968711 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m15:06:07.968867 [info ] [MainThread]: 
[0m15:06:07.969052 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m15:06:07.969435 [debug] [MainThread]: Command end result
[0m15:06:08.010599 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:06:08.011406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:06:08.014606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:06:08.014759 [info ] [MainThread]: 
[0m15:06:08.014956 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:06:08.015107 [info ] [MainThread]: 
[0m15:06:08.015288 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  column "post_id" does not exist
  LINE 18:     select post_id as to_field
                      ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m15:06:08.015438 [info ] [MainThread]: 
[0m15:06:08.015598 [error] [MainThread]:   Database Error in test not_null_dim_broker_broker_id (models/marts/schema.yml)
  column "broker_id" does not exist
  LINE 13: select broker_id
                  ^
  compiled code at target/run/real_estate/models/marts/schema.yml/not_null_dim_broker_broker_id.sql
[0m15:06:08.015734 [info ] [MainThread]: 
[0m15:06:08.015878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:06:08.016998 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.62453866, "process_in_blocks": "0", "process_kernel_time": 0.219927, "process_mem_max_rss": "130383872", "process_out_blocks": "0", "process_user_time": 0.948368}
[0m15:06:08.017221 [debug] [MainThread]: Command `dbt test` failed at 15:06:08.017181 after 0.62 seconds
[0m15:06:08.017416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127176a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127175b50>]}
[0m15:06:08.017603 [debug] [MainThread]: Flushing usage events
[0m15:06:09.158782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:29.315391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb9fd0>]}


============================== 15:07:29.318845 | 8e979325-eb73-4abd-bbe6-00af4e2e0464 ==============================
[0m15:07:29.318845 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:07:29.319224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -f', 'send_anonymous_usage_stats': 'True'}
[0m15:07:29.436129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fdb10>]}
[0m15:07:29.459604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8390>]}
[0m15:07:29.460275 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:07:29.509979 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:07:29.585333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:07:29.585683 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_post.sql
[0m15:07:29.585886 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_broker.sql
[0m15:07:29.586060 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/dim_project.sql
[0m15:07:29.759721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ace810>]}
[0m15:07:29.795562 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:07:29.798313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:07:29.813071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbfe90>]}
[0m15:07:29.813361 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m15:07:29.813532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4b190>]}
[0m15:07:29.814720 [info ] [MainThread]: 
[0m15:07:29.814902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:29.815031 [info ] [MainThread]: 
[0m15:07:29.815265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:29.817103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:07:29.879796 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:07:29.880041 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:07:29.880188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:29.910827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m15:07:29.911600 [debug] [ThreadPool]: On list_airflow: Close
[0m15:07:29.912390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m15:07:29.915344 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:07:29.915526 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:07:29.915655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:29.924386 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:07:29.924577 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:07:29.924731 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:07:29.926888 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m15:07:29.927959 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:07:29.928535 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:07:29.933491 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:29.933689 [debug] [MainThread]: On master: BEGIN
[0m15:07:29.933815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:29.941405 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:07:29.941631 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:29.941834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:29.944231 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:07:29.944820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbee90>]}
[0m15:07:29.945054 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:29.945615 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:29.945775 [debug] [MainThread]: On master: BEGIN
[0m15:07:29.946737 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:07:29.946996 [debug] [MainThread]: On master: COMMIT
[0m15:07:29.947164 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:29.947301 [debug] [MainThread]: On master: COMMIT
[0m15:07:29.947810 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:29.948014 [debug] [MainThread]: On master: Close
[0m15:07:29.948809 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m15:07:29.949053 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m15:07:29.949271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m15:07:29.949435 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m15:07:29.953225 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m15:07:29.953868 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m15:07:29.972291 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m15:07:29.972832 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:29.972997 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m15:07:29.973141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:29.980794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:07:29.981044 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:29.981228 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m15:07:30.002523 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.021 seconds
[0m15:07:30.007027 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:30.007247 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m15:07:30.008164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.009617 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:30.009791 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m15:07:30.010371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:30.019894 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:07:30.020120 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:30.020281 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:07:30.033526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:07:30.036817 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m15:07:30.039139 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:07:30.039335 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m15:07:30.042115 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:07:30.043465 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m15:07:30.044692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cab0d0>]}
[0m15:07:30.045129 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.09s]
[0m15:07:30.045437 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m15:07:30.045889 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m15:07:30.046070 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m15:07:30.046275 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m15:07:30.046441 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m15:07:30.046765 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m15:07:30.047018 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m15:07:30.047260 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m15:07:30.047497 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m15:07:30.047764 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m15:07:30.047985 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m15:07:30.048195 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m15:07:30.048375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m15:07:30.048542 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m15:07:30.048702 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m15:07:30.048856 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m15:07:30.049009 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m15:07:30.050518 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m15:07:30.051915 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m15:07:30.053528 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m15:07:30.055090 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m15:07:30.055679 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m15:07:30.055922 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m15:07:30.058293 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m15:07:30.058511 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m15:07:30.058687 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m15:07:30.060711 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m15:07:30.062838 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m15:07:30.065599 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m15:07:30.065900 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.066243 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:07:30.066402 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m15:07:30.066581 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.066776 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.066966 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m15:07:30.067155 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:07:30.067361 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m15:07:30.067604 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m15:07:30.067793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:30.068054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:30.068226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:30.085243 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m15:07:30.085492 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m15:07:30.085702 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m15:07:30.085845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m15:07:30.086050 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.086206 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.086354 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.086497 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:07:30.086670 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m15:07:30.086886 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m15:07:30.087089 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m15:07:30.087295 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    

-- INSERT INTO fact_all_apartment
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN dim_broker db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN dim_project dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN dim_post dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m15:07:30.088534 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column dpo.post_id does not exist
LINE 17:     dpo.post_id,
             ^

[0m15:07:30.088758 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m15:07:30.089400 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m15:07:30.092653 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.005 seconds
[0m15:07:30.094677 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.094965 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.007 seconds
[0m15:07:30.095197 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m15:07:30.096980 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.097246 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m15:07:30.097781 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.097977 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.099534 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.100840 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.101071 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m15:07:30.101917 [debug] [Thread-1 (]: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m15:07:30.102102 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m15:07:30.102436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e0190>]}
[0m15:07:30.103107 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.102906 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model public.fact_all_apartment ................ [[31mERROR[0m in 0.05s]
[0m15:07:30.103342 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.104165 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:07:30.104416 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m15:07:30.105146 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:07:30.105308 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.105556 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.fact_all_apartment' to be skipped because of status 'error'.  Reason: Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql.
[0m15:07:30.105725 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.105881 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:07:30.106359 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:07:30.107448 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:07:30.107639 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:07:30.108943 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m15:07:30.110150 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m15:07:30.110528 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:07:30.110892 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:07:30.111120 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m15:07:30.111363 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m15:07:30.114078 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:07:30.114364 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:07:30.115260 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m15:07:30.116012 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m15:07:30.116479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b8310>]}
[0m15:07:30.116817 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc3f10>]}
[0m15:07:30.117278 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.07s]
[0m15:07:30.117639 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.07s]
[0m15:07:30.117964 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m15:07:30.118274 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m15:07:30.125957 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.038 seconds
[0m15:07:30.127868 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.128068 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m15:07:30.129035 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.130510 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.130831 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m15:07:30.131759 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:30.132688 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:07:30.132872 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.133022 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:07:30.135694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:07:30.136858 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m15:07:30.137189 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:07:30.137339 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m15:07:30.139026 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:07:30.139638 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m15:07:30.139918 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e979325-eb73-4abd-bbe6-00af4e2e0464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106019bd0>]}
[0m15:07:30.140226 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.09s]
[0m15:07:30.140487 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m15:07:30.141146 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:30.141308 [debug] [MainThread]: On master: BEGIN
[0m15:07:30.141438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:30.148858 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:07:30.149102 [debug] [MainThread]: On master: COMMIT
[0m15:07:30.149234 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:30.149354 [debug] [MainThread]: On master: COMMIT
[0m15:07:30.149836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:30.149997 [debug] [MainThread]: On master: Close
[0m15:07:30.150206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:30.150350 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m15:07:30.150468 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m15:07:30.150586 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m15:07:30.150694 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m15:07:30.150875 [info ] [MainThread]: 
[0m15:07:30.151027 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:07:30.151700 [debug] [MainThread]: Command end result
[0m15:07:30.162621 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:07:30.163472 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:07:30.166636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:07:30.166823 [info ] [MainThread]: 
[0m15:07:30.167004 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:30.167158 [info ] [MainThread]: 
[0m15:07:30.167334 [error] [MainThread]:   Database Error in model fact_all_apartment (models/marts/fact_all_apartment.sql)
  column dpo.post_id does not exist
  LINE 17:     dpo.post_id,
               ^
  compiled code at target/run/real_estate/models/marts/fact_all_apartment.sql
[0m15:07:30.167479 [info ] [MainThread]: 
[0m15:07:30.167627 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:07:30.168866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88905597, "process_in_blocks": "0", "process_kernel_time": 0.226756, "process_mem_max_rss": "134414336", "process_out_blocks": "0", "process_user_time": 1.210088}
[0m15:07:30.169143 [debug] [MainThread]: Command `dbt run` failed at 15:07:30.169099 after 0.89 seconds
[0m15:07:30.169363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100918090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb9050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a04fd0>]}
[0m15:07:30.169557 [debug] [MainThread]: Flushing usage events
[0m15:07:31.609581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:35.505621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105794890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fded0>]}


============================== 15:07:35.508465 | f81ac8a5-ddb2-4570-9499-3a1fd9beac9a ==============================
[0m15:07:35.508465 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:07:35.508780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:07:35.629559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063de3d0>]}
[0m15:07:35.655137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102777f90>]}
[0m15:07:35.655981 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:07:35.707437 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:07:35.786503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:35.786763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:35.807205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a9d0>]}
[0m15:07:35.843353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:07:35.845971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:07:35.866506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9bd90>]}
[0m15:07:35.866813 [info ] [MainThread]: Found 5 models, 2 data tests, 1 source, 433 macros
[0m15:07:35.866981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106389350>]}
[0m15:07:35.867919 [info ] [MainThread]: 
[0m15:07:35.868097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:35.868229 [info ] [MainThread]: 
[0m15:07:35.868505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:35.870387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m15:07:35.896247 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:07:35.896497 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:07:35.896634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.918305 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m15:07:35.918556 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:07:35.918744 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:07:35.921176 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m15:07:35.922315 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:07:35.922871 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:07:35.928231 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.928445 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.928575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:35.938078 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:07:35.938299 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.938498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:35.941686 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:07:35.942340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f81ac8a5-ddb2-4570-9499-3a1fd9beac9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e8450>]}
[0m15:07:35.942598 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:35.943145 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.943308 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.944173 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:07:35.944336 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.944475 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.944601 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.945078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:35.945219 [debug] [MainThread]: On master: Close
[0m15:07:35.946025 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:07:35.946224 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:07:35.946406 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m15:07:35.946605 [info ] [Thread-2 (]: 2 of 2 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m15:07:35.946924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m15:07:35.947242 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1'
[0m15:07:35.947439 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:07:35.947608 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:07:35.956083 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:07:35.960031 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:07:35.960620 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:07:35.960901 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:07:35.967810 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:07:35.968935 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:07:35.969358 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:07:35.969526 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m15:07:35.969678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:35.969936 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:07:35.970107 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m15:07:35.970252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:35.982493 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m15:07:35.982725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:07:35.982929 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:07:35.983091 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:07:35.983271 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:07:35.983450 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m15:07:35.984489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:07:35.986696 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m15:07:35.986900 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:07:35.987562 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m15:07:35.987742 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m15:07:35.988138 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.04s]
[0m15:07:35.988450 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:07:35.988684 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m15:07:35.988957 [info ] [Thread-2 (]: 2 of 2 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.04s]
[0m15:07:35.989200 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:07:35.990008 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.990182 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.990324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:35.999234 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:07:35.999462 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.999605 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.999732 [debug] [MainThread]: On master: COMMIT
[0m15:07:36.000235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:36.000458 [debug] [MainThread]: On master: Close
[0m15:07:36.000683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:36.000860 [debug] [MainThread]: Connection 'test.real_estate.not_null_dim_broker_broker_id.b2317a90a1' was properly closed.
[0m15:07:36.000986 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m15:07:36.001148 [info ] [MainThread]: 
[0m15:07:36.001321 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m15:07:36.001691 [debug] [MainThread]: Command end result
[0m15:07:36.044137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:07:36.045013 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:07:36.047962 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:07:36.048125 [info ] [MainThread]: 
[0m15:07:36.048316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:36.048449 [info ] [MainThread]: 
[0m15:07:36.048594 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:07:36.049747 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58120316, "process_in_blocks": "0", "process_kernel_time": 0.176742, "process_mem_max_rss": "131842048", "process_out_blocks": "0", "process_user_time": 0.951409}
[0m15:07:36.049937 [debug] [MainThread]: Command `dbt test` succeeded at 15:07:36.049902 after 0.58 seconds
[0m15:07:36.050113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1002c3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003bce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1003a76d0>]}
[0m15:07:36.050301 [debug] [MainThread]: Flushing usage events
[0m15:07:37.123326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:38.358736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b1650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ba9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a11ed0>]}


============================== 15:15:38.362045 | 00537a36-0249-429e-b5da-7f4287bd5da0 ==============================
[0m15:15:38.362045 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:15:38.362397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:38.500141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb2cd0>]}
[0m15:15:38.523970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b303d0>]}
[0m15:15:38.524629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:38.576737 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:15:38.657248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:15:38.657729 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/schema.yml
[0m15:15:38.657901 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/fact_all_apartment.sql
[0m15:15:38.851624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fbbd0>]}
[0m15:15:38.893479 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:15:38.927821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:15:38.940577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d1b10>]}
[0m15:15:38.940849 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m15:15:38.941026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f7150>]}
[0m15:15:38.941975 [info ] [MainThread]: 
[0m15:15:38.942161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:15:38.942294 [info ] [MainThread]: 
[0m15:15:38.942523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:15:38.944444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:15:38.976081 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:15:38.976360 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:15:38.976507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:15:39.005943 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m15:15:39.006741 [debug] [ThreadPool]: On list_airflow: Close
[0m15:15:39.007666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m15:15:39.010746 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:15:39.010969 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:15:39.011109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:15:39.019961 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:15:39.020207 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:15:39.020362 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:15:39.022541 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.002 seconds
[0m15:15:39.024040 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:15:39.024674 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:15:39.029908 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.030137 [debug] [MainThread]: On master: BEGIN
[0m15:15:39.030274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:15:39.037571 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:15:39.037796 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.037992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:15:39.042942 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:15:39.043585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d377d0>]}
[0m15:15:39.043863 [debug] [MainThread]: On master: ROLLBACK
[0m15:15:39.044483 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.044633 [debug] [MainThread]: On master: BEGIN
[0m15:15:39.045505 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:15:39.045693 [debug] [MainThread]: On master: COMMIT
[0m15:15:39.045832 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.045957 [debug] [MainThread]: On master: COMMIT
[0m15:15:39.046518 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:39.046726 [debug] [MainThread]: On master: Close
[0m15:15:39.047565 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m15:15:39.047831 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m15:15:39.048060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m15:15:39.048222 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m15:15:39.052040 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m15:15:39.052502 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m15:15:39.070351 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m15:15:39.071005 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.071218 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m15:15:39.071380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:39.081521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:15:39.081800 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.081984 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m15:15:39.090119 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.008 seconds
[0m15:15:39.093820 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.094048 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m15:15:39.094981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.096458 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.096635 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m15:15:39.097271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:15:39.106537 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:15:39.106796 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.106958 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:15:39.119410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:15:39.122990 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m15:15:39.125348 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:15:39.125548 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m15:15:39.128504 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:15:39.130159 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m15:15:39.131787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105632fd0>]}
[0m15:15:39.132278 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.08s]
[0m15:15:39.132583 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m15:15:39.132972 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m15:15:39.133139 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m15:15:39.133366 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m15:15:39.133591 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m15:15:39.133829 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m15:15:39.134116 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m15:15:39.134406 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m15:15:39.134637 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m15:15:39.134853 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m15:15:39.135023 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m15:15:39.135177 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m15:15:39.135329 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m15:15:39.136987 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m15:15:39.139409 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m15:15:39.140883 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m15:15:39.141536 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m15:15:39.141716 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m15:15:39.143995 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m15:15:39.146024 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m15:15:39.146237 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m15:15:39.148683 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m15:15:39.149340 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.149562 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m15:15:39.149737 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.149936 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:15:39.150105 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.150268 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m15:15:39.150555 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m15:15:39.150726 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:15:39.150884 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:15:39.159394 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m15:15:39.159659 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m15:15:39.159925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m15:15:39.160156 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.160406 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.160628 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.160858 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m15:15:39.161148 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m15:15:39.161404 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m15:15:39.166233 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.005 seconds
[0m15:15:39.168091 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.168286 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.007 seconds
[0m15:15:39.168582 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m15:15:39.170044 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.170358 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m15:15:39.170984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.171178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.172449 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.173712 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.173886 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m15:15:39.174044 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m15:15:39.174815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.175682 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:15:39.175852 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.175999 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:15:39.176154 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:15:39.176896 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:15:39.177089 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.177273 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:15:39.177488 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:15:39.178852 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m15:15:39.179054 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:15:39.179450 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:15:39.180641 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m15:15:39.180819 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m15:15:39.181144 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:15:39.181323 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m15:15:39.182571 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:15:39.182728 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:15:39.183352 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m15:15:39.184004 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m15:15:39.184344 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e12090>]}
[0m15:15:39.184721 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561bbd0>]}
[0m15:15:39.185016 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.05s]
[0m15:15:39.185348 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.05s]
[0m15:15:39.185665 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m15:15:39.185967 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m15:15:39.200976 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.039 seconds
[0m15:15:39.204076 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.204303 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m15:15:39.205245 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.206803 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.206996 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m15:15:39.207676 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:15:39.208608 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:15:39.208795 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.208943 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:15:39.212132 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:15:39.213527 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m15:15:39.213904 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:15:39.214079 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m15:15:39.216080 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:15:39.216764 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m15:15:39.217055 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e45310>]}
[0m15:15:39.217359 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.08s]
[0m15:15:39.217611 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m15:15:39.217958 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m15:15:39.218248 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m15:15:39.218473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m15:15:39.218664 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m15:15:39.220673 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m15:15:39.221105 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m15:15:39.223198 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m15:15:39.223559 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.223720 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m15:15:39.223868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:39.231613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:15:39.231968 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.232180 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m15:15:39.329629 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.097 seconds
[0m15:15:39.331494 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.331684 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m15:15:39.332487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.333786 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.333959 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m15:15:39.334712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:39.335568 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:15:39.335748 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.335897 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:15:39.337986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:15:39.339160 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m15:15:39.339484 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:15:39.339641 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m15:15:39.341141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:15:39.341741 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m15:15:39.342032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00537a36-0249-429e-b5da-7f4287bd5da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e30090>]}
[0m15:15:39.342336 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.12s]
[0m15:15:39.342593 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m15:15:39.343325 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.343492 [debug] [MainThread]: On master: BEGIN
[0m15:15:39.343623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:39.350166 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:15:39.350397 [debug] [MainThread]: On master: COMMIT
[0m15:15:39.350543 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:39.350672 [debug] [MainThread]: On master: COMMIT
[0m15:15:39.351157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:39.351326 [debug] [MainThread]: On master: Close
[0m15:15:39.351534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:39.351659 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m15:15:39.351775 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m15:15:39.351892 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m15:15:39.352001 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m15:15:39.352188 [info ] [MainThread]: 
[0m15:15:39.352348 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:15:39.352857 [debug] [MainThread]: Command end result
[0m15:15:39.366247 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:15:39.367135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:15:39.370251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:15:39.370427 [info ] [MainThread]: 
[0m15:15:39.370620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:39.370767 [info ] [MainThread]: 
[0m15:15:39.370920 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:15:39.372265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0551611, "process_in_blocks": "0", "process_kernel_time": 0.234073, "process_mem_max_rss": "134742016", "process_out_blocks": "0", "process_user_time": 1.235748}
[0m15:15:39.372582 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:39.372531 after 1.06 seconds
[0m15:15:39.372808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100670090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a11650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006f6650>]}
[0m15:15:39.373025 [debug] [MainThread]: Flushing usage events
[0m15:15:40.797231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:16.893730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114595950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114596650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f5d50>]}


============================== 15:29:16.896962 | 429d714c-34fb-4dc2-9bf7-78f83ad3f5c3 ==============================
[0m15:29:16.896962 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:29:16.897343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:29:17.037124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c5650>]}
[0m15:29:17.060931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b44d0>]}
[0m15:29:17.061555 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:17.113238 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:29:17.192805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:17.193045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:17.213525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a80650>]}
[0m15:29:17.251236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:29:17.254182 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:29:17.267635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bd7f90>]}
[0m15:29:17.267974 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m15:29:17.268208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c6d90>]}
[0m15:29:17.269353 [info ] [MainThread]: 
[0m15:29:17.269544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:17.269687 [info ] [MainThread]: 
[0m15:29:17.269945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:17.271903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:29:17.303914 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:29:17.304188 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:29:17.304335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:17.337588 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m15:29:17.338356 [debug] [ThreadPool]: On list_airflow: Close
[0m15:29:17.339076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m15:29:17.341939 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:29:17.342111 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:29:17.342243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:17.349775 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:29:17.350047 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:29:17.350202 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:29:17.352426 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.002 seconds
[0m15:29:17.353513 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:29:17.354310 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:29:17.359397 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.359614 [debug] [MainThread]: On master: BEGIN
[0m15:29:17.359742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:17.368898 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:29:17.369082 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.369375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:17.372139 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:29:17.372871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11604d510>]}
[0m15:29:17.373145 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:17.373741 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.373933 [debug] [MainThread]: On master: BEGIN
[0m15:29:17.375086 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:29:17.375241 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.375378 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.375500 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.376058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:17.376211 [debug] [MainThread]: On master: Close
[0m15:29:17.377106 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m15:29:17.377404 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m15:29:17.377661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m15:29:17.377843 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m15:29:17.382319 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m15:29:17.385625 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m15:29:17.404287 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m15:29:17.404865 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.405196 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m15:29:17.405374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:17.416486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:29:17.416723 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.416902 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m15:29:17.425878 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.009 seconds
[0m15:29:17.429196 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.429385 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m15:29:17.430263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:17.431899 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.432148 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m15:29:17.432736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:29:17.441876 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:29:17.442093 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.442247 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:29:17.449838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:29:17.453325 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m15:29:17.455787 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:29:17.456009 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m15:29:17.457964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:29:17.459206 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m15:29:17.460283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fc6090>]}
[0m15:29:17.460690 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 2187[0m in 0.08s]
[0m15:29:17.461015 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m15:29:17.461575 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m15:29:17.461760 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m15:29:17.461963 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m15:29:17.462264 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m15:29:17.462598 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m15:29:17.462883 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m15:29:17.463162 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m15:29:17.463378 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m15:29:17.463606 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m15:29:17.463783 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m15:29:17.463953 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m15:29:17.464112 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m15:29:17.465715 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m15:29:17.467071 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m15:29:17.469205 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m15:29:17.470194 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m15:29:17.470409 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m15:29:17.470618 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m15:29:17.472983 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m15:29:17.506541 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m15:29:17.508608 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m15:29:17.509085 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:29:17.509265 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m15:29:17.509414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:29:17.509675 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:29:17.509854 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m15:29:17.510026 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:29:17.510162 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:17.510311 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m15:29:17.510580 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:17.525298 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m15:29:17.525593 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:29:17.525785 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m15:29:17.525986 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m15:29:17.526181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m15:29:17.526348 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:29:17.526538 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:29:17.526798 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m15:29:17.527046 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m15:29:17.530478 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.004 seconds
[0m15:29:17.532091 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:29:17.532295 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m15:29:17.533221 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:17.534128 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:29:17.534306 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:29:17.534459 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:29:17.534664 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.007 seconds
[0m15:29:17.536376 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:29:17.536583 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:17.536834 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m15:29:17.538047 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m15:29:17.538495 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:29:17.538694 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m15:29:17.538859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:17.539638 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:29:17.539812 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:29:17.539984 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:29:17.540568 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m15:29:17.540727 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:29:17.541008 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11629f650>]}
[0m15:29:17.541355 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.08s]
[0m15:29:17.541612 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m15:29:17.543004 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:17.544273 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m15:29:17.544638 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:29:17.544803 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m15:29:17.545427 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:29:17.546047 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m15:29:17.546329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116292f10>]}
[0m15:29:17.546753 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m15:29:17.547067 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m15:29:17.567047 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.040 seconds
[0m15:29:17.568997 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:29:17.569223 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m15:29:17.570290 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:17.571181 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:29:17.571391 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:29:17.571588 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:29:17.574618 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:29:17.575917 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m15:29:17.576284 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:29:17.576457 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m15:29:17.577117 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:29:17.577783 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m15:29:17.578155 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c5810>]}
[0m15:29:17.578618 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.11s]
[0m15:29:17.578906 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m15:29:17.579375 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m15:29:17.579715 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m15:29:17.579958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m15:29:17.580122 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m15:29:17.582020 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m15:29:17.582419 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m15:29:17.584458 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m15:29:17.584767 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:29:17.584922 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m15:29:17.585068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:17.593234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:29:17.593515 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:29:17.593731 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m15:29:17.664595 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.070 seconds
[0m15:29:17.666317 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:29:17.666518 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m15:29:17.667433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:29:17.668219 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:29:17.668408 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:29:17.668563 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:29:17.670279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:29:17.672871 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m15:29:17.673289 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:29:17.673451 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m15:29:17.674320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:29:17.675129 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m15:29:17.675449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429d714c-34fb-4dc2-9bf7-78f83ad3f5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160769d0>]}
[0m15:29:17.675882 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.10s]
[0m15:29:17.676232 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m15:29:17.676929 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.677164 [debug] [MainThread]: On master: BEGIN
[0m15:29:17.677307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:17.684361 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:29:17.684621 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.684766 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:17.684898 [debug] [MainThread]: On master: COMMIT
[0m15:29:17.685440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:17.685633 [debug] [MainThread]: On master: Close
[0m15:29:17.685951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:17.686161 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m15:29:17.686284 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m15:29:17.686396 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m15:29:17.686504 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m15:29:17.686688 [info ] [MainThread]: 
[0m15:29:17.686844 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:29:17.687364 [debug] [MainThread]: Command end result
[0m15:29:17.701504 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:29:17.702690 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:29:17.706240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:29:17.706438 [info ] [MainThread]: 
[0m15:29:17.706641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:17.706789 [info ] [MainThread]: 
[0m15:29:17.706942 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:29:17.708153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85130507, "process_in_blocks": "0", "process_kernel_time": 0.231017, "process_mem_max_rss": "129286144", "process_out_blocks": "0", "process_user_time": 1.048078}
[0m15:29:17.708382 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:17.708340 after 0.85 seconds
[0m15:29:17.708580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a07f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aeb6d0>]}
[0m15:29:17.708771 [debug] [MainThread]: Flushing usage events
[0m15:29:19.238886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:22.315699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f95490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff5d10>]}


============================== 15:29:22.317990 | a30a3eb7-19cd-40e9-b10f-4d12957c6903 ==============================
[0m15:29:22.317990 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:29:22.318315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:29:22.403536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff4950>]}
[0m15:29:22.427155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b29d0>]}
[0m15:29:22.427617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:22.473390 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:29:22.528375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:22.528646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:22.549056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea4910>]}
[0m15:29:22.585916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:29:22.588638 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:29:22.602029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129bbe10>]}
[0m15:29:22.602319 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m15:29:22.602493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111488e50>]}
[0m15:29:22.603556 [info ] [MainThread]: 
[0m15:29:22.603728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:22.603860 [info ] [MainThread]: 
[0m15:29:22.604105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:22.605945 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m15:29:22.635710 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:29:22.635949 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:29:22.636100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:22.655263 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m15:29:22.655479 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:29:22.655637 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:29:22.657735 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.002 seconds
[0m15:29:22.658853 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:29:22.659407 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:29:22.664555 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.664749 [debug] [MainThread]: On master: BEGIN
[0m15:29:22.664878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:22.672850 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:29:22.673050 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.673240 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:22.675453 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:29:22.676183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30a3eb7-19cd-40e9-b10f-4d12957c6903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe7e50>]}
[0m15:29:22.676430 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:22.676929 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.677069 [debug] [MainThread]: On master: BEGIN
[0m15:29:22.677950 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:29:22.678111 [debug] [MainThread]: On master: COMMIT
[0m15:29:22.678244 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.678366 [debug] [MainThread]: On master: COMMIT
[0m15:29:22.678828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:22.678963 [debug] [MainThread]: On master: Close
[0m15:29:22.679805 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:29:22.679992 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m15:29:22.680186 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m15:29:22.680376 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m15:29:22.680545 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m15:29:22.680728 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m15:29:22.680955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m15:29:22.681174 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m15:29:22.681607 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m15:29:22.681825 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m15:29:22.682026 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:29:22.682235 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m15:29:22.682392 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m15:29:22.682595 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m15:29:22.690843 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:29:22.691123 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m15:29:22.692972 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m15:29:22.693158 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m15:29:22.694970 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m15:29:22.698824 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m15:29:22.699044 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:29:22.705073 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m15:29:22.706269 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:29:22.707475 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m15:29:22.707693 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m15:29:22.707859 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m15:29:22.709786 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m15:29:22.739608 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m15:29:22.739848 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:29:22.740133 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m15:29:22.740462 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m15:29:22.740629 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m15:29:22.740784 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m15:29:22.740937 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m15:29:22.741085 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m15:29:22.741226 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m15:29:22.741368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:22.741532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:22.741703 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:22.741848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:29:22.760614 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m15:29:22.760829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:29:22.760990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m15:29:22.761133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m15:29:22.761308 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m15:29:22.761460 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m15:29:22.761603 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m15:29:22.761751 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m15:29:22.761928 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "airflow"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m15:29:22.762126 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m15:29:22.762303 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "airflow"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m15:29:22.762490 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "airflow"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:29:22.763623 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.763882 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.764089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.766164 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m15:29:22.766351 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:29:22.766978 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m15:29:22.767561 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m15:29:22.768221 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m15:29:22.768408 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m15:29:22.768879 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.09s]
[0m15:29:22.769082 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m15:29:22.769355 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m15:29:22.769495 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m15:29:22.769661 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m15:29:22.769920 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.09s]
[0m15:29:22.770279 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:29:22.770650 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.09s]
[0m15:29:22.770982 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.09s]
[0m15:29:22.771376 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m15:29:22.771593 [info ] [Thread-3 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m15:29:22.771887 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m15:29:22.772176 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m15:29:22.772442 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m15:29:22.772664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m15:29:22.772886 [debug] [Thread-1 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m15:29:22.773064 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m15:29:22.773251 [info ] [Thread-2 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m15:29:22.773435 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:29:22.773598 [info ] [Thread-1 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m15:29:22.773788 [info ] [Thread-4 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m15:29:22.774065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m15:29:22.777221 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:29:22.777449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m15:29:22.777631 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m15:29:22.777799 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m15:29:22.778161 [debug] [Thread-1 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m15:29:22.778423 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m15:29:22.778674 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:29:22.781618 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m15:29:22.784461 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m15:29:22.786149 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m15:29:22.787332 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:29:22.787912 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m15:29:22.788087 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m15:29:22.788249 [debug] [Thread-1 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m15:29:22.788478 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:29:22.789627 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m15:29:22.790679 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m15:29:22.791699 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m15:29:22.791883 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m15:29:22.792279 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:29:22.792454 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m15:29:22.792638 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m15:29:22.792919 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m15:29:22.793075 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m15:29:22.793234 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m15:29:22.793395 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m15:29:22.793557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:29:22.793724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:29:22.793891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:29:22.801819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m15:29:22.802210 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m15:29:22.802426 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:29:22.803554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m15:29:22.803827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:29:22.804069 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m15:29:22.804282 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:29:22.804522 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m15:29:22.804748 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m15:29:22.804930 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m15:29:22.805749 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m15:29:22.805994 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "airflow"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:29:22.806213 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:29:22.806408 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:29:22.807050 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m15:29:22.807671 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.807488 [info ] [Thread-3 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.03s]
[0m15:29:22.807898 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.808596 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m15:29:22.808854 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:29:22.809121 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m15:29:22.809746 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m15:29:22.810452 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m15:29:22.810642 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m15:29:22.810838 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m15:29:22.811596 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m15:29:22.811300 [info ] [Thread-1 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.03s]
[0m15:29:22.811851 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m15:29:22.811478 [info ] [Thread-3 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m15:29:22.812425 [debug] [Thread-1 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m15:29:22.812102 [info ] [Thread-4 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.03s]
[0m15:29:22.812857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m15:29:22.813269 [info ] [Thread-2 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.04s]
[0m15:29:22.813644 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m15:29:22.813830 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m15:29:22.814193 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m15:29:22.816403 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m15:29:22.816928 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m15:29:22.818129 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m15:29:22.818728 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m15:29:22.818917 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m15:29:22.819117 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:29:22.826442 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m15:29:22.826663 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m15:29:22.826830 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:29:22.828120 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:29:22.829081 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m15:29:22.830114 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m15:29:22.830463 [info ] [Thread-3 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m15:29:22.830769 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m15:29:22.831581 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.831901 [debug] [MainThread]: On master: BEGIN
[0m15:29:22.832056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:22.839731 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:29:22.840010 [debug] [MainThread]: On master: COMMIT
[0m15:29:22.840173 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:22.840300 [debug] [MainThread]: On master: COMMIT
[0m15:29:22.840850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:22.841011 [debug] [MainThread]: On master: Close
[0m15:29:22.841244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:22.841424 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m15:29:22.841562 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m15:29:22.841675 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m15:29:22.841784 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m15:29:22.841955 [info ] [MainThread]: 
[0m15:29:22.842107 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:29:22.842824 [debug] [MainThread]: Command end result
[0m15:29:22.855950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:29:22.856960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:29:22.860258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:29:22.860430 [info ] [MainThread]: 
[0m15:29:22.860615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:22.860756 [info ] [MainThread]: 
[0m15:29:22.860902 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:29:22.861790 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.57929933, "process_in_blocks": "0", "process_kernel_time": 0.193371, "process_mem_max_rss": "132349952", "process_out_blocks": "0", "process_user_time": 1.027154}
[0m15:29:22.861981 [debug] [MainThread]: Command `dbt test` succeeded at 15:29:22.861943 after 0.58 seconds
[0m15:29:22.862167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102654d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d36cd0>]}
[0m15:29:22.862364 [debug] [MainThread]: Flushing usage events
[0m15:29:24.050664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:14.369807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747ddd0>]}


============================== 15:31:14.372591 | 6065234a-09b1-4539-853f-890609c11f26 ==============================
[0m15:31:14.372591 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:31:14.372917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:31:14.510215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795e590>]}
[0m15:31:14.534938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105583f10>]}
[0m15:31:14.535653 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:31:14.609155 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:31:14.688449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:14.688725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:14.709591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812f5d0>]}
[0m15:31:14.747088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:31:14.750176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:31:14.762834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d7d90>]}
[0m15:31:14.763132 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m15:31:14.763308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108014e50>]}
[0m15:31:14.764275 [info ] [MainThread]: 
[0m15:31:14.764462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:14.764591 [info ] [MainThread]: 
[0m15:31:14.764838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:31:14.766680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:31:14.797602 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:31:14.797877 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:31:14.798017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:14.829288 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m15:31:14.830054 [debug] [ThreadPool]: On list_airflow: Close
[0m15:31:14.830818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m15:31:14.833826 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:31:14.834020 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m15:31:14.834150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:14.841477 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:31:14.841789 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m15:31:14.841975 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:31:14.844026 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.002 seconds
[0m15:31:14.845168 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m15:31:14.845828 [debug] [ThreadPool]: On list_airflow_public: Close
[0m15:31:14.850864 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:14.851142 [debug] [MainThread]: On master: BEGIN
[0m15:31:14.851274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:14.858526 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:31:14.858668 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:14.858857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:14.861202 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:31:14.862013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798b490>]}
[0m15:31:14.862300 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:14.862844 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:14.863016 [debug] [MainThread]: On master: BEGIN
[0m15:31:14.863956 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:31:14.864160 [debug] [MainThread]: On master: COMMIT
[0m15:31:14.864318 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:14.864448 [debug] [MainThread]: On master: COMMIT
[0m15:31:14.864917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:14.865069 [debug] [MainThread]: On master: Close
[0m15:31:14.865913 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m15:31:14.866266 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m15:31:14.866543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m15:31:14.866740 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m15:31:14.871096 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m15:31:14.871534 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m15:31:14.889443 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m15:31:14.889996 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.890165 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m15:31:14.890312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:14.899000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:31:14.899286 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.899478 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m15:31:14.904355 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.005 seconds
[0m15:31:14.907839 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.908040 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m15:31:14.908792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:14.910274 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.910451 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m15:31:14.911068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:14.920435 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:31:14.920684 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.920842 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m15:31:14.927599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:31:14.930935 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m15:31:14.933238 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m15:31:14.933417 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m15:31:14.937074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:31:14.938355 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m15:31:14.939449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ecc10>]}
[0m15:31:14.939822 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 2187[0m in 0.07s]
[0m15:31:14.940095 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m15:31:14.940536 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m15:31:14.940709 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m15:31:14.940880 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m15:31:14.941104 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m15:31:14.941334 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m15:31:14.941549 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m15:31:14.941899 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m15:31:14.942118 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m15:31:14.942314 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m15:31:14.942470 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m15:31:14.942619 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m15:31:14.942772 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m15:31:14.944190 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m15:31:14.945513 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m15:31:14.947040 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m15:31:14.947512 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m15:31:14.947661 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m15:31:14.947802 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m15:31:14.950587 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m15:31:14.983763 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m15:31:14.985899 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m15:31:14.986435 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:14.986603 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m15:31:14.986750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:31:14.987024 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:14.987208 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:14.987381 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m15:31:14.987534 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m15:31:14.987696 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:31:14.987876 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:31:15.000443 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:31:15.000656 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m15:31:15.000866 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:15.001041 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:15.001250 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m15:31:15.001471 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m15:31:15.006592 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.005 seconds
[0m15:31:15.008506 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:15.008711 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.007 seconds
[0m15:31:15.008938 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m15:31:15.010578 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:15.010828 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m15:31:15.011359 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:15.011523 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:15.012914 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:15.014208 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:15.014441 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m15:31:15.014623 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m15:31:15.015308 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:15.015474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:15.016233 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:31:15.016937 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:31:15.017100 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:15.017248 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:15.017393 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m15:31:15.017534 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m15:31:15.018561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:15.018724 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:31:15.019791 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m15:31:15.020872 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m15:31:15.021217 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m15:31:15.021522 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m15:31:15.021681 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m15:31:15.021853 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m15:31:15.023115 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:31:15.023737 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m15:31:15.023897 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:31:15.024548 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m15:31:15.024834 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108305e10>]}
[0m15:31:15.025154 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f4450>]}
[0m15:31:15.025506 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m15:31:15.025864 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.08s]
[0m15:31:15.026216 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m15:31:15.026507 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m15:31:20.013337 [debug] [Thread-4 (]: SQL status: BEGIN in 5.025 seconds
[0m15:31:20.014215 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:20.014698 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m15:31:20.066221 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.051 seconds
[0m15:31:20.071502 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:20.071803 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m15:31:20.072758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:20.074818 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:20.075037 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m15:31:20.075709 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:31:20.076799 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:31:20.077020 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:20.077209 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m15:31:20.082893 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m15:31:20.086721 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m15:31:20.087187 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m15:31:20.087411 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m15:31:20.089324 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:31:20.090274 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m15:31:20.090666 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe9d90>]}
[0m15:31:20.091080 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 5.15s]
[0m15:31:20.091427 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m15:31:20.091849 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m15:31:20.092271 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m15:31:20.092616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m15:31:20.092842 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m15:31:20.096801 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m15:31:20.097340 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m15:31:20.100328 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m15:31:20.101235 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.101637 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m15:31:20.101963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:20.111101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:31:20.111435 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.111715 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m15:31:20.183040 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.071 seconds
[0m15:31:20.187404 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.187672 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m15:31:20.188708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:20.190239 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.190432 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m15:31:20.191142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:31:20.191963 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:31:20.192137 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.192284 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m15:31:20.194292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:31:20.195468 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m15:31:20.195867 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m15:31:20.196036 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m15:31:20.197521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:31:20.198138 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m15:31:20.198434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6065234a-09b1-4539-853f-890609c11f26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108049690>]}
[0m15:31:20.198739 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.11s]
[0m15:31:20.198999 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m15:31:20.199655 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:20.199822 [debug] [MainThread]: On master: BEGIN
[0m15:31:20.199954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:20.206758 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:31:20.206985 [debug] [MainThread]: On master: COMMIT
[0m15:31:20.207128 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:20.207256 [debug] [MainThread]: On master: COMMIT
[0m15:31:20.207726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:31:20.207868 [debug] [MainThread]: On master: Close
[0m15:31:20.208062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:20.208187 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m15:31:20.208304 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m15:31:20.208417 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m15:31:20.208525 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m15:31:20.208708 [info ] [MainThread]: 
[0m15:31:20.208868 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m15:31:20.209376 [debug] [MainThread]: Command end result
[0m15:31:20.221260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m15:31:20.222158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m15:31:20.225277 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m15:31:20.225459 [info ] [MainThread]: 
[0m15:31:20.225655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:20.225799 [info ] [MainThread]: 
[0m15:31:20.225954 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:31:20.227420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.896975, "process_in_blocks": "0", "process_kernel_time": 0.2462, "process_mem_max_rss": "128270336", "process_out_blocks": "0", "process_user_time": 1.09582}
[0m15:31:20.227664 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:20.227618 after 5.90 seconds
[0m15:31:20.227872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030cfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c8dd0>]}
[0m15:31:20.228064 [debug] [MainThread]: Flushing usage events
[0m15:31:21.655537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:20.239212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d995850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d995390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9f5b90>]}


============================== 17:27:20.242266 | 90f6c882-66f4-4aa9-a8d6-72bd48f009a9 ==============================
[0m17:27:20.242266 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:27:20.242655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:27:20.385127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9f46d0>]}
[0m17:27:20.410044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9bf10>]}
[0m17:27:20.410845 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:20.463901 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:27:20.548935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:20.549264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:20.570863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a49d0>]}
[0m17:27:20.609993 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:27:20.613004 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:27:20.633141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb3fd0>]}
[0m17:27:20.633487 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m17:27:20.633669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e580e50>]}
[0m17:27:20.634789 [info ] [MainThread]: 
[0m17:27:20.634974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:20.635106 [info ] [MainThread]: 
[0m17:27:20.635361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:20.637281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m17:27:20.668806 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:27:20.669100 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m17:27:20.669239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:20.703955 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m17:27:20.704211 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:27:20.704369 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:27:20.707229 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.003 seconds
[0m17:27:20.708350 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m17:27:20.708855 [debug] [ThreadPool]: On list_airflow_public: Close
[0m17:27:20.714054 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.714274 [debug] [MainThread]: On master: BEGIN
[0m17:27:20.714409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:20.723632 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:27:20.723887 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.724104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:20.726877 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:27:20.727647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f6c882-66f4-4aa9-a8d6-72bd48f009a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece7090>]}
[0m17:27:20.727924 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:20.728572 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.728719 [debug] [MainThread]: On master: BEGIN
[0m17:27:20.729481 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:27:20.729633 [debug] [MainThread]: On master: COMMIT
[0m17:27:20.729769 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.729890 [debug] [MainThread]: On master: COMMIT
[0m17:27:20.730395 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:20.730538 [debug] [MainThread]: On master: Close
[0m17:27:20.731423 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:27:20.731606 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:27:20.731941 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:27:20.731801 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m17:27:20.732299 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:27:20.732496 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m17:27:20.732950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m17:27:20.732686 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m17:27:20.733176 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m17:27:20.733397 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m17:27:20.733563 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:27:20.733754 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m17:27:20.733987 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m17:27:20.734156 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:27:20.742737 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:27:20.743025 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:27:20.743208 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:27:20.745172 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:27:20.747047 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:27:20.750818 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:27:20.751117 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:27:20.757924 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:27:20.758270 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:27:20.758437 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:27:20.758613 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:27:20.759732 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:27:20.759919 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:27:20.761688 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:27:20.794494 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:27:20.794933 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m17:27:20.795357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:20.795706 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:27:20.795894 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:27:20.796096 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m17:27:20.796286 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:27:20.796463 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m17:27:20.796646 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:27:20.796838 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m17:27:20.797008 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:20.797236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:27:20.810507 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m17:27:20.810812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:27:20.811065 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m17:27:20.811307 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:27:20.811478 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:27:20.811736 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:27:20.812045 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "airflow"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:27:20.812281 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m17:27:20.812446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m17:27:20.812629 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "airflow"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m17:27:20.812926 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:27:20.813243 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "airflow"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m17:27:20.813499 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m17:27:20.813716 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m17:27:20.813896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:27:20.816171 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m17:27:20.816423 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:27:20.816599 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:27:20.816835 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m17:27:20.817586 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m17:27:20.818294 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m17:27:20.818540 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m17:27:20.819526 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m17:27:20.819994 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.09s]
[0m17:27:20.820317 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m17:27:20.820675 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.09s]
[0m17:27:20.820954 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:27:20.821252 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.09s]
[0m17:27:20.821615 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:27:20.821954 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:27:20.822288 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:27:20.822488 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:27:20.822827 [info ] [Thread-1 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m17:27:20.823130 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:27:20.823381 [info ] [Thread-3 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m17:27:20.823747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m17:27:20.824009 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m17:27:20.824355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m17:27:20.824587 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:27:20.824850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m17:27:20.825076 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:27:20.828287 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:27:20.828530 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:27:20.831056 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:27:20.834175 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:27:20.834586 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:27:20.835890 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:27:20.836098 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:27:20.836340 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:27:20.837528 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:27:20.838549 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:27:20.838851 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:27:20.839227 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m17:27:20.839421 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:27:20.839677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:20.840506 [debug] [Thread-4 (]: Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql
[0m17:27:20.840735 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:27:20.840896 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m17:27:20.841320 [error] [Thread-4 (]: 4 of 9 ERROR relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[31mERROR[0m in 0.11s]
[0m17:27:20.841571 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m17:27:20.841788 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:20.842114 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:27:20.842349 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:27:20.842771 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:27:20.843098 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql.
[0m17:27:20.843473 [info ] [Thread-4 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m17:27:20.844161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m17:27:20.844363 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:27:20.846484 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:27:20.846870 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:27:20.848118 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:27:20.848575 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:27:20.848755 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m17:27:20.848920 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:27:20.859498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m17:27:20.859797 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:27:20.859991 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:27:20.860206 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m17:27:20.860494 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:27:20.860744 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:27:20.861063 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m17:27:20.861290 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m17:27:20.861530 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m17:27:20.861730 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:27:20.861900 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:27:20.862068 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:27:20.862263 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m17:27:20.862459 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "airflow"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:27:20.862648 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:27:20.863417 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m17:27:20.864215 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m17:27:20.864488 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m17:27:20.864688 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m17:27:20.865540 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:27:20.865854 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m17:27:20.866228 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m17:27:20.867085 [debug] [Thread-1 (]: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m17:27:20.867877 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m17:27:20.868189 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:27:20.868519 [error] [Thread-1 (]: 5 of 9 ERROR relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ .. [[31mERROR[0m in 0.04s]
[0m17:27:20.868814 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m17:27:20.869069 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:27:20.869438 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:27:20.869638 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m17:27:20.870396 [info ] [Thread-2 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m17:27:20.870702 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql.
[0m17:27:20.871055 [info ] [Thread-4 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.03s]
[0m17:27:20.871834 [debug] [Thread-3 (]: Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql
[0m17:27:20.872094 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.unique_dim_broker_broker_id.4fb11e03af, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m17:27:20.872419 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:27:20.872756 [error] [Thread-3 (]: 6 of 9 ERROR relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[31mERROR[0m in 0.05s]
[0m17:27:20.872963 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:27:20.873282 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:27:20.875617 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:27:20.875880 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql.
[0m17:27:20.876269 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:27:20.877372 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:27:20.877696 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:27:20.877849 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m17:27:20.877986 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:20.885924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m17:27:20.886079 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:27:20.886235 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:27:20.887440 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:27:20.888454 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m17:27:20.889102 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m17:27:20.889477 [info ] [Thread-2 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m17:27:20.889887 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:27:20.890737 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.890951 [debug] [MainThread]: On master: BEGIN
[0m17:27:20.891071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:20.898414 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:27:20.898668 [debug] [MainThread]: On master: COMMIT
[0m17:27:20.898822 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:20.898947 [debug] [MainThread]: On master: COMMIT
[0m17:27:20.899515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:20.899697 [debug] [MainThread]: On master: Close
[0m17:27:20.899978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:20.900137 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m17:27:20.900267 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m17:27:20.900388 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m17:27:20.900500 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m17:27:20.900659 [info ] [MainThread]: 
[0m17:27:20.900809 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:27:20.901599 [debug] [MainThread]: Command end result
[0m17:27:20.914026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:27:20.914954 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:27:20.918411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m17:27:20.918637 [info ] [MainThread]: 
[0m17:27:20.918827 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:27:20.918975 [info ] [MainThread]: 
[0m17:27:20.919153 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql
[0m17:27:20.919291 [info ] [MainThread]: 
[0m17:27:20.919451 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m17:27:20.919582 [info ] [MainThread]: 
[0m17:27:20.919740 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql
[0m17:27:20.919879 [info ] [MainThread]: 
[0m17:27:20.920015 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m17:27:20.921178 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.7231072, "process_in_blocks": "0", "process_kernel_time": 0.250362, "process_mem_max_rss": "133693440", "process_out_blocks": "0", "process_user_time": 1.086958}
[0m17:27:20.921365 [debug] [MainThread]: Command `dbt test` failed at 17:27:20.921329 after 0.72 seconds
[0m17:27:20.921558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab7510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105484ed0>]}
[0m17:27:20.921743 [debug] [MainThread]: Flushing usage events
[0m17:27:22.031999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:14.804185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106720a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067814d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781b50>]}


============================== 17:28:14.806952 | db23b510-1c86-49bc-8816-de8f61f16d83 ==============================
[0m17:28:14.806952 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:28:14.807270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:14.910579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673ad50>]}
[0m17:28:14.934497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a0350>]}
[0m17:28:14.935155 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:28:14.985343 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:28:15.060253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:15.060500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:15.080923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107484950>]}
[0m17:28:15.120855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:28:15.123938 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:28:15.135854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dbf90>]}
[0m17:28:15.136132 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m17:28:15.136305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734fa50>]}
[0m17:28:15.137256 [info ] [MainThread]: 
[0m17:28:15.137441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:15.137574 [info ] [MainThread]: 
[0m17:28:15.137819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:15.139648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m17:28:15.169424 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m17:28:15.169683 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m17:28:15.169819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:15.202369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m17:28:15.203117 [debug] [ThreadPool]: On list_airflow: Close
[0m17:28:15.203874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m17:28:15.206949 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:28:15.207139 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m17:28:15.207270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:15.215717 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:28:15.215962 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:28:15.216132 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:28:15.218271 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.002 seconds
[0m17:28:15.219334 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m17:28:15.219890 [debug] [ThreadPool]: On list_airflow_public: Close
[0m17:28:15.224945 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.225135 [debug] [MainThread]: On master: BEGIN
[0m17:28:15.225260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:15.233518 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:28:15.233734 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.233973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:28:15.236182 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m17:28:15.236735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfd250>]}
[0m17:28:15.236972 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:15.237479 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.237644 [debug] [MainThread]: On master: BEGIN
[0m17:28:15.238488 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:28:15.238730 [debug] [MainThread]: On master: COMMIT
[0m17:28:15.238889 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.239023 [debug] [MainThread]: On master: COMMIT
[0m17:28:15.239553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:15.239737 [debug] [MainThread]: On master: Close
[0m17:28:15.240524 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m17:28:15.240862 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m17:28:15.241160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m17:28:15.241415 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m17:28:15.245648 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m17:28:15.246352 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m17:28:15.267558 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m17:28:15.268647 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.269675 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m17:28:15.269861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:15.280923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:28:15.281206 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.281395 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m17:28:15.299581 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.018 seconds
[0m17:28:15.303294 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.303505 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m17:28:15.304393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:15.305889 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.306073 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m17:28:15.306733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:15.316299 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m17:28:15.316580 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.316754 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m17:28:15.318776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:28:15.321738 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m17:28:15.323925 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:28:15.324110 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m17:28:15.329661 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:28:15.331074 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m17:28:15.332531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f9210>]}
[0m17:28:15.332952 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.09s]
[0m17:28:15.333260 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m17:28:15.333698 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m17:28:15.333874 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m17:28:15.334064 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m17:28:15.334283 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m17:28:15.334594 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m17:28:15.334846 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m17:28:15.335102 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m17:28:15.335323 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m17:28:15.335520 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m17:28:15.335681 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m17:28:15.335843 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m17:28:15.335994 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m17:28:15.337689 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m17:28:15.339036 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m17:28:15.340597 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m17:28:15.341327 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m17:28:15.341539 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m17:28:15.343834 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m17:28:15.344023 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m17:28:15.377202 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m17:28:15.379462 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m17:28:15.379868 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.380034 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m17:28:15.380177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:28:15.380480 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.380668 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m17:28:15.380834 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:28:15.381172 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.381337 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m17:28:15.381484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:28:15.389256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m17:28:15.389492 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m17:28:15.389722 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.389929 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.390173 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m17:28:15.390430 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m17:28:15.390808 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:28:15.391054 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.391257 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m17:28:15.395836 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.005 seconds
[0m17:28:15.397698 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.397881 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.006 seconds
[0m17:28:15.398081 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m17:28:15.399672 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.399904 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m17:28:15.400473 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:15.401781 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.401954 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m17:28:15.402123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:28:15.403426 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.403604 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m17:28:15.403779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:28:15.404608 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m17:28:15.404774 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.404918 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m17:28:15.405080 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:15.405827 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m17:28:15.405991 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.406204 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:28:15.406366 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m17:28:15.407449 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m17:28:15.407867 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:28:15.408028 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m17:28:15.408329 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:28:15.409834 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m17:28:15.410243 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:28:15.410446 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:28:15.410697 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m17:28:15.411339 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m17:28:15.411675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7c390>]}
[0m17:28:15.411979 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.08s]
[0m17:28:15.412232 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m17:28:15.413915 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:28:15.414625 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m17:28:15.414921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a77e50>]}
[0m17:28:15.415231 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m17:28:15.415500 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m17:28:15.431144 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.040 seconds
[0m17:28:15.433225 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.433435 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m17:28:15.434295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:15.435643 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.435812 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m17:28:15.436384 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:28:15.437134 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m17:28:15.437293 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.437434 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m17:28:15.441732 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:28:15.443008 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m17:28:15.443363 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:28:15.443529 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m17:28:15.446143 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:28:15.446761 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m17:28:15.447076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6c810>]}
[0m17:28:15.447397 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.11s]
[0m17:28:15.447664 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m17:28:15.448029 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m17:28:15.448270 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m17:28:15.448478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m17:28:15.448639 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m17:28:15.451660 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m17:28:15.452101 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m17:28:15.454161 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m17:28:15.454572 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:28:15.454737 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m17:28:15.454884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:15.462548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:28:15.462944 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:28:15.463166 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m17:28:15.559286 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.096 seconds
[0m17:28:15.561019 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:28:15.561207 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m17:28:15.562116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:15.562852 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m17:28:15.563026 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:28:15.563178 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m17:28:15.564682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:28:15.565826 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m17:28:15.566205 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:28:15.566364 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m17:28:15.566951 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:28:15.567540 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m17:28:15.567823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db23b510-1c86-49bc-8816-de8f61f16d83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079757d0>]}
[0m17:28:15.568131 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.12s]
[0m17:28:15.568389 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m17:28:15.569020 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.569175 [debug] [MainThread]: On master: BEGIN
[0m17:28:15.569302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:15.576549 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:28:15.576771 [debug] [MainThread]: On master: COMMIT
[0m17:28:15.576911 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:15.577033 [debug] [MainThread]: On master: COMMIT
[0m17:28:15.577679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:15.578007 [debug] [MainThread]: On master: Close
[0m17:28:15.578261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:15.578398 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m17:28:15.578518 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m17:28:15.578631 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m17:28:15.578737 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m17:28:15.578912 [info ] [MainThread]: 
[0m17:28:15.579071 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m17:28:15.579632 [debug] [MainThread]: Command end result
[0m17:28:15.592222 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:28:15.593353 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:28:15.596768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m17:28:15.596996 [info ] [MainThread]: 
[0m17:28:15.597221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:15.597422 [info ] [MainThread]: 
[0m17:28:15.597595 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:28:15.598880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8314302, "process_in_blocks": "0", "process_kernel_time": 0.216659, "process_mem_max_rss": "128434176", "process_out_blocks": "0", "process_user_time": 1.047237}
[0m17:28:15.599121 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:15.599079 after 0.83 seconds
[0m17:28:15.599337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023d3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024cce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b76d0>]}
[0m17:28:15.599537 [debug] [MainThread]: Flushing usage events
[0m17:28:16.953726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:19.547189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e96410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efdfd0>]}


============================== 17:28:19.550019 | b4511f69-bb71-428d-808b-7831b2f47257 ==============================
[0m17:28:19.550019 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:28:19.550386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:28:19.644959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd3d10>]}
[0m17:28:19.671374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad4650>]}
[0m17:28:19.672031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:28:19.720351 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:28:19.776273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:19.776543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:19.798425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106588610>]}
[0m17:28:19.837109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:28:19.840311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:28:19.856897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b3710>]}
[0m17:28:19.857295 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m17:28:19.857539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657fb90>]}
[0m17:28:19.858778 [info ] [MainThread]: 
[0m17:28:19.859032 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:19.859308 [info ] [MainThread]: 
[0m17:28:19.859655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:19.861642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m17:28:19.886806 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:28:19.887077 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m17:28:19.887223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:19.907482 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m17:28:19.907742 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:28:19.907896 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:28:19.909956 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.002 seconds
[0m17:28:19.911156 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m17:28:19.911878 [debug] [ThreadPool]: On list_airflow_public: Close
[0m17:28:19.917151 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:19.917396 [debug] [MainThread]: On master: BEGIN
[0m17:28:19.917532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:19.925617 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:28:19.925882 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:19.926080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:28:19.928472 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m17:28:19.929370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4511f69-bb71-428d-808b-7831b2f47257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062668d0>]}
[0m17:28:19.929661 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:19.930303 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:19.930487 [debug] [MainThread]: On master: BEGIN
[0m17:28:19.931519 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:28:19.931694 [debug] [MainThread]: On master: COMMIT
[0m17:28:19.931832 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:19.931953 [debug] [MainThread]: On master: COMMIT
[0m17:28:19.932524 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:19.932706 [debug] [MainThread]: On master: Close
[0m17:28:19.933760 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:28:19.934006 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:28:19.934190 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:28:19.934373 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:28:19.934591 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m17:28:19.934802 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m17:28:19.935014 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m17:28:19.935190 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m17:28:19.935425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m17:28:19.935642 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m17:28:19.935848 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m17:28:19.936045 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m17:28:19.936199 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:28:19.936350 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:28:19.936487 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:28:19.936631 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:28:19.944591 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:28:19.946711 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:28:19.948445 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:28:19.954161 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:28:19.954847 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:28:19.955154 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:28:19.955314 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:28:19.962359 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:28:19.963635 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:28:19.965722 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:28:19.965942 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:28:19.966623 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:28:19.997324 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:28:19.997642 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:28:19.997861 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:28:19.998075 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m17:28:19.998427 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m17:28:19.998697 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m17:28:19.998931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:19.999166 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:28:19.999363 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:28:19.999538 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:28:19.999787 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m17:28:20.000080 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:28:20.013273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:28:20.013575 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m17:28:20.013755 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m17:28:20.014933 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:28:20.017185 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m17:28:20.017424 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m17:28:20.017599 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m17:28:20.017763 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m17:28:20.018006 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m17:28:20.018176 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m17:28:20.018378 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m17:28:20.018602 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "airflow"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m17:28:20.018765 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m17:28:20.018938 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "airflow"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m17:28:20.019132 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "airflow"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:28:20.019511 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.08s]
[0m17:28:20.019970 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m17:28:20.020208 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:28:20.020575 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:28:20.020394 [info ] [Thread-1 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m17:28:20.020867 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:28:20.021595 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m17:28:20.021857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m17:28:20.022028 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:28:20.022652 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m17:28:20.022875 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:28:20.023485 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m17:28:20.023664 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m17:28:20.026791 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:28:20.027034 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m17:28:20.027574 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.09s]
[0m17:28:20.028011 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.09s]
[0m17:28:20.028245 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m17:28:20.028480 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m17:28:20.028754 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m17:28:20.029299 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:28:20.029507 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:28:20.029115 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.09s]
[0m17:28:20.029930 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:28:20.030199 [info ] [Thread-3 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m17:28:20.031722 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:28:20.032031 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m17:28:20.032213 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m17:28:20.032435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m17:28:20.032758 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:28:20.033044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m17:28:20.033264 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:28:20.033480 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:28:20.033668 [info ] [Thread-4 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m17:28:20.033866 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:28:20.036775 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:28:20.037017 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m17:28:20.037300 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m17:28:20.040638 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:28:20.041033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:20.041403 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:28:20.041710 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:28:20.044047 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:28:20.044314 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:28:20.045687 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:28:20.047027 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:28:20.047448 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:28:20.048728 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:28:20.048980 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:28:20.049237 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:28:20.049611 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m17:28:20.049869 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m17:28:20.050092 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:20.050274 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:28:20.050467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:28:20.050636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:20.050875 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m17:28:20.051042 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m17:28:20.051257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:28:20.051440 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:28:20.053423 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:28:20.054258 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m17:28:20.054904 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m17:28:20.055243 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.03s]
[0m17:28:20.055624 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m17:28:20.055904 [debug] [Thread-1 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:28:20.056160 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m17:28:20.056411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m17:28:20.056587 [debug] [Thread-1 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:28:20.058670 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:28:20.059097 [debug] [Thread-1 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:28:20.060564 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:28:20.061063 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:28:20.061248 [debug] [Thread-1 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m17:28:20.061399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:20.061632 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:28:20.061903 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m17:28:20.062118 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m17:28:20.062337 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m17:28:20.062543 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:28:20.062761 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "airflow"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m17:28:20.062958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m17:28:20.063242 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m17:28:20.063446 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:28:20.064476 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:28:20.065432 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m17:28:20.065684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:28:20.065884 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:28:20.066745 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m17:28:20.066974 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m17:28:20.067643 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m17:28:20.068035 [info ] [Thread-3 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.04s]
[0m17:28:20.068308 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m17:28:20.068462 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m17:28:20.068613 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m17:28:20.068969 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m17:28:20.069168 [info ] [Thread-4 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.03s]
[0m17:28:20.069590 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m17:28:20.069914 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m17:28:20.071749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:28:20.071968 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m17:28:20.072152 [debug] [Thread-1 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:28:20.073451 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:28:20.074343 [debug] [Thread-1 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m17:28:20.075029 [debug] [Thread-1 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m17:28:20.075436 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m17:28:20.075713 [debug] [Thread-1 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m17:28:20.076499 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:20.076706 [debug] [MainThread]: On master: BEGIN
[0m17:28:20.076845 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:20.085130 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:28:20.085402 [debug] [MainThread]: On master: COMMIT
[0m17:28:20.085554 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:20.085678 [debug] [MainThread]: On master: COMMIT
[0m17:28:20.086157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:20.086320 [debug] [MainThread]: On master: Close
[0m17:28:20.086538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:20.086671 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m17:28:20.086790 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m17:28:20.086904 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m17:28:20.087020 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m17:28:20.087190 [info ] [MainThread]: 
[0m17:28:20.087349 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m17:28:20.088166 [debug] [MainThread]: Command end result
[0m17:28:20.100075 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:28:20.100949 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:28:20.104023 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m17:28:20.104179 [info ] [MainThread]: 
[0m17:28:20.104352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:20.104483 [info ] [MainThread]: 
[0m17:28:20.104620 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m17:28:20.105471 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5941574, "process_in_blocks": "0", "process_kernel_time": 0.182058, "process_mem_max_rss": "133316608", "process_out_blocks": "0", "process_user_time": 1.060281}
[0m17:28:20.105650 [debug] [MainThread]: Command `dbt test` succeeded at 17:28:20.105616 after 0.59 seconds
[0m17:28:20.105822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100607f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100700e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006eb6d0>]}
[0m17:28:20.105999 [debug] [MainThread]: Flushing usage events
[0m17:28:21.347023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:35.368175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107030f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107031f50>]}


============================== 17:30:35.371377 | 1433e465-1b50-4a44-9dab-4900c05514b0 ==============================
[0m17:30:35.371377 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:30:35.371708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -f', 'send_anonymous_usage_stats': 'True'}
[0m17:30:35.510615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758e190>]}
[0m17:30:35.534603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105150050>]}
[0m17:30:35.535271 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:30:35.586044 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:30:35.664424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:35.664678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:35.685191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107029950>]}
[0m17:30:35.724258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:30:35.727750 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:30:35.744248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8fad0>]}
[0m17:30:35.744715 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m17:30:35.744897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761c750>]}
[0m17:30:35.745890 [info ] [MainThread]: 
[0m17:30:35.746070 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:35.746196 [info ] [MainThread]: 
[0m17:30:35.746436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:35.748414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m17:30:35.780607 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m17:30:35.780875 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m17:30:35.781018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:35.807241 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m17:30:35.808057 [debug] [ThreadPool]: On list_airflow: Close
[0m17:30:35.808805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m17:30:35.811945 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:30:35.812180 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m17:30:35.812310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:35.822472 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:30:35.822749 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m17:30:35.822931 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:30:35.826509 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.003 seconds
[0m17:30:35.827655 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m17:30:35.828374 [debug] [ThreadPool]: On list_airflow_public: Close
[0m17:30:35.833953 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:35.834185 [debug] [MainThread]: On master: BEGIN
[0m17:30:35.834311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:35.842381 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:30:35.842615 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:35.842810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:35.845320 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m17:30:35.846049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575590>]}
[0m17:30:35.846368 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:35.847183 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:35.847359 [debug] [MainThread]: On master: BEGIN
[0m17:30:35.848226 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:30:35.848394 [debug] [MainThread]: On master: COMMIT
[0m17:30:35.848536 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:35.848668 [debug] [MainThread]: On master: COMMIT
[0m17:30:35.849155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:35.849296 [debug] [MainThread]: On master: Close
[0m17:30:35.850093 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m17:30:35.850355 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m17:30:35.850582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m17:30:35.850746 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m17:30:35.855733 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m17:30:35.857572 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m17:30:35.876089 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m17:30:35.876685 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.876856 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m17:30:35.877008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:35.884415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:30:35.884686 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.884879 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m17:30:35.895711 [debug] [Thread-1 (]: SQL status: SELECT 6561 in 0.011 seconds
[0m17:30:35.899228 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.899428 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m17:30:35.900314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:35.901752 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.901929 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m17:30:35.902540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:30:35.911402 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m17:30:35.911633 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.911792 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m17:30:35.919349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m17:30:35.922523 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m17:30:35.924756 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m17:30:35.924940 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m17:30:35.927227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:30:35.928551 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m17:30:35.929653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082004d0>]}
[0m17:30:35.930113 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 6561[0m in 0.08s]
[0m17:30:35.930414 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m17:30:35.930908 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m17:30:35.931105 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m17:30:35.931299 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m17:30:35.931529 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m17:30:35.931741 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m17:30:35.931962 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m17:30:35.932266 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m17:30:35.932501 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m17:30:35.932733 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m17:30:35.932901 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m17:30:35.933055 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m17:30:35.933199 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m17:30:35.934803 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m17:30:35.936260 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m17:30:35.937843 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m17:30:35.938594 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m17:30:35.940675 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m17:30:35.940842 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m17:30:35.941000 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m17:30:35.975926 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m17:30:35.978162 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m17:30:35.978464 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:35.978734 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m17:30:35.978885 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:30:35.979150 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:35.979346 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m17:30:35.979509 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:30:35.979744 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:35.979989 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m17:30:35.980144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:30:35.987946 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m17:30:35.988199 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:35.988429 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m17:30:35.988670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m17:30:35.988908 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m17:30:35.989157 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:35.989357 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:35.989628 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m17:30:35.989866 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m17:30:35.996052 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.006 seconds
[0m17:30:35.997893 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:35.998083 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m17:30:35.998269 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.008 seconds
[0m17:30:35.999903 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:36.000178 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:30:36.000355 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m17:30:36.001648 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:36.001865 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m17:30:36.002549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.002728 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.003539 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m17:30:36.005061 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:36.005268 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:36.005428 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m17:30:36.005585 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m17:30:36.006431 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.007256 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m17:30:36.007434 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:36.007597 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:30:36.007742 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m17:30:36.008953 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m17:30:36.009326 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m17:30:36.009487 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m17:30:36.009710 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.010834 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m17:30:36.010995 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:30:36.011333 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m17:30:36.011967 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m17:30:36.012153 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m17:30:36.012463 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd9c10>]}
[0m17:30:36.012767 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.08s]
[0m17:30:36.013026 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m17:30:36.013540 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:30:36.014175 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m17:30:36.014442 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107015110>]}
[0m17:30:36.014729 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m17:30:36.015014 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m17:30:36.026758 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.037 seconds
[0m17:30:36.028797 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:36.028980 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m17:30:36.029824 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.031163 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:36.031329 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m17:30:36.031969 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:30:36.032737 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m17:30:36.032897 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:36.033038 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m17:30:36.033908 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.034999 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m17:30:36.035311 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m17:30:36.035465 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m17:30:36.036695 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:30:36.037344 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m17:30:36.037712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108163990>]}
[0m17:30:36.038052 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.11s]
[0m17:30:36.038324 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m17:30:36.038655 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m17:30:36.038889 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m17:30:36.039109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m17:30:36.039267 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m17:30:36.042345 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m17:30:36.042818 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m17:30:36.045080 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m17:30:36.045506 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:30:36.045671 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m17:30:36.045817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:36.056005 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:30:36.056268 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:30:36.056486 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m17:30:36.251674 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.195 seconds
[0m17:30:36.253441 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:30:36.253642 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m17:30:36.254471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:36.255218 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m17:30:36.255394 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:30:36.255544 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m17:30:36.257162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.258306 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m17:30:36.258628 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m17:30:36.258789 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m17:30:36.259725 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:30:36.260496 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m17:30:36.260827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1433e465-1b50-4a44-9dab-4900c05514b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081aba10>]}
[0m17:30:36.261154 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.22s]
[0m17:30:36.261421 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m17:30:36.262171 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.262336 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.262468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:36.270154 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:30:36.270588 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.270767 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.270898 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.271566 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:30:36.271705 [debug] [MainThread]: On master: Close
[0m17:30:36.271907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:36.272030 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m17:30:36.272142 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m17:30:36.272250 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m17:30:36.272355 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m17:30:36.272525 [info ] [MainThread]: 
[0m17:30:36.272678 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m17:30:36.273392 [debug] [MainThread]: Command end result
[0m17:30:36.284815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m17:30:36.285860 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m17:30:36.290190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m17:30:36.290507 [info ] [MainThread]: 
[0m17:30:36.290779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:36.290990 [info ] [MainThread]: 
[0m17:30:36.291206 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:30:36.292704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9639035, "process_in_blocks": "0", "process_kernel_time": 0.232551, "process_mem_max_rss": "128532480", "process_out_blocks": "0", "process_user_time": 1.053288}
[0m17:30:36.293036 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:36.292982 after 0.96 seconds
[0m17:30:36.293270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c90090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d16650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d67750>]}
[0m17:30:36.293485 [debug] [MainThread]: Flushing usage events
[0m17:30:37.695032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:56.540507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7d6d0>]}


============================== 18:35:56.543943 | 21c29599-f237-4b32-a85c-a158e01bbede ==============================
[0m18:35:56.543943 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:35:56.544475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:56.682682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c30310>]}
[0m18:35:56.706901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc5b50>]}
[0m18:35:56.707634 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:56.757948 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:35:56.839495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:35:56.839892 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/marts/schema.yml
[0m18:35:56.840080 [debug] [MainThread]: Partial parsing: updated file: real_estate://models/staging/sources.yml
[0m18:35:56.884619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795da10>]}
[0m18:35:56.922273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:35:56.925402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:35:56.944208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de4c10>]}
[0m18:35:56.944500 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:35:56.944670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd26d0>]}
[0m18:35:56.945728 [info ] [MainThread]: 
[0m18:35:56.945903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:35:56.946034 [info ] [MainThread]: 
[0m18:35:56.946281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:56.948157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m18:35:56.978781 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:35:56.979021 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m18:35:56.979160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:57.015434 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m18:35:57.015721 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:35:57.015958 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:35:57.018639 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.002 seconds
[0m18:35:57.019749 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m18:35:57.020241 [debug] [ThreadPool]: On list_airflow_public: Close
[0m18:35:57.025578 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.025788 [debug] [MainThread]: On master: BEGIN
[0m18:35:57.025921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:57.034816 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:35:57.035065 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.035273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:57.037641 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:35:57.066562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c29599-f237-4b32-a85c-a158e01bbede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108165e10>]}
[0m18:35:57.066916 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:57.069758 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.069924 [debug] [MainThread]: On master: BEGIN
[0m18:35:57.071651 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:35:57.071788 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.071916 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.072035 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.073494 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:35:57.073665 [debug] [MainThread]: On master: Close
[0m18:35:57.074604 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:35:57.074800 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:35:57.074968 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m18:35:57.075171 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m18:35:57.075335 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:35:57.075543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m18:35:57.075771 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:35:57.076147 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m18:35:57.076369 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m18:35:57.076609 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:35:57.076795 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m18:35:57.076999 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:35:57.077242 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m18:35:57.085589 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:35:57.085886 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m18:35:57.087718 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:35:57.088037 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:35:57.088330 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:35:57.090669 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:35:57.094664 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:35:57.095060 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:35:57.095621 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:35:57.102438 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:35:57.103738 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:35:57.103968 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:35:57.104226 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:35:57.105410 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:35:57.106541 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:35:57.106795 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:35:57.107007 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:35:57.107220 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m18:35:57.107401 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:35:57.107604 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m18:35:57.107780 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:35:57.107938 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:35:57.108090 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m18:35:57.108236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:57.108398 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m18:35:57.108621 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:35:57.108844 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:35:57.123963 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m18:35:57.124268 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m18:35:57.124477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:35:57.124619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m18:35:57.124831 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:35:57.124996 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:35:57.125148 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:35:57.125290 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:35:57.125459 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "airflow"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m18:35:57.125662 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "airflow"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:35:57.125841 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m18:35:57.126003 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "airflow"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m18:35:57.126810 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m18:35:57.127050 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m18:35:57.127259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:57.127471 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:57.127651 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:57.129952 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m18:35:57.130255 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m18:35:57.130870 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m18:35:57.131459 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m18:35:57.132334 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m18:35:57.133044 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m18:35:57.133218 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m18:35:57.132854 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.06s]
[0m18:35:57.133639 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.06s]
[0m18:35:57.134108 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.06s]
[0m18:35:57.134493 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:35:57.134793 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:35:57.135155 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:35:57.135416 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:35:57.135734 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:35:57.136018 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:35:57.136298 [info ] [Thread-1 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m18:35:57.136645 [info ] [Thread-3 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m18:35:57.136890 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m18:35:57.137160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m18:35:57.137406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m18:35:57.137636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m18:35:57.137855 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:35:57.138036 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:35:57.138276 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:35:57.142456 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:35:57.145321 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:35:57.148631 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:35:57.149297 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:35:57.149508 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:35:57.149705 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:35:57.151002 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:35:57.151881 [debug] [Thread-4 (]: Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql
[0m18:35:57.153040 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:35:57.154220 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:35:57.154570 [error] [Thread-4 (]: 4 of 9 ERROR relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[31mERROR[0m in 0.07s]
[0m18:35:57.154943 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:35:57.155248 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:35:57.155431 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:35:57.155610 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:35:57.155786 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m18:35:57.155971 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:35:57.156180 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql.
[0m18:35:57.156346 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m18:35:57.156501 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m18:35:57.156657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:57.156822 [info ] [Thread-4 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m18:35:57.157340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:35:57.157496 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:35:57.157766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m18:35:57.158056 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:35:57.160435 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:35:57.160897 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:35:57.162181 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:35:57.162670 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:35:57.162851 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m18:35:57.163002 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:35:57.168931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m18:35:57.169199 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m18:35:57.169476 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:35:57.169670 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:35:57.169915 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:35:57.170146 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "airflow"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:35:57.170871 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:35:57.171077 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m18:35:57.171276 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m18:35:57.171462 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.fact_all_apartment" does not exist
LINE 13:     from "airflow"."public"."fact_all_apartment"
                  ^

[0m18:35:57.171669 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:35:57.171842 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:35:57.172032 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m18:35:57.172217 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m18:35:57.172405 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:57.172630 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:57.173384 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m18:35:57.173594 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m18:35:57.174915 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:57.175110 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:35:57.176006 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m18:35:57.176881 [debug] [Thread-3 (]: Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql
[0m18:35:57.177703 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m18:35:57.178566 [debug] [Thread-1 (]: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m18:35:57.179008 [error] [Thread-3 (]: 6 of 9 ERROR relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[31mERROR[0m in 0.04s]
[0m18:35:57.179497 [error] [Thread-1 (]: 5 of 9 ERROR relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ .. [[31mERROR[0m in 0.04s]
[0m18:35:57.179800 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m18:35:57.179953 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m18:35:57.180193 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:35:57.180433 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:35:57.180758 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m18:35:57.181048 [info ] [Thread-4 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.02s]
[0m18:35:57.181282 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:35:57.181555 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql.
[0m18:35:57.181850 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:35:57.182079 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:35:57.182289 [info ] [Thread-3 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m18:35:57.182556 [debug] [Thread-7 (]: Marking all children of 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql.
[0m18:35:57.182827 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m18:35:57.183050 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:35:57.185328 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:35:57.185789 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:35:57.186853 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:35:57.187163 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:35:57.187327 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m18:35:57.187529 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:35:57.195397 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m18:35:57.195659 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:35:57.195831 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:35:57.197031 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:35:57.197916 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m18:35:57.198679 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m18:35:57.199040 [info ] [Thread-3 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m18:35:57.199388 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:35:57.200225 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.200417 [debug] [MainThread]: On master: BEGIN
[0m18:35:57.200601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:57.208035 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:35:57.208223 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.208356 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:57.208477 [debug] [MainThread]: On master: COMMIT
[0m18:35:57.208945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:35:57.209224 [debug] [MainThread]: On master: Close
[0m18:35:57.209447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:57.209677 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m18:35:57.209805 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m18:35:57.209921 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m18:35:57.210029 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m18:35:57.210186 [info ] [MainThread]: 
[0m18:35:57.210337 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:35:57.211118 [debug] [MainThread]: Command end result
[0m18:35:57.223163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:35:57.224101 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:35:57.228081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:35:57.228318 [info ] [MainThread]: 
[0m18:35:57.228515 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:35:57.228671 [info ] [MainThread]: 
[0m18:35:57.228910 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d250dac6f9fab21d2657206b3feba5a7.sql
[0m18:35:57.229083 [info ] [MainThread]: 
[0m18:35:57.229265 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_d8c23306b2a96f81bc1c9e50097dc836.sql
[0m18:35:57.229412 [info ] [MainThread]: 
[0m18:35:57.229578 [error] [MainThread]:   Database Error in test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ (models/marts/schema.yml)
  relation "public.fact_all_apartment" does not exist
  LINE 13:     from "airflow"."public"."fact_all_apartment"
                    ^
  compiled code at target/run/real_estate/models/marts/schema.yml/relationships_fact_all_apartme_0e118ed6dbb1d9482ef614a47b1d08e5.sql
[0m18:35:57.229722 [info ] [MainThread]: 
[0m18:35:57.229869 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 TOTAL=9
[0m18:35:57.231129 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.7328492, "process_in_blocks": "0", "process_kernel_time": 0.233109, "process_mem_max_rss": "131956736", "process_out_blocks": "0", "process_user_time": 1.074956}
[0m18:35:57.231329 [debug] [MainThread]: Command `dbt test` failed at 18:35:57.231288 after 0.73 seconds
[0m18:35:57.231536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029cff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d29510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdf690>]}
[0m18:35:57.231740 [debug] [MainThread]: Flushing usage events
[0m18:35:58.394143 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:05.399322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c70d0>]}


============================== 18:36:05.401395 | d1df4666-d9cb-45b1-bc8b-79849a57969e ==============================
[0m18:36:05.401395 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:36:05.401724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:36:05.487925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6b190>]}
[0m18:36:05.512061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672bed0>]}
[0m18:36:05.512557 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:36:05.558171 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:36:05.612110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:05.612355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:05.632824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ef710>]}
[0m18:36:05.669715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:36:05.672520 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:36:05.679110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947be90>]}
[0m18:36:05.679371 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:36:05.679544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce5550>]}
[0m18:36:05.680532 [info ] [MainThread]: 
[0m18:36:05.680745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:05.680879 [info ] [MainThread]: 
[0m18:36:05.681128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:05.683130 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m18:36:05.711140 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m18:36:05.711423 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m18:36:05.711582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:05.732258 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m18:36:05.733083 [debug] [ThreadPool]: On list_airflow: Close
[0m18:36:05.733939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m18:36:05.736955 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:36:05.737190 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m18:36:05.737369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:05.746076 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:36:05.746356 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:36:05.746515 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:36:05.748618 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.002 seconds
[0m18:36:05.749681 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m18:36:05.750350 [debug] [ThreadPool]: On list_airflow_public: Close
[0m18:36:05.755616 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:05.755874 [debug] [MainThread]: On master: BEGIN
[0m18:36:05.756013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:05.767278 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:36:05.767531 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:05.767745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:05.770198 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:36:05.770914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b69090>]}
[0m18:36:05.771174 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:05.771741 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:05.771875 [debug] [MainThread]: On master: BEGIN
[0m18:36:05.772737 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:36:05.772945 [debug] [MainThread]: On master: COMMIT
[0m18:36:05.773094 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:05.773224 [debug] [MainThread]: On master: COMMIT
[0m18:36:05.773728 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:05.773925 [debug] [MainThread]: On master: Close
[0m18:36:05.774752 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m18:36:05.774996 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m18:36:05.775218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.real_estate.staging_table)
[0m18:36:05.775438 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m18:36:05.779969 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m18:36:05.781557 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m18:36:05.800327 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m18:36:05.800917 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.801085 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m18:36:05.801239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:05.811091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:36:05.811327 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.811500 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "airflow"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "airflow"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m18:36:05.836802 [debug] [Thread-1 (]: SQL status: SELECT 17496 in 0.025 seconds
[0m18:36:05.840800 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.841014 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m18:36:05.841785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:05.843249 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.843440 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "airflow"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m18:36:05.844076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:36:05.853753 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m18:36:05.853967 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.854139 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m18:36:05.861964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m18:36:05.865510 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."staging_table__dbt_backup"
[0m18:36:05.867876 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:36:05.868072 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "airflow"."public"."staging_table__dbt_backup" cascade
[0m18:36:05.870785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:36:05.872208 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m18:36:05.873435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b0150>]}
[0m18:36:05.873843 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 17496[0m in 0.10s]
[0m18:36:05.874131 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m18:36:05.874672 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m18:36:05.874916 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m18:36:05.875111 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m18:36:05.875356 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m18:36:05.875584 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m18:36:05.875821 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m18:36:05.876206 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m18:36:05.876434 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m18:36:05.876642 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m18:36:05.876803 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m18:36:05.876955 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m18:36:05.877105 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m18:36:05.878684 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m18:36:05.880116 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m18:36:05.881683 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m18:36:05.882409 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m18:36:05.882622 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m18:36:05.882798 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m18:36:05.885984 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m18:36:05.917590 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m18:36:05.919682 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m18:36:05.920176 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.920348 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m18:36:05.920499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:36:05.920754 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.920928 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m18:36:05.921070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:36:05.921308 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.921458 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m18:36:05.921599 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:05.934446 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m18:36:05.934687 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:36:05.934935 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m18:36:05.935098 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.935256 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.935458 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.935656 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "airflow"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "airflow"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m18:36:05.935871 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "airflow"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "airflow"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m18:36:05.936086 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "airflow"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "airflow"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m18:36:05.946813 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.011 seconds
[0m18:36:05.948723 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.948921 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m18:36:05.949186 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.013 seconds
[0m18:36:05.950749 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.950933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:36:05.951087 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m18:36:05.952373 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.952587 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "airflow"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m18:36:05.953109 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:05.953282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:05.954587 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.955440 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m18:36:05.955617 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "airflow"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m18:36:05.955779 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.955952 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m18:36:05.956478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:05.957222 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m18:36:05.957387 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.957530 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m18:36:05.957689 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:36:05.958924 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."dim_broker__dbt_backup"
[0m18:36:05.959151 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:36:05.959557 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:36:05.960781 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."dim_project__dbt_backup"
[0m18:36:05.960965 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "airflow"."public"."dim_broker__dbt_backup" cascade
[0m18:36:05.961300 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:36:05.961561 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "airflow"."public"."dim_project__dbt_backup" cascade
[0m18:36:05.962658 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:36:05.962843 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:36:05.963451 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m18:36:05.964003 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m18:36:05.964296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948cc10>]}
[0m18:36:05.964657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f1510>]}
[0m18:36:05.964972 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.09s]
[0m18:36:05.965357 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.09s]
[0m18:36:05.965676 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m18:36:05.965951 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m18:36:05.978730 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.042 seconds
[0m18:36:05.980602 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.980814 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m18:36:05.981721 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:05.983381 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.983557 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "airflow"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m18:36:05.984181 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:36:05.985030 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m18:36:05.985201 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.985350 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m18:36:05.986623 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:36:05.987860 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."dim_post__dbt_backup"
[0m18:36:05.988208 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:36:05.988367 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "airflow"."public"."dim_post__dbt_backup" cascade
[0m18:36:05.990118 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:36:05.990860 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m18:36:05.991160 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044eca90>]}
[0m18:36:05.991474 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.11s]
[0m18:36:05.991734 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m18:36:05.992115 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m18:36:05.992383 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m18:36:05.992646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m18:36:05.992843 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m18:36:05.995912 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m18:36:05.996370 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m18:36:05.998361 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m18:36:05.998681 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:36:05.998833 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m18:36:05.998973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:06.006257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:36:06.006480 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:36:06.006672 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "airflow"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "airflow"."public"."staging_table" s   
                    LEFT JOIN "airflow"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "airflow"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "airflow"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m18:36:06.188003 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.181 seconds
[0m18:36:06.189673 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:36:06.189850 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "airflow"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m18:36:06.190625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:36:06.191283 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m18:36:06.191434 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:36:06.191575 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m18:36:06.192587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:36:06.193646 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."fact_all_apartment__dbt_backup"
[0m18:36:06.194011 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:36:06.194168 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "airflow"."public"."fact_all_apartment__dbt_backup" cascade
[0m18:36:06.194757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:36:06.195303 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m18:36:06.195586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1df4666-d9cb-45b1-bc8b-79849a57969e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947a090>]}
[0m18:36:06.195881 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.20s]
[0m18:36:06.196135 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m18:36:06.196776 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:06.196923 [debug] [MainThread]: On master: BEGIN
[0m18:36:06.197048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:06.204167 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:36:06.204403 [debug] [MainThread]: On master: COMMIT
[0m18:36:06.204552 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:06.204673 [debug] [MainThread]: On master: COMMIT
[0m18:36:06.205301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:06.205491 [debug] [MainThread]: On master: Close
[0m18:36:06.205725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:06.205862 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m18:36:06.205977 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m18:36:06.206089 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m18:36:06.206195 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m18:36:06.206375 [info ] [MainThread]: 
[0m18:36:06.206579 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m18:36:06.207145 [debug] [MainThread]: Command end result
[0m18:36:06.218753 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:36:06.219607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:36:06.222699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:36:06.222890 [info ] [MainThread]: 
[0m18:36:06.223089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:06.223239 [info ] [MainThread]: 
[0m18:36:06.223391 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:36:06.224632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85817045, "process_in_blocks": "0", "process_kernel_time": 0.188885, "process_mem_max_rss": "130007040", "process_out_blocks": "0", "process_user_time": 1.039275}
[0m18:36:06.224871 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:06.224827 after 0.86 seconds
[0m18:36:06.225066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104277f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104370e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435b6d0>]}
[0m18:36:06.225249 [debug] [MainThread]: Flushing usage events
[0m18:36:07.710924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:12.506745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f5f10>]}


============================== 18:36:12.508903 | baa1b332-fdf1-466a-a2ed-16898c98c927 ==============================
[0m18:36:12.508903 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:36:12.509226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:36:12.590881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110789150>]}
[0m18:36:12.614271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b2b50>]}
[0m18:36:12.614707 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:36:12.659467 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:36:12.712053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:12.712295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:12.732425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11106add0>]}
[0m18:36:12.772377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:36:12.775731 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:36:12.791083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bbcd0>]}
[0m18:36:12.791459 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:36:12.791652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f385d0>]}
[0m18:36:12.792837 [info ] [MainThread]: 
[0m18:36:12.793059 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:12.793195 [info ] [MainThread]: 
[0m18:36:12.793477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:12.795643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m18:36:12.819672 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:36:12.819922 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m18:36:12.820061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:12.837777 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m18:36:12.838085 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m18:36:12.838252 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:36:12.840756 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.002 seconds
[0m18:36:12.841977 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m18:36:12.842657 [debug] [ThreadPool]: On list_airflow_public: Close
[0m18:36:12.848030 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:12.848277 [debug] [MainThread]: On master: BEGIN
[0m18:36:12.848415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:12.856989 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:36:12.857256 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:12.857463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:12.859997 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:36:12.860829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baa1b332-fdf1-466a-a2ed-16898c98c927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f3f10>]}
[0m18:36:12.861131 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:12.861757 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:12.861908 [debug] [MainThread]: On master: BEGIN
[0m18:36:12.863043 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:36:12.863269 [debug] [MainThread]: On master: COMMIT
[0m18:36:12.863434 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:12.863567 [debug] [MainThread]: On master: COMMIT
[0m18:36:12.864091 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:12.864247 [debug] [MainThread]: On master: Close
[0m18:36:12.865387 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:36:12.865689 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:36:12.865946 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:36:12.866174 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:36:12.866383 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m18:36:12.866586 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m18:36:12.866763 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m18:36:12.866937 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m18:36:12.867167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m18:36:12.867383 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m18:36:12.867585 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m18:36:12.867777 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m18:36:12.867943 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:36:12.868134 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:36:12.868354 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:36:12.868549 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:36:12.876897 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:36:12.878921 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:36:12.880753 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:36:12.884350 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:36:12.885094 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:36:12.885350 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:36:12.885533 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:36:12.885688 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:36:12.892600 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:36:12.893860 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:36:12.895847 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:36:12.933546 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:36:12.934377 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:36:12.934596 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m18:36:12.934775 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:36:12.935025 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:36:12.935212 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:36:12.935549 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:36:12.935726 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m18:36:12.935889 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m18:36:12.936052 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m18:36:12.936252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:12.936431 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:12.936714 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:36:12.950067 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m18:36:12.950511 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m18:36:12.950801 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "airflow"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m18:36:12.951963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m18:36:12.952206 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m18:36:12.952419 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m18:36:12.952645 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:36:12.952834 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:36:12.953018 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:36:12.953176 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m18:36:12.955150 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m18:36:12.955344 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "airflow"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m18:36:12.955535 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "airflow"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:36:12.955711 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "airflow"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m18:36:12.956534 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m18:36:12.956963 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.09s]
[0m18:36:12.957235 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:36:12.957512 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:36:12.957725 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:36:12.957993 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m18:36:12.958743 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m18:36:12.959368 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m18:36:12.959922 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m18:36:12.960125 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:36:12.960473 [info ] [Thread-3 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m18:36:12.960733 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m18:36:12.960899 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m18:36:12.961045 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m18:36:12.961274 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m18:36:12.961562 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.09s]
[0m18:36:12.962370 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:36:12.961809 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.09s]
[0m18:36:12.962197 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.09s]
[0m18:36:12.962732 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m18:36:12.966080 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:36:12.966377 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:36:12.966722 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:36:12.966919 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:36:12.967230 [debug] [Thread-1 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:36:12.967469 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:36:12.967765 [info ] [Thread-2 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m18:36:12.968003 [info ] [Thread-1 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m18:36:12.968276 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:36:12.968688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m18:36:12.968445 [info ] [Thread-4 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m18:36:12.968955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m18:36:12.970300 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:36:12.970516 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:36:12.970731 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m18:36:12.970897 [debug] [Thread-1 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:36:12.973516 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:36:12.973726 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:36:12.976914 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:36:12.977190 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:36:12.979380 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:36:12.979740 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:36:12.979974 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m18:36:12.980235 [debug] [Thread-1 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:36:12.981637 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:36:12.981888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:36:12.982058 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:36:12.983086 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:36:12.984371 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:36:12.984610 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:36:12.985088 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m18:36:12.985307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:36:12.985633 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:36:12.985950 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:36:12.986114 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m18:36:12.986337 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m18:36:12.986564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:12.986818 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:36:12.995897 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m18:36:12.996201 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:36:12.996395 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "airflow"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:36:12.998220 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:36:12.999281 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m18:36:12.999521 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m18:36:12.999726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m18:36:12.999908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:36:13.000139 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m18:36:13.000316 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:36:13.000489 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:36:13.000672 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:13.000898 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "airflow"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "airflow"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:36:13.001085 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m18:36:13.001268 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:13.001716 [info ] [Thread-3 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.04s]
[0m18:36:13.002137 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:36:13.002359 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:36:13.002599 [info ] [Thread-3 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m18:36:13.002866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m18:36:13.003096 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:36:13.005138 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:36:13.005431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:36:13.005711 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:36:13.005895 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:36:13.006578 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m18:36:13.007381 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m18:36:13.008137 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m18:36:13.008369 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:36:13.009899 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:36:13.010105 [debug] [Thread-4 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m18:36:13.010293 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m18:36:13.010483 [debug] [Thread-1 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m18:36:13.010994 [info ] [Thread-4 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.04s]
[0m18:36:13.011294 [info ] [Thread-2 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.04s]
[0m18:36:13.011944 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:36:13.011740 [info ] [Thread-1 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m18:36:13.012263 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m18:36:13.012544 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:36:13.012733 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m18:36:13.012957 [debug] [Thread-1 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:36:13.013236 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:36:13.021190 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m18:36:13.021470 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m18:36:13.021655 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "airflow"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:13.022710 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:36:13.023502 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m18:36:13.024002 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m18:36:13.024330 [info ] [Thread-3 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m18:36:13.024598 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m18:36:13.025357 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:13.025521 [debug] [MainThread]: On master: BEGIN
[0m18:36:13.025693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:13.033412 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:36:13.033630 [debug] [MainThread]: On master: COMMIT
[0m18:36:13.033770 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:13.033892 [debug] [MainThread]: On master: COMMIT
[0m18:36:13.034408 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:36:13.034644 [debug] [MainThread]: On master: Close
[0m18:36:13.034880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:13.035020 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m18:36:13.035142 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m18:36:13.035266 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m18:36:13.035383 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m18:36:13.035558 [info ] [MainThread]: 
[0m18:36:13.035715 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:36:13.036520 [debug] [MainThread]: Command end result
[0m18:36:13.048692 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:36:13.049839 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:36:13.053701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:36:13.053923 [info ] [MainThread]: 
[0m18:36:13.054112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:13.054262 [info ] [MainThread]: 
[0m18:36:13.054409 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:36:13.055339 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5821341, "process_in_blocks": "0", "process_kernel_time": 0.176597, "process_mem_max_rss": "131334144", "process_out_blocks": "0", "process_user_time": 1.05724}
[0m18:36:13.055527 [debug] [MainThread]: Command `dbt test` succeeded at 18:36:13.055490 after 0.58 seconds
[0m18:36:13.055711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e13f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f0ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ef76d0>]}
[0m18:36:13.055907 [debug] [MainThread]: Flushing usage events
[0m18:36:14.221211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:11.579824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118295990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182f5410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182970d0>]}


============================== 18:44:11.583013 | f355816d-5ff9-475c-8481-0b8495f252c7 ==============================
[0m18:44:11.583013 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:44:11.583363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:44:11.733416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183b5f50>]}
[0m18:44:11.759200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b4150>]}
[0m18:44:11.760042 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:11.809379 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:44:11.853711 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:44:11.854064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bafa50>]}
[0m18:44:12.403420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d66f50>]}
[0m18:44:12.440426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:44:12.443315 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:44:12.456137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a898450>]}
[0m18:44:12.456413 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:44:12.456582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d88350>]}
[0m18:44:12.457481 [info ] [MainThread]: 
[0m18:44:12.457650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:12.457780 [info ] [MainThread]: 
[0m18:44:12.457998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:12.459795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m18:44:12.489038 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m18:44:12.489278 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m18:44:12.489412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:12.520481 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m18:44:12.521252 [debug] [ThreadPool]: On list_re: Close
[0m18:44:12.522053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m18:44:12.525197 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:44:12.525453 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m18:44:12.525582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:12.533252 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:44:12.533445 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:44:12.533600 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:44:12.535595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m18:44:12.536393 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m18:44:12.536953 [debug] [ThreadPool]: On list_re_public: Close
[0m18:44:12.540122 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.540372 [debug] [MainThread]: On master: BEGIN
[0m18:44:12.540515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:12.549623 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:44:12.549851 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.550059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:12.552249 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:44:12.552884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c7c10>]}
[0m18:44:12.553152 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:12.553766 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.553928 [debug] [MainThread]: On master: BEGIN
[0m18:44:12.554771 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:44:12.554959 [debug] [MainThread]: On master: COMMIT
[0m18:44:12.555138 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.555331 [debug] [MainThread]: On master: COMMIT
[0m18:44:12.555837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:12.556037 [debug] [MainThread]: On master: Close
[0m18:44:12.556927 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m18:44:12.557217 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m18:44:12.557471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m18:44:12.557642 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m18:44:12.561565 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m18:44:12.562222 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m18:44:12.580022 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m18:44:12.580611 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.580778 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m18:44:12.580927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:12.590820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:44:12.591135 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.591326 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m18:44:12.597928 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.006 seconds
[0m18:44:12.601386 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.601602 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m18:44:12.602766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.604284 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.604460 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m18:44:12.605187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.614056 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m18:44:12.614252 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.614401 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m18:44:12.620705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:44:12.623590 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."staging_table__dbt_backup"
[0m18:44:12.625744 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m18:44:12.625926 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "re"."public"."staging_table__dbt_backup" cascade
[0m18:44:12.629604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:44:12.630780 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m18:44:12.631888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac0add0>]}
[0m18:44:12.632191 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 4374[0m in 0.07s]
[0m18:44:12.632449 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m18:44:12.632808 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m18:44:12.632994 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m18:44:12.633143 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m18:44:12.633376 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m18:44:12.633605 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m18:44:12.633846 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m18:44:12.634220 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m18:44:12.634443 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m18:44:12.634663 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m18:44:12.634824 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m18:44:12.634978 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m18:44:12.635122 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m18:44:12.636488 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m18:44:12.637800 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m18:44:12.639503 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m18:44:12.640014 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m18:44:12.642686 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m18:44:12.642915 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m18:44:12.644513 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m18:44:12.644744 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m18:44:12.644934 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.646496 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m18:44:12.646674 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m18:44:12.646893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:44:12.647149 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.647317 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m18:44:12.647471 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.647614 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:44:12.647765 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m18:44:12.648018 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:44:12.657407 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m18:44:12.657652 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m18:44:12.657886 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.658080 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.658295 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "re"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "re"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m18:44:12.658518 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:44:12.658725 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "re"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "re"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m18:44:12.658952 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.659240 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "re"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "re"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m18:44:12.663419 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.004 seconds
[0m18:44:12.665170 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.665372 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m18:44:12.666221 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.667875 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.668105 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.009 seconds
[0m18:44:12.668322 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m18:44:12.670178 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.670465 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m18:44:12.671118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:12.671292 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.672820 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.673669 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m18:44:12.673884 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m18:44:12.674075 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.674359 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m18:44:12.674723 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:44:12.675667 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m18:44:12.675842 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.676000 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:44:12.676147 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m18:44:12.677245 [debug] [Thread-3 (]: Applying DROP to: "re"."public"."dim_broker__dbt_backup"
[0m18:44:12.677603 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m18:44:12.677762 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "re"."public"."dim_broker__dbt_backup" cascade
[0m18:44:12.677911 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m18:44:12.679034 [debug] [Thread-2 (]: Applying DROP to: "re"."public"."dim_project__dbt_backup"
[0m18:44:12.679202 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:44:12.679543 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m18:44:12.680140 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m18:44:12.680302 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "re"."public"."dim_project__dbt_backup" cascade
[0m18:44:12.680613 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab73e50>]}
[0m18:44:12.680914 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.05s]
[0m18:44:12.681186 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m18:44:12.681903 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:44:12.682517 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m18:44:12.682766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f6ab10>]}
[0m18:44:12.683039 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.05s]
[0m18:44:12.683279 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m18:44:12.698443 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.039 seconds
[0m18:44:12.700114 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.700291 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m18:44:12.701139 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.702831 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.703075 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m18:44:12.703839 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.705882 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m18:44:12.706064 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.706220 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m18:44:12.707582 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:44:12.708763 [debug] [Thread-4 (]: Applying DROP to: "re"."public"."dim_post__dbt_backup"
[0m18:44:12.709091 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m18:44:12.709241 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "re"."public"."dim_post__dbt_backup" cascade
[0m18:44:12.710643 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:44:12.711266 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m18:44:12.711564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad4fe50>]}
[0m18:44:12.711918 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.08s]
[0m18:44:12.712192 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m18:44:12.712582 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m18:44:12.712835 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m18:44:12.713056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m18:44:12.713232 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m18:44:12.715069 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m18:44:12.715479 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m18:44:12.717186 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m18:44:12.717557 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:44:12.717725 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m18:44:12.717874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:12.726116 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:44:12.726450 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:44:12.726700 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m18:44:12.823374 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.096 seconds
[0m18:44:12.825013 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:44:12.825176 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m18:44:12.826008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:44:12.826656 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m18:44:12.826809 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:44:12.826943 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m18:44:12.828343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:44:12.829418 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."fact_all_apartment__dbt_backup"
[0m18:44:12.829723 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m18:44:12.829867 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m18:44:12.830457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:44:12.831083 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m18:44:12.831379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f355816d-5ff9-475c-8481-0b8495f252c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abe3510>]}
[0m18:44:12.831692 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.12s]
[0m18:44:12.831950 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m18:44:12.832713 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.832874 [debug] [MainThread]: On master: BEGIN
[0m18:44:12.833003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:12.840396 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:44:12.840613 [debug] [MainThread]: On master: COMMIT
[0m18:44:12.840747 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:12.840867 [debug] [MainThread]: On master: COMMIT
[0m18:44:12.841472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:12.841706 [debug] [MainThread]: On master: Close
[0m18:44:12.841929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:12.842058 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m18:44:12.842174 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m18:44:12.842284 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m18:44:12.842393 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m18:44:12.842577 [info ] [MainThread]: 
[0m18:44:12.842728 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m18:44:12.843242 [debug] [MainThread]: Command end result
[0m18:44:12.855739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:44:12.856757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:44:12.860535 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:44:12.860769 [info ] [MainThread]: 
[0m18:44:12.860977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:12.861125 [info ] [MainThread]: 
[0m18:44:12.861284 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:44:12.862513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3228117, "process_in_blocks": "0", "process_kernel_time": 0.234482, "process_mem_max_rss": "138477568", "process_out_blocks": "0", "process_user_time": 1.509839}
[0m18:44:12.862726 [debug] [MainThread]: Command `dbt run` succeeded at 18:44:12.862686 after 1.32 seconds
[0m18:44:12.862952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182e7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021bff10>]}
[0m18:44:12.863145 [debug] [MainThread]: Flushing usage events
[0m18:44:14.426664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:45.174246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744df10>]}


============================== 18:44:45.177428 | 73054bfe-7055-4867-b6f0-3c99b4430b0e ==============================
[0m18:44:45.177428 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:44:45.177765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --models fact_all_apartment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:44:45.289700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079803d0>]}
[0m18:44:45.313178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105564850>]}
[0m18:44:45.313819 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:44:45.367647 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:44:45.444152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:45.444413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:45.465453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108104990>]}
[0m18:44:45.504138 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:44:45.507402 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:44:45.526488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108463c90>]}
[0m18:44:45.526804 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:44:45.526977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934f10>]}
[0m18:44:45.527772 [info ] [MainThread]: 
[0m18:44:45.527946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:44:45.528077 [info ] [MainThread]: 
[0m18:44:45.528323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:44:45.530206 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m18:44:45.562678 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:44:45.562947 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m18:44:45.563090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:45.598523 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m18:44:45.598880 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:44:45.599076 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:44:45.601212 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m18:44:45.602064 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m18:44:45.602793 [debug] [ThreadPool]: On list_re_public: Close
[0m18:44:45.606129 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.606376 [debug] [MainThread]: On master: BEGIN
[0m18:44:45.606523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:44:45.615896 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:44:45.616163 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.616387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:44:45.620901 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:44:45.621588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73054bfe-7055-4867-b6f0-3c99b4430b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffdcd0>]}
[0m18:44:45.621859 [debug] [MainThread]: On master: ROLLBACK
[0m18:44:45.622446 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.622597 [debug] [MainThread]: On master: BEGIN
[0m18:44:45.623400 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:44:45.623561 [debug] [MainThread]: On master: COMMIT
[0m18:44:45.623725 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.623867 [debug] [MainThread]: On master: COMMIT
[0m18:44:45.624352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:45.624498 [debug] [MainThread]: On master: Close
[0m18:44:45.625414 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:44:45.625619 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:44:45.625801 [info ] [Thread-1 (]: 1 of 3 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m18:44:45.626128 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:44:45.626366 [info ] [Thread-2 (]: 2 of 3 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m18:44:45.626630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da)
[0m18:44:45.626834 [info ] [Thread-3 (]: 3 of 3 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m18:44:45.627090 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1'
[0m18:44:45.627288 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:44:45.627505 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1'
[0m18:44:45.627664 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:44:45.636029 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:44:45.636329 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:44:45.639359 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:44:45.642466 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:44:45.642840 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:44:45.649340 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:44:45.650432 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:44:45.650630 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:44:45.651684 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:44:45.652902 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:44:45.653272 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:44:45.653630 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m18:44:45.653831 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:44:45.654051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:45.654235 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:44:45.654419 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m18:44:45.654681 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m18:44:45.654844 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:44:45.655010 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:44:45.666387 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m18:44:45.666728 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m18:44:45.666922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:44:45.667166 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m18:44:45.667373 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m18:44:45.667550 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:44:45.667742 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "re"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "re"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:44:45.667971 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "re"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "re"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:44:45.668189 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:44:45.669973 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:44:45.670161 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:44:45.670342 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:44:45.672750 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m18:44:45.673539 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m18:44:45.674182 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m18:44:45.675083 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m18:44:45.675275 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m18:44:45.675488 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m18:44:45.675811 [info ] [Thread-3 (]: 3 of 3 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.05s]
[0m18:44:45.676082 [info ] [Thread-2 (]: 2 of 3 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.05s]
[0m18:44:45.676391 [info ] [Thread-1 (]: 1 of 3 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.05s]
[0m18:44:45.676788 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m18:44:45.677200 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m18:44:45.677458 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:44:45.678399 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.678630 [debug] [MainThread]: On master: BEGIN
[0m18:44:45.678772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:44:45.686594 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:44:45.686964 [debug] [MainThread]: On master: COMMIT
[0m18:44:45.687132 [debug] [MainThread]: Using postgres connection "master"
[0m18:44:45.687261 [debug] [MainThread]: On master: COMMIT
[0m18:44:45.687906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:44:45.688137 [debug] [MainThread]: On master: Close
[0m18:44:45.688402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:45.688574 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da' was properly closed.
[0m18:44:45.688782 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m18:44:45.688937 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m18:44:45.689117 [info ] [MainThread]: 
[0m18:44:45.689278 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m18:44:45.689696 [debug] [MainThread]: Command end result
[0m18:44:45.765604 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:44:45.766682 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:44:45.770665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:44:45.770889 [info ] [MainThread]: 
[0m18:44:45.771097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:45.771241 [info ] [MainThread]: 
[0m18:44:45.771386 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:44:45.772549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63465565, "process_in_blocks": "0", "process_kernel_time": 0.225332, "process_mem_max_rss": "131350528", "process_out_blocks": "0", "process_user_time": 1.000524}
[0m18:44:45.772736 [debug] [MainThread]: Command `dbt test` succeeded at 18:44:45.772699 after 0.63 seconds
[0m18:44:45.772922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030a4090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10312a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103191010>]}
[0m18:44:45.773118 [debug] [MainThread]: Flushing usage events
[0m18:44:46.989317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:41.338078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103f5fd0>]}


============================== 18:45:41.340296 | 2886b2dc-c2b8-4cef-a546-d3fc952f9375 ==============================
[0m18:45:41.340296 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:45:41.340611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --models dim_broker', 'send_anonymous_usage_stats': 'True'}
[0m18:45:41.445592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101a8f10>]}
[0m18:45:41.469809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529b6d0>]}
[0m18:45:41.470265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:45:41.514993 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:45:41.568879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:41.569119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:41.589452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111228fd0>]}
[0m18:45:41.626289 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:45:41.629184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:45:41.641576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b3e50>]}
[0m18:45:41.641896 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m18:45:41.642073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c3bd0>]}
[0m18:45:41.642897 [info ] [MainThread]: 
[0m18:45:41.643077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:45:41.643208 [info ] [MainThread]: 
[0m18:45:41.643468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:41.645413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m18:45:41.673183 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:45:41.673452 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m18:45:41.673592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:41.696420 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m18:45:41.696741 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m18:45:41.696921 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:45:41.699070 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m18:45:41.699930 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m18:45:41.700501 [debug] [ThreadPool]: On list_re_public: Close
[0m18:45:41.703470 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.703657 [debug] [MainThread]: On master: BEGIN
[0m18:45:41.703795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:41.711262 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:45:41.711399 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.711589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:41.713592 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m18:45:41.714368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2886b2dc-c2b8-4cef-a546-d3fc952f9375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b3c10>]}
[0m18:45:41.714652 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:41.715175 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.715333 [debug] [MainThread]: On master: BEGIN
[0m18:45:41.716949 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:45:41.717151 [debug] [MainThread]: On master: COMMIT
[0m18:45:41.717306 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.717442 [debug] [MainThread]: On master: COMMIT
[0m18:45:41.717989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:45:41.718189 [debug] [MainThread]: On master: Close
[0m18:45:41.719057 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:45:41.719280 [debug] [Thread-2 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:45:41.719638 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:45:41.719491 [info ] [Thread-1 (]: 1 of 3 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m18:45:41.719915 [info ] [Thread-2 (]: 2 of 3 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m18:45:41.720146 [info ] [Thread-3 (]: 3 of 3 START test unique_dim_broker_broker_id .................................. [RUN]
[0m18:45:41.720396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m18:45:41.720630 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m18:45:41.720841 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af'
[0m18:45:41.721010 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:45:41.721169 [debug] [Thread-2 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:45:41.721317 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:45:41.731308 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:45:41.732940 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:45:41.735565 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:45:41.736057 [debug] [Thread-2 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:45:41.742575 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:45:41.742820 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:45:41.743608 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:45:41.744873 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:45:41.745855 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:45:41.746311 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:45:41.746564 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m18:45:41.746716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:45:41.746974 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:45:41.747159 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m18:45:41.747313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:41.747571 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:45:41.747713 [debug] [Thread-3 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m18:45:41.747847 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:45:41.762293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m18:45:41.762718 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m18:45:41.762934 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m18:45:41.763102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m18:45:41.763298 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m18:45:41.763472 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "re"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m18:45:41.763685 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m18:45:41.763884 [debug] [Thread-3 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:45:41.764148 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:45:41.765069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:45:41.767385 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m18:45:41.767639 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:45:41.767846 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:45:41.768668 [debug] [Thread-3 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m18:45:41.768865 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m18:45:41.769551 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m18:45:41.769972 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.05s]
[0m18:45:41.770321 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m18:45:41.770820 [debug] [Thread-3 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m18:45:41.771019 [debug] [Thread-2 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m18:45:41.771289 [info ] [Thread-3 (]: 3 of 3 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.05s]
[0m18:45:41.771685 [info ] [Thread-2 (]: 2 of 3 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.05s]
[0m18:45:41.772029 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m18:45:41.772257 [debug] [Thread-2 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m18:45:41.773122 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.773292 [debug] [MainThread]: On master: BEGIN
[0m18:45:41.773411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:41.780529 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:45:41.780788 [debug] [MainThread]: On master: COMMIT
[0m18:45:41.780938 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:41.781064 [debug] [MainThread]: On master: COMMIT
[0m18:45:41.781635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:45:41.781777 [debug] [MainThread]: On master: Close
[0m18:45:41.781976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:41.782132 [debug] [MainThread]: Connection 'test.real_estate.not_null_dim_broker_broker_id.b2317a90a1' was properly closed.
[0m18:45:41.782269 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da' was properly closed.
[0m18:45:41.782391 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m18:45:41.782552 [info ] [MainThread]: 
[0m18:45:41.782713 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:45:41.783129 [debug] [MainThread]: Command end result
[0m18:45:41.825545 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m18:45:41.826529 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m18:45:41.829958 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m18:45:41.830138 [info ] [MainThread]: 
[0m18:45:41.830326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:41.830461 [info ] [MainThread]: 
[0m18:45:41.830614 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:45:41.831605 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.52752465, "process_in_blocks": "0", "process_kernel_time": 0.185744, "process_mem_max_rss": "132431872", "process_out_blocks": "0", "process_user_time": 0.948564}
[0m18:45:41.831818 [debug] [MainThread]: Command `dbt test` succeeded at 18:45:41.831777 after 0.53 seconds
[0m18:45:41.832003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102193fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022265d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102277710>]}
[0m18:45:41.832192 [debug] [MainThread]: Flushing usage events
[0m18:45:43.008276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:06.401099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb063f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb193ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9d9730>]}


============================== 16:00:06.405873 | 3b8f8e60-c3df-449c-97eb-acca20730393 ==============================
[0m16:00:06.405873 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:00:06.406211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:00:06.438170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc3f7a0>]}
[0m16:00:06.445822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf90ca10>]}
[0m16:00:06.450990 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:00:06.459296 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:00:06.459634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf913da0>]}
[0m16:00:06.716895 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m16:00:06.723761 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m16:00:06.725599 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m16:00:06.727259 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m16:00:06.729047 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m16:00:06.786404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf91b560>]}
[0m16:00:06.790585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebac7a0>]}
[0m16:00:06.790838 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:00:06.791055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8f8e60-c3df-449c-97eb-acca20730393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebe6f00>]}
[0m16:00:06.791801 [info ] [MainThread]: 
[0m16:00:06.792299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:00:06.792925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m16:00:06.798626 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m16:00:06.798848 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:00:06.798999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:06.799607 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:00:06.800672 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:00:06.800832 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:00:06.800996 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:00:06.801131 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:00:06.801269 [debug] [ThreadPool]: On list_re: No close available on handle
[0m16:00:06.801862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:06.802050 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m16:00:06.802218 [info ] [MainThread]: 
[0m16:00:06.802443 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m16:00:06.802829 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m16:00:06.803184 [debug] [MainThread]: Command `dbt run` failed at 16:00:06.803117 after 0.41 seconds
[0m16:00:06.803406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9db3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ec7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafaa1730>]}
[0m16:00:06.803599 [debug] [MainThread]: Flushing usage events
[0m23:01:24.249922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123495190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234fd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234970d0>]}


============================== 23:01:24.252701 | 2eab6db8-1b8c-41e0-a404-0956c377b5bd ==============================
[0m23:01:24.252701 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:01:24.253027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:01:24.382105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125110c10>]}
[0m23:01:24.407339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b4690>]}
[0m23:01:24.408053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:01:24.459063 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:01:24.503865 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:01:24.504218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125846450>]}
[0m23:01:25.081552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125147790>]}
[0m23:01:25.119114 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:25.122119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:25.135475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c10710>]}
[0m23:01:25.135791 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:01:25.135974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125aa5bd0>]}
[0m23:01:25.136935 [info ] [MainThread]: 
[0m23:01:25.137119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:25.137253 [info ] [MainThread]: 
[0m23:01:25.137477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:25.139425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m23:01:25.170793 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m23:01:25.171065 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m23:01:25.171207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:25.210361 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m23:01:25.211207 [debug] [ThreadPool]: On list_re: Close
[0m23:01:25.212090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m23:01:25.215197 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:25.215418 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m23:01:25.215553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:25.224117 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:01:25.224417 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:25.224591 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:25.226735 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:01:25.227415 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m23:01:25.228112 [debug] [ThreadPool]: On list_re_public: Close
[0m23:01:25.230826 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.231062 [debug] [MainThread]: On master: BEGIN
[0m23:01:25.231189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:25.240391 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:01:25.240691 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.240905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:25.243350 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:01:25.243976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125ecc2d0>]}
[0m23:01:25.244247 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:25.244911 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.245145 [debug] [MainThread]: On master: BEGIN
[0m23:01:25.246315 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:01:25.246515 [debug] [MainThread]: On master: COMMIT
[0m23:01:25.246663 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.246789 [debug] [MainThread]: On master: COMMIT
[0m23:01:25.247324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:25.247534 [debug] [MainThread]: On master: Close
[0m23:01:25.248452 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m23:01:25.248773 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m23:01:25.249070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m23:01:25.249249 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m23:01:25.253227 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m23:01:25.253984 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m23:01:25.272681 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m23:01:25.273280 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.273454 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m23:01:25.273610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:25.281711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:01:25.282011 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.282183 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m23:01:25.296096 [debug] [Thread-1 (]: SQL status: SELECT 6561 in 0.014 seconds
[0m23:01:25.299377 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.299584 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m23:01:25.300468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.301882 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.302059 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m23:01:25.302870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.311909 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m23:01:25.312170 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.312333 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m23:01:25.320285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m23:01:25.323595 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."staging_table__dbt_backup"
[0m23:01:25.325832 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:01:25.326030 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "re"."public"."staging_table__dbt_backup" cascade
[0m23:01:25.329003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:01:25.330276 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m23:01:25.331418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125123910>]}
[0m23:01:25.331763 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 6561[0m in 0.08s]
[0m23:01:25.332035 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m23:01:25.332505 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m23:01:25.332678 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m23:01:25.332847 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m23:01:25.333066 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m23:01:25.333292 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m23:01:25.333501 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m23:01:25.333893 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m23:01:25.334130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m23:01:25.334345 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m23:01:25.334512 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m23:01:25.334663 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m23:01:25.334808 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m23:01:25.336218 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m23:01:25.337534 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m23:01:25.338923 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m23:01:25.339538 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m23:01:25.339758 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m23:01:25.341488 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m23:01:25.341667 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m23:01:25.343136 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m23:01:25.345478 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m23:01:25.345899 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:01:25.346147 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:01:25.346360 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m23:01:25.346596 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:01:25.346750 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m23:01:25.346941 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:01:25.347144 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m23:01:25.347313 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:01:25.347569 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:01:25.357436 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:01:25.357726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:01:25.358041 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:01:25.358259 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:01:25.358495 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "re"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "re"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m23:01:25.358735 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "re"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "re"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m23:01:25.359184 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m23:01:25.359360 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:01:25.359531 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "re"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "re"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m23:01:25.365364 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.006 seconds
[0m23:01:25.367078 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:01:25.367248 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.008 seconds
[0m23:01:25.367444 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m23:01:25.368818 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:01:25.369021 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m23:01:25.369566 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.369795 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.370626 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m23:01:25.371402 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m23:01:25.371580 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:01:25.371794 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:01:25.372010 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m23:01:25.372183 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m23:01:25.373383 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:01:25.374582 [debug] [Thread-2 (]: Applying DROP to: "re"."public"."dim_project__dbt_backup"
[0m23:01:25.374923 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:01:25.375075 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m23:01:25.375243 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "re"."public"."dim_project__dbt_backup" cascade
[0m23:01:25.376336 [debug] [Thread-3 (]: Applying DROP to: "re"."public"."dim_broker__dbt_backup"
[0m23:01:25.376700 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:01:25.376866 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "re"."public"."dim_broker__dbt_backup" cascade
[0m23:01:25.377018 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:01:25.377679 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m23:01:25.377836 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:01:25.378418 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m23:01:25.378765 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12688e2d0>]}
[0m23:01:25.379573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269c41d0>]}
[0m23:01:25.379291 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.04s]
[0m23:01:25.380005 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.05s]
[0m23:01:25.380292 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m23:01:25.380556 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m23:01:25.395598 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.037 seconds
[0m23:01:25.397247 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:01:25.397448 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m23:01:25.398512 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.399516 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m23:01:25.399695 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:01:25.399838 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m23:01:25.402228 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:01:25.403457 [debug] [Thread-4 (]: Applying DROP to: "re"."public"."dim_post__dbt_backup"
[0m23:01:25.403791 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:01:25.403944 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "re"."public"."dim_post__dbt_backup" cascade
[0m23:01:25.404667 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:01:25.405269 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m23:01:25.405550 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126815390>]}
[0m23:01:25.405850 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.07s]
[0m23:01:25.406100 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m23:01:25.406460 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m23:01:25.406689 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m23:01:25.407045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m23:01:25.407291 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m23:01:25.409238 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m23:01:25.409720 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m23:01:25.411534 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m23:01:25.412119 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:25.412360 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m23:01:25.412518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:25.419763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m23:01:25.420034 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:25.420241 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m23:01:25.633844 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.213 seconds
[0m23:01:25.638811 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:25.639096 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m23:01:25.640403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:25.641236 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:01:25.641421 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:25.641569 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:01:25.645514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:01:25.647406 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."fact_all_apartment__dbt_backup"
[0m23:01:25.647797 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:25.647966 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m23:01:25.648662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:01:25.649308 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m23:01:25.649604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab6db8-1b8c-41e0-a404-0956c377b5bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126893590>]}
[0m23:01:25.649933 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.24s]
[0m23:01:25.650197 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m23:01:25.651018 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.651293 [debug] [MainThread]: On master: BEGIN
[0m23:01:25.651440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:25.658888 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:01:25.659143 [debug] [MainThread]: On master: COMMIT
[0m23:01:25.659282 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:25.659402 [debug] [MainThread]: On master: COMMIT
[0m23:01:25.659889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:25.660066 [debug] [MainThread]: On master: Close
[0m23:01:25.660278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:25.660413 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m23:01:25.660529 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m23:01:25.660640 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m23:01:25.660750 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m23:01:25.661011 [info ] [MainThread]: 
[0m23:01:25.661265 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m23:01:25.661912 [debug] [MainThread]: Command end result
[0m23:01:25.673539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:25.674451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:25.677326 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m23:01:25.677502 [info ] [MainThread]: 
[0m23:01:25.677694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:25.677845 [info ] [MainThread]: 
[0m23:01:25.678005 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:01:25.679397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4685526, "process_in_blocks": "0", "process_kernel_time": 0.249159, "process_mem_max_rss": "137691136", "process_out_blocks": "0", "process_user_time": 1.549079}
[0m23:01:25.679661 [debug] [MainThread]: Command `dbt run` succeeded at 23:01:25.679617 after 1.47 seconds
[0m23:01:25.679921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234ed590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021efa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234e7890>]}
[0m23:01:25.680147 [debug] [MainThread]: Flushing usage events
[0m23:01:27.030168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:29.620133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120595950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205e9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205fdc10>]}


============================== 23:01:29.622617 | f3486ead-fc8c-4591-a3bb-48a3dae90260 ==============================
[0m23:01:29.622617 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:01:29.622950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:01:29.710975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205fc950>]}
[0m23:01:29.736257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9bdd0>]}
[0m23:01:29.737056 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:01:29.786199 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:01:29.878832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:29.879118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:29.904877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205e7310>]}
[0m23:01:29.944924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:29.948151 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:29.961666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234bbb50>]}
[0m23:01:29.962036 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:01:29.962215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122475110>]}
[0m23:01:29.963310 [info ] [MainThread]: 
[0m23:01:29.963479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:29.963602 [info ] [MainThread]: 
[0m23:01:29.963835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:29.965743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m23:01:29.988430 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:29.988698 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m23:01:29.988843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:30.009564 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:01:30.009853 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:30.010018 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:30.012233 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m23:01:30.012974 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m23:01:30.013662 [debug] [ThreadPool]: On list_re_public: Close
[0m23:01:30.016625 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.016801 [debug] [MainThread]: On master: BEGIN
[0m23:01:30.016925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:30.024273 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:01:30.024525 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.024743 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:30.027087 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:01:30.027798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3486ead-fc8c-4591-a3bb-48a3dae90260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bf3e10>]}
[0m23:01:30.028079 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:30.028683 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.028877 [debug] [MainThread]: On master: BEGIN
[0m23:01:30.029733 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:01:30.029906 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.030027 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.030141 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.030645 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:30.030876 [debug] [MainThread]: On master: Close
[0m23:01:30.031811 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:01:30.032003 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:01:30.032216 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:01:30.032590 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:01:30.032382 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m23:01:30.032884 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m23:01:30.033073 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m23:01:30.033298 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m23:01:30.033547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m23:01:30.033776 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m23:01:30.033981 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m23:01:30.034185 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m23:01:30.034342 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:01:30.034495 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:01:30.034637 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:01:30.034782 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:01:30.042972 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:01:30.044908 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:01:30.046986 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:01:30.051086 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:01:30.052579 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:01:30.052770 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:01:30.058729 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:01:30.059283 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:01:30.060288 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:01:30.060439 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:01:30.061396 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:01:30.063531 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:01:30.063999 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:01:30.064201 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:01:30.064554 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m23:01:30.064800 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:01:30.065012 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:01:30.065180 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m23:01:30.065351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:01:30.065509 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m23:01:30.065677 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m23:01:30.065824 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:01:30.066040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:30.066194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:01:30.078245 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:01:30.078561 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m23:01:30.078894 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:01:30.079223 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:01:30.079425 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "re"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m23:01:30.079695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:01:30.079906 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:01:30.080203 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:01:30.080536 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "re"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m23:01:30.081053 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:30.083331 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m23:01:30.083562 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:01:30.083726 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m23:01:30.083863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m23:01:30.084726 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m23:01:30.084932 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m23:01:30.085694 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m23:01:30.085883 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:01:30.086281 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.05s]
[0m23:01:30.086574 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m23:01:30.086800 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "re"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m23:01:30.087014 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m23:01:30.087280 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:01:30.087575 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.05s]
[0m23:01:30.087968 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.05s]
[0m23:01:30.088243 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:01:30.088583 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:01:30.088895 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:01:30.089208 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:30.089410 [info ] [Thread-3 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m23:01:30.089635 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:01:30.089809 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:01:30.090496 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m23:01:30.090696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m23:01:30.090868 [info ] [Thread-1 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m23:01:30.091040 [info ] [Thread-4 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m23:01:30.091298 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:01:30.091573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m23:01:30.091795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m23:01:30.091937 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m23:01:30.127304 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:01:30.127566 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:01:30.127724 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:01:30.128073 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.09s]
[0m23:01:30.131017 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:01:30.131260 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:01:30.133965 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:01:30.134226 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:01:30.135392 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:01:30.135682 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:01:30.135866 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:01:30.136149 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:01:30.137164 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:01:30.137555 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:01:30.137377 [info ] [Thread-2 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m23:01:30.138597 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:01:30.138816 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m23:01:30.139031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m23:01:30.139212 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:01:30.139415 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:01:30.139581 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:01:30.139767 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m23:01:30.139937 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:01:30.141922 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:01:30.142127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:30.142293 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m23:01:30.142571 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:01:30.142789 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:01:30.143980 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:01:30.144536 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:01:30.144800 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m23:01:30.144970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:01:30.152295 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:01:30.152538 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:01:30.152721 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "re"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "re"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:01:30.154028 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m23:01:30.154301 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:01:30.154496 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:01:30.154763 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:01:30.154946 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:01:30.155831 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m23:01:30.156035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m23:01:30.156186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:30.156360 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:01:30.156575 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:01:30.157276 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m23:01:30.157446 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m23:01:30.157632 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:01:30.157853 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "re"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "re"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:01:30.158235 [info ] [Thread-3 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.07s]
[0m23:01:30.158480 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m23:01:30.158778 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:01:30.159079 [info ] [Thread-4 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.07s]
[0m23:01:30.159306 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:01:30.159606 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:01:30.159781 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:01:30.159980 [info ] [Thread-3 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m23:01:30.160833 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m23:01:30.161024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:01:30.161261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m23:01:30.162132 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m23:01:30.162360 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m23:01:30.162591 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:01:30.162967 [info ] [Thread-2 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.02s]
[0m23:01:30.165085 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:01:30.165296 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m23:01:30.165625 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:01:30.166006 [info ] [Thread-1 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.07s]
[0m23:01:30.166428 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:01:30.166659 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:01:30.167954 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:01:30.168349 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:01:30.168502 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m23:01:30.168646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:01:30.175647 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:01:30.175922 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:01:30.176193 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:01:30.177426 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:01:30.178205 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m23:01:30.179355 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m23:01:30.179792 [info ] [Thread-3 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m23:01:30.180070 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:01:30.180748 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.180933 [debug] [MainThread]: On master: BEGIN
[0m23:01:30.181075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:30.188286 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:01:30.188552 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.188759 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:30.188884 [debug] [MainThread]: On master: COMMIT
[0m23:01:30.189479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:30.189640 [debug] [MainThread]: On master: Close
[0m23:01:30.189858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:30.190080 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m23:01:30.190200 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m23:01:30.190313 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m23:01:30.190421 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m23:01:30.190569 [info ] [MainThread]: 
[0m23:01:30.190709 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:01:30.191382 [debug] [MainThread]: Command end result
[0m23:01:30.204000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:30.204957 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:30.208390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m23:01:30.208590 [info ] [MainThread]: 
[0m23:01:30.208783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:30.208984 [info ] [MainThread]: 
[0m23:01:30.209205 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:01:30.210076 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62871003, "process_in_blocks": "0", "process_kernel_time": 0.199979, "process_mem_max_rss": "132808704", "process_out_blocks": "0", "process_user_time": 1.065985}
[0m23:01:30.210268 [debug] [MainThread]: Command `dbt test` succeeded at 23:01:30.210232 after 0.63 seconds
[0m23:01:30.210440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d53f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e4cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e4ce50>]}
[0m23:01:30.210636 [debug] [MainThread]: Flushing usage events
[0m23:01:31.301778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:01:38.181189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106915210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106915890>]}


============================== 23:01:38.183472 | 7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9 ==============================
[0m23:01:38.183472 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:01:38.183812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_all_apartment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:38.267936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106907d50>]}
[0m23:01:38.292125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a34850>]}
[0m23:01:38.292620 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:01:38.339433 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:01:38.395470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:38.395759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:38.417028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107618f50>]}
[0m23:01:38.454506 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:38.457336 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:38.464160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776f910>]}
[0m23:01:38.464452 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:01:38.464631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107619390>]}
[0m23:01:38.465408 [info ] [MainThread]: 
[0m23:01:38.465581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:38.465710 [info ] [MainThread]: 
[0m23:01:38.465968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:01:38.466394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m23:01:38.489363 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m23:01:38.489663 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m23:01:38.489812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:38.512884 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m23:01:38.513728 [debug] [ThreadPool]: On list_re: Close
[0m23:01:38.516187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m23:01:38.519302 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:38.519509 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m23:01:38.519647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:38.529334 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:01:38.529593 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:01:38.529783 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:01:38.532215 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m23:01:38.532926 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m23:01:38.533461 [debug] [ThreadPool]: On list_re_public: Close
[0m23:01:38.536458 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.536684 [debug] [MainThread]: On master: BEGIN
[0m23:01:38.536811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:38.544506 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:01:38.544750 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.544956 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:01:38.548845 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m23:01:38.549522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075deb10>]}
[0m23:01:38.549796 [debug] [MainThread]: On master: ROLLBACK
[0m23:01:38.550414 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.550580 [debug] [MainThread]: On master: BEGIN
[0m23:01:38.552295 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m23:01:38.552458 [debug] [MainThread]: On master: COMMIT
[0m23:01:38.552603 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.552725 [debug] [MainThread]: On master: COMMIT
[0m23:01:38.553214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:38.553373 [debug] [MainThread]: On master: Close
[0m23:01:38.554173 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m23:01:38.554454 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_all_apartment ......................... [RUN]
[0m23:01:38.554685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.fact_all_apartment)
[0m23:01:38.554875 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m23:01:38.559252 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m23:01:38.559731 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m23:01:38.577953 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m23:01:38.578650 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.578872 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m23:01:38.579031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:38.588098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:01:38.588356 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.588578 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m23:01:38.672182 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.083 seconds
[0m23:01:38.675587 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.675805 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m23:01:38.676624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:01:38.678037 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.678347 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m23:01:38.679032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:01:38.688270 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:01:38.688479 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.688652 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:01:38.690565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:01:38.693524 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."fact_all_apartment__dbt_backup"
[0m23:01:38.696025 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:01:38.696285 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m23:01:38.697900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:01:38.699158 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m23:01:38.700043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d8e5ed4-80bf-4ef2-b6da-6ac1919009c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a64690>]}
[0m23:01:38.700411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.14s]
[0m23:01:38.700694 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m23:01:38.701482 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.701684 [debug] [MainThread]: On master: BEGIN
[0m23:01:38.701828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:01:38.709401 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:01:38.709664 [debug] [MainThread]: On master: COMMIT
[0m23:01:38.709831 [debug] [MainThread]: Using postgres connection "master"
[0m23:01:38.709975 [debug] [MainThread]: On master: COMMIT
[0m23:01:38.710553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:01:38.710820 [debug] [MainThread]: On master: Close
[0m23:01:38.711096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:38.711298 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m23:01:38.711476 [info ] [MainThread]: 
[0m23:01:38.711657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m23:01:38.711992 [debug] [MainThread]: Command end result
[0m23:01:38.755629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:01:38.756438 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:01:38.759043 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m23:01:38.759194 [info ] [MainThread]: 
[0m23:01:38.759399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:38.759548 [info ] [MainThread]: 
[0m23:01:38.759699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:01:38.760648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61324644, "process_in_blocks": "0", "process_kernel_time": 0.166918, "process_mem_max_rss": "128466944", "process_out_blocks": "0", "process_user_time": 0.97809}
[0m23:01:38.760853 [debug] [MainThread]: Command `dbt run` succeeded at 23:01:38.760814 after 0.61 seconds
[0m23:01:38.761040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102574090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025fa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102661010>]}
[0m23:01:38.761216 [debug] [MainThread]: Flushing usage events
[0m23:01:39.849315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:00.261477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aace4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac86450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aad7800>]}


============================== 16:02:00.265820 | 79d37588-d276-4917-8faf-003d0ad7c29f ==============================
[0m16:02:00.265820 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:02:00.266205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:00.296398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9abf8a40>]}
[0m16:02:00.303574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b05b4a0>]}
[0m16:02:00.308771 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:02:00.314854 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:02:00.315186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9d3da0>]}
[0m16:02:00.572610 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m16:02:00.580314 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m16:02:00.582642 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m16:02:00.584500 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m16:02:00.586679 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m16:02:00.650533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cf45c0>]}
[0m16:02:00.655326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b41ec30>]}
[0m16:02:00.655765 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:02:00.656045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d37588-d276-4917-8faf-003d0ad7c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ca2ba0>]}
[0m16:02:00.657239 [info ] [MainThread]: 
[0m16:02:00.657826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:00.658611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m16:02:00.664359 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m16:02:00.664783 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:02:00.665003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:00.665663 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:02:00.667029 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:02:00.667290 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:02:00.667516 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:02:00.667715 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:02:00.667906 [debug] [ThreadPool]: On list_re: No close available on handle
[0m16:02:00.668581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:00.668754 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m16:02:00.668905 [info ] [MainThread]: 
[0m16:02:00.669246 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m16:02:00.669737 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m16:02:00.670221 [debug] [MainThread]: Command `dbt run` failed at 16:02:00.670141 after 0.41 seconds
[0m16:02:00.670457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aacd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9ccc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cfb7d0>]}
[0m16:02:00.670676 [debug] [MainThread]: Flushing usage events
[0m16:03:23.743582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5576e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b97a270>]}


============================== 16:03:23.747819 | 3de88b28-f257-4c88-abfd-4c99a0e14f6b ==============================
[0m16:03:23.747819 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:03:23.748167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:23.777961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b198680>]}
[0m16:03:23.785347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af9ddc0>]}
[0m16:03:23.790376 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:03:23.795449 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:03:23.795786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae90f20>]}
[0m16:03:24.051211 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m16:03:24.058164 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m16:03:24.059994 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m16:03:24.061709 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m16:03:24.063293 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m16:03:24.119816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a13a210>]}
[0m16:03:24.123744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9adf8950>]}
[0m16:03:24.123984 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:03:24.124233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae8b6b0>]}
[0m16:03:24.125014 [info ] [MainThread]: 
[0m16:03:24.125526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:24.126173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m16:03:24.131667 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m16:03:24.131882 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:03:24.132031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:24.141128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:03:24.141992 [debug] [ThreadPool]: On list_re: Close
[0m16:03:24.143101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m16:03:24.146176 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:24.146433 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m16:03:24.146622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:24.154613 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:03:24.154880 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:24.155043 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:03:24.156975 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:03:24.157772 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m16:03:24.158426 [debug] [ThreadPool]: On list_re_public: Close
[0m16:03:24.161398 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.161625 [debug] [MainThread]: On master: BEGIN
[0m16:03:24.161785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:24.170273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:24.170624 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.170933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:24.173277 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:03:24.174219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae4aab0>]}
[0m16:03:24.174531 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:24.175291 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.175479 [debug] [MainThread]: On master: BEGIN
[0m16:03:24.176635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:24.176831 [debug] [MainThread]: On master: COMMIT
[0m16:03:24.177003 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.177143 [debug] [MainThread]: On master: COMMIT
[0m16:03:24.177841 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:24.178008 [debug] [MainThread]: On master: Close
[0m16:03:24.178428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:24.178732 [info ] [MainThread]: 
[0m16:03:24.190874 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m16:03:24.191289 [info ] [Thread-1 (]: 1 of 1 START sql table model public.fact_all_apartment ......................... [RUN]
[0m16:03:24.191788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.fact_all_apartment)
[0m16:03:24.192023 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m16:03:24.193997 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m16:03:24.194989 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (compile): 16:03:24.192198 => 16:03:24.194880
[0m16:03:24.195207 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m16:03:24.215280 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m16:03:24.216053 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.216250 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m16:03:24.216425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:24.223907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:24.224220 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.224480 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m16:03:24.291132 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.0 seconds
[0m16:03:24.294566 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.294788 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m16:03:24.295650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:24.297136 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.297352 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m16:03:24.298051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:24.308244 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m16:03:24.308492 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.308666 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m16:03:24.309930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:24.312423 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:24.312649 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m16:03:24.314387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:24.315191 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (execute): 16:03:24.195348 => 16:03:24.315097
[0m16:03:24.315407 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m16:03:24.315912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de88b28-f257-4c88-abfd-4c99a0e14f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae966c0>]}
[0m16:03:24.316260 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.12s]
[0m16:03:24.316704 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m16:03:24.317932 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.318134 [debug] [MainThread]: On master: BEGIN
[0m16:03:24.318270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:24.325851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:24.326093 [debug] [MainThread]: On master: COMMIT
[0m16:03:24.326256 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:24.326411 [debug] [MainThread]: On master: COMMIT
[0m16:03:24.327107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:24.327351 [debug] [MainThread]: On master: Close
[0m16:03:24.327749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:24.327908 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m16:03:24.328143 [info ] [MainThread]: 
[0m16:03:24.328460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m16:03:24.329056 [debug] [MainThread]: Command end result
[0m16:03:24.333566 [info ] [MainThread]: 
[0m16:03:24.333879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:24.334193 [info ] [MainThread]: 
[0m16:03:24.334573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:24.334977 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:24.334911 after 0.60 seconds
[0m16:03:24.335202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b97a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6594c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb0e3c0>]}
[0m16:03:24.335399 [debug] [MainThread]: Flushing usage events
[0m16:03:32.732909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d9a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82564800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81eee450>]}


============================== 16:03:32.737070 | e761ae2b-7dfa-4db9-9461-8357ffaa5999 ==============================
[0m16:03:32.737070 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:03:32.737435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:32.767236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f0b620>]}
[0m16:03:32.774498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c91e20>]}
[0m16:03:32.779305 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:03:32.793600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:32.793830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:32.796804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d99ca0>]}
[0m16:03:32.800615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c9f140>]}
[0m16:03:32.800860 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:03:32.801107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82238530>]}
[0m16:03:32.802046 [info ] [MainThread]: 
[0m16:03:32.802540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:32.803241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m16:03:32.808382 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m16:03:32.808590 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m16:03:32.808798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:32.819307 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m16:03:32.820194 [debug] [ThreadPool]: On list_re: Close
[0m16:03:32.821302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m16:03:32.824390 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:32.824658 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m16:03:32.824829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:32.833846 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.834087 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:32.834248 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:03:32.836270 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:03:32.837016 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m16:03:32.837721 [debug] [ThreadPool]: On list_re_public: Close
[0m16:03:32.840651 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.840919 [debug] [MainThread]: On master: BEGIN
[0m16:03:32.841082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:32.849273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.849542 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.849750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:32.851923 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:03:32.852645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82442000>]}
[0m16:03:32.852890 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:32.853549 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.853724 [debug] [MainThread]: On master: BEGIN
[0m16:03:32.854852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.855032 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.855170 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:32.855301 [debug] [MainThread]: On master: COMMIT
[0m16:03:32.855991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:32.856277 [debug] [MainThread]: On master: Close
[0m16:03:32.856773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:32.857035 [info ] [MainThread]: 
[0m16:03:32.869341 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m16:03:32.869756 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m16:03:32.870241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m16:03:32.870508 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m16:03:32.872143 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m16:03:32.873160 [debug] [Thread-1 (]: Timing info for model.real_estate.staging_table (compile): 16:03:32.870675 => 16:03:32.873047
[0m16:03:32.873380 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m16:03:32.893587 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m16:03:32.894265 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.894451 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m16:03:32.894647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:32.901578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.901878 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.902095 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m16:03:32.911291 [debug] [Thread-1 (]: SQL status: SELECT 6561 in 0.0 seconds
[0m16:03:32.914754 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.914972 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m16:03:32.915848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:32.917333 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.917589 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m16:03:32.918331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:32.928582 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m16:03:32.928801 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.928968 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m16:03:32.936926 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:32.939648 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m16:03:32.939858 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "re"."public"."staging_table__dbt_backup" cascade
[0m16:03:32.942112 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:32.942985 [debug] [Thread-1 (]: Timing info for model.real_estate.staging_table (execute): 16:03:32.873531 => 16:03:32.942891
[0m16:03:32.943179 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m16:03:32.943835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c9d760>]}
[0m16:03:32.944289 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 6561[0m in 0.07s]
[0m16:03:32.944762 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m16:03:32.945405 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m16:03:32.945762 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m16:03:32.946232 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m16:03:32.946022 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m16:03:32.946621 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m16:03:32.946971 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m16:03:32.947521 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m16:03:32.947936 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m16:03:32.948346 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m16:03:32.948541 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m16:03:32.948746 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m16:03:32.948940 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m16:03:32.950699 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m16:03:32.952095 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m16:03:32.953551 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m16:03:32.954618 [debug] [Thread-3 (]: Timing info for model.real_estate.dim_broker (compile): 16:03:32.949076 => 16:03:32.954519
[0m16:03:32.954914 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m16:03:32.955143 [debug] [Thread-4 (]: Timing info for model.real_estate.dim_post (compile): 16:03:32.950900 => 16:03:32.955050
[0m16:03:32.957664 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m16:03:32.957434 [debug] [Thread-2 (]: Timing info for model.real_estate.dim_project (compile): 16:03:32.952289 => 16:03:32.957346
[0m16:03:32.957215 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m16:03:32.959610 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m16:03:32.959846 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m16:03:32.962058 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m16:03:32.962444 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:32.962682 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m16:03:32.962948 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:32.963101 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:32.963269 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:32.963630 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m16:03:32.963861 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m16:03:32.964090 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:32.964312 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:03:32.972280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.972543 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.972745 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:32.973585 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "re"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "re"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m16:03:32.973304 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:32.972999 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:32.973944 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "re"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "re"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m16:03:32.974165 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:32.974702 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "re"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "re"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m16:03:32.979695 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.0 seconds
[0m16:03:32.979987 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.0 seconds
[0m16:03:32.981570 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:32.983540 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:32.983795 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m16:03:32.984007 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m16:03:32.985479 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:32.985713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.008749 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:33.010304 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:33.010557 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.0 seconds
[0m16:03:33.012440 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:33.011054 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m16:03:33.010733 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m16:03:33.012635 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m16:03:33.013608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.013846 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.014035 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.015284 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m16:03:33.016424 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m16:03:33.017826 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:33.018543 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m16:03:33.018217 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:33.018010 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:33.018890 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m16:03:33.019155 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m16:03:33.019440 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.020815 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m16:03:33.021033 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:33.021207 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m16:03:33.024561 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:33.024877 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:33.025165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:33.026542 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m16:03:33.027661 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m16:03:33.029184 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "re"."public"."dim_project__dbt_backup" cascade
[0m16:03:33.028985 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "re"."public"."dim_broker__dbt_backup" cascade
[0m16:03:33.028755 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m16:03:33.029664 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "re"."public"."dim_post__dbt_backup" cascade
[0m16:03:33.031006 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:33.032010 [debug] [Thread-2 (]: Timing info for model.real_estate.dim_project (execute): 16:03:32.960249 => 16:03:33.031918
[0m16:03:33.032395 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m16:03:33.032205 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:33.031231 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:33.032894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8102c050>]}
[0m16:03:33.033644 [debug] [Thread-3 (]: Timing info for model.real_estate.dim_broker (execute): 16:03:32.955252 => 16:03:33.033553
[0m16:03:33.034364 [debug] [Thread-4 (]: Timing info for model.real_estate.dim_post (execute): 16:03:32.957804 => 16:03:33.034270
[0m16:03:33.035541 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m16:03:33.035282 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m16:03:33.034851 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.08s]
[0m16:03:33.036787 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m16:03:33.036447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8101c8c0>]}
[0m16:03:33.035985 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c9cc50>]}
[0m16:03:33.037314 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.09s]
[0m16:03:33.037932 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.09s]
[0m16:03:33.038586 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m16:03:33.038941 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m16:03:33.039521 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m16:03:33.039785 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m16:03:33.040249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m16:03:33.040534 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m16:03:33.042755 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m16:03:33.043685 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (compile): 16:03:33.040698 => 16:03:33.043574
[0m16:03:33.043894 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m16:03:33.045940 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m16:03:33.046425 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.046645 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m16:03:33.046875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:33.054875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:33.055131 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.055364 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m16:03:33.253280 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.0 seconds
[0m16:03:33.255278 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.255529 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m16:03:33.256482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.257915 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.258098 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m16:03:33.258891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:03:33.260138 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m16:03:33.260333 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.260492 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m16:03:33.263232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:03:33.264413 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m16:03:33.264616 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m16:03:33.266253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:03:33.267061 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (execute): 16:03:33.044020 => 16:03:33.266962
[0m16:03:33.267260 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m16:03:33.267733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e761ae2b-7dfa-4db9-9461-8357ffaa5999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c8dca0>]}
[0m16:03:33.268044 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.23s]
[0m16:03:33.268400 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m16:03:33.269402 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:33.269656 [debug] [MainThread]: On master: BEGIN
[0m16:03:33.269877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:33.278247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:33.278544 [debug] [MainThread]: On master: COMMIT
[0m16:03:33.278712 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:33.278863 [debug] [MainThread]: On master: COMMIT
[0m16:03:33.279520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:33.279685 [debug] [MainThread]: On master: Close
[0m16:03:33.280076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:33.280226 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m16:03:33.280403 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m16:03:33.280547 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m16:03:33.280671 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m16:03:33.280856 [info ] [MainThread]: 
[0m16:03:33.281098 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:03:33.281991 [debug] [MainThread]: Command end result
[0m16:03:33.286573 [info ] [MainThread]: 
[0m16:03:33.286846 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:33.287118 [info ] [MainThread]: 
[0m16:03:33.287467 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:03:33.287875 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:33.287821 after 0.56 seconds
[0m16:03:33.288062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821e38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827e2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82067e00>]}
[0m16:03:33.288275 [debug] [MainThread]: Flushing usage events
[0m16:03:42.177077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0887620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09a7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c58680>]}


============================== 16:03:42.181195 | 3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca ==============================
[0m16:03:42.181195 [info ] [MainThread]: Running with dbt=1.5.0
[0m16:03:42.181552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:42.211767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d0ec30>]}
[0m16:03:42.218945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d993a0>]}
[0m16:03:42.223766 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m16:03:42.237640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:42.237880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:42.240812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d0f6e0>]}
[0m16:03:42.244593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb069a570>]}
[0m16:03:42.244828 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m16:03:42.245044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1050d40>]}
[0m16:03:42.246225 [info ] [MainThread]: 
[0m16:03:42.246840 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:42.247649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m16:03:42.253055 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:42.253271 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m16:03:42.253444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:42.262271 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.262548 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m16:03:42.262714 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:03:42.264766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:03:42.265619 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m16:03:42.266302 [debug] [ThreadPool]: On list_re_public: Close
[0m16:03:42.269335 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.269557 [debug] [MainThread]: On master: BEGIN
[0m16:03:42.269704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:42.277130 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.277478 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.277801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:42.280016 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:03:42.280762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ef6e9da-01a6-4fc1-8482-821ca9dfd6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0698980>]}
[0m16:03:42.281039 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:42.281732 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.281923 [debug] [MainThread]: On master: BEGIN
[0m16:03:42.283403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.283586 [debug] [MainThread]: On master: COMMIT
[0m16:03:42.283736 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.283909 [debug] [MainThread]: On master: COMMIT
[0m16:03:42.284536 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:42.284700 [debug] [MainThread]: On master: Close
[0m16:03:42.285117 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:42.285389 [info ] [MainThread]: 
[0m16:03:42.297918 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m16:03:42.298201 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m16:03:42.298417 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m16:03:42.298607 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m16:03:42.298896 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m16:03:42.299108 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m16:03:42.299464 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m16:03:42.299987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m16:03:42.300253 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m16:03:42.300739 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m16:03:42.301156 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m16:03:42.301398 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m16:03:42.301809 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m16:03:42.302048 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m16:03:42.302262 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m16:03:42.308952 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m16:03:42.309163 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m16:03:42.311145 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m16:03:42.313290 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m16:03:42.317401 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m16:03:42.318396 [debug] [Thread-1 (]: Timing info for test.real_estate.not_null_dim_broker_broker_id.b2317a90a1 (compile): 16:03:42.302435 => 16:03:42.318145
[0m16:03:42.318689 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m16:03:42.324652 [debug] [Thread-2 (]: Timing info for test.real_estate.not_null_dim_post_post_id.5d776b2d46 (compile): 16:03:42.309353 => 16:03:42.324463
[0m16:03:42.326506 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m16:03:42.326731 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m16:03:42.326958 [debug] [Thread-3 (]: Timing info for test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3 (compile): 16:03:42.311362 => 16:03:42.326866
[0m16:03:42.327183 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da (compile): 16:03:42.313667 => 16:03:42.327079
[0m16:03:42.328555 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m16:03:42.328800 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m16:03:42.329075 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m16:03:42.329279 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m16:03:42.330490 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m16:03:42.331552 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m16:03:42.331767 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m16:03:42.332043 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m16:03:42.332385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:42.332604 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m16:03:42.332928 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m16:03:42.333672 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m16:03:42.333366 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m16:03:42.333175 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:03:42.333853 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:03:42.334046 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m16:03:42.334588 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:42.341613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.342007 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m16:03:42.342272 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.342635 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "re"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m16:03:42.342943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.343861 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m16:03:42.343503 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m16:03:42.343281 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.344552 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m16:03:42.344336 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "re"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m16:03:42.344082 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:42.344761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.344940 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "re"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m16:03:42.346713 [debug] [Thread-1 (]: Timing info for test.real_estate.not_null_dim_broker_broker_id.b2317a90a1 (execute): 16:03:42.318938 => 16:03:42.346563
[0m16:03:42.346967 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.347147 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.347430 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m16:03:42.348247 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da (execute): 16:03:42.330672 => 16:03:42.348152
[0m16:03:42.349562 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m16:03:42.349179 [debug] [Thread-2 (]: Timing info for test.real_estate.not_null_dim_post_post_id.5d776b2d46 (execute): 16:03:42.327470 => 16:03:42.349080
[0m16:03:42.348471 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.350036 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m16:03:42.350261 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m16:03:42.351157 [debug] [Thread-3 (]: Timing info for test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3 (execute): 16:03:42.329485 => 16:03:42.351028
[0m16:03:42.351427 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m16:03:42.352253 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m16:03:42.352480 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m16:03:42.352057 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.05s]
[0m16:03:42.353129 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.05s]
[0m16:03:42.354039 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.05s]
[0m16:03:42.354522 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m16:03:42.354781 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m16:03:42.355080 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m16:03:42.355441 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m16:03:42.355817 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m16:03:42.356457 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.06s]
[0m16:03:42.356882 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m16:03:42.357379 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m16:03:42.357677 [info ] [Thread-1 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m16:03:42.358142 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m16:03:42.358509 [info ] [Thread-4 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m16:03:42.358871 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m16:03:42.359420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m16:03:42.359723 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m16:03:42.360988 [info ] [Thread-3 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m16:03:42.360521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m16:03:42.360773 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m16:03:42.360123 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m16:03:42.365290 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m16:03:42.361674 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m16:03:42.365017 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m16:03:42.361411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m16:03:42.367938 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m16:03:42.371218 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m16:03:42.371636 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m16:03:42.374009 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m16:03:42.374449 [debug] [Thread-1 (]: Timing info for test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1 (compile): 16:03:42.361855 => 16:03:42.374338
[0m16:03:42.374808 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m16:03:42.376122 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m16:03:42.375017 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_broker_broker_id.4fb11e03af (compile): 16:03:42.368158 => 16:03:42.374919
[0m16:03:42.376403 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1 (compile): 16:03:42.365442 => 16:03:42.376290
[0m16:03:42.376875 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m16:03:42.377190 [debug] [Thread-3 (]: Timing info for test.real_estate.unique_dim_post_post_id.91979bbf4d (compile): 16:03:42.372109 => 16:03:42.377094
[0m16:03:42.377377 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m16:03:42.377639 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m16:03:42.378720 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m16:03:42.378942 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m16:03:42.379981 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m16:03:42.380214 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m16:03:42.382221 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m16:03:42.382568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:42.382894 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m16:03:42.383331 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m16:03:42.383551 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m16:03:42.383912 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:42.384208 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m16:03:42.384383 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m16:03:42.384903 [debug] [Thread-3 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m16:03:42.385237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:03:42.385756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:03:42.393516 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.393843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.394146 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m16:03:42.394459 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.394826 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m16:03:42.395132 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:42.395393 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m16:03:42.395737 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "re"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "re"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:42.395943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.396787 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m16:03:42.396997 [debug] [Thread-3 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:42.396331 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "re"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "re"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:03:42.397473 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.398581 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_broker_broker_id.4fb11e03af (execute): 16:03:42.377747 => 16:03:42.398433
[0m16:03:42.398843 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.399027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.399198 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.399382 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m16:03:42.400177 [debug] [Thread-3 (]: Timing info for test.real_estate.unique_dim_post_post_id.91979bbf4d (execute): 16:03:42.380507 => 16:03:42.400072
[0m16:03:42.400934 [debug] [Thread-1 (]: Timing info for test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1 (execute): 16:03:42.375121 => 16:03:42.400835
[0m16:03:42.401622 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1 (execute): 16:03:42.379096 => 16:03:42.401530
[0m16:03:42.402712 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m16:03:42.402274 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m16:03:42.402514 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m16:03:42.401961 [debug] [Thread-3 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m16:03:42.403592 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m16:03:42.403902 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m16:03:42.404249 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m16:03:42.404673 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m16:03:42.404957 [debug] [Thread-3 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m16:03:42.405571 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.05s]
[0m16:03:42.406265 [info ] [Thread-4 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.05s]
[0m16:03:42.406640 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m16:03:42.407238 [info ] [Thread-3 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.05s]
[0m16:03:42.407655 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m16:03:42.408863 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m16:03:42.409166 [info ] [Thread-2 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m16:03:42.409610 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m16:03:42.410325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.unique_dim_broker_broker_id.4fb11e03af, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m16:03:42.410730 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m16:03:42.434544 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m16:03:42.435670 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_project_project_id.87b4f343a2 (compile): 16:03:42.410884 => 16:03:42.435560
[0m16:03:42.435886 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m16:03:42.437084 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m16:03:42.437591 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m16:03:42.437758 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m16:03:42.437901 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:03:42.445598 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.445928 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m16:03:42.446204 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:42.448423 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m16:03:42.449416 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_project_project_id.87b4f343a2 (execute): 16:03:42.436030 => 16:03:42.449276
[0m16:03:42.449676 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m16:03:42.450294 [debug] [Thread-2 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m16:03:42.450821 [info ] [Thread-2 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.04s]
[0m16:03:42.451175 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m16:03:42.452292 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.452523 [debug] [MainThread]: On master: BEGIN
[0m16:03:42.452702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:42.460252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:42.460541 [debug] [MainThread]: On master: COMMIT
[0m16:03:42.460693 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:42.460825 [debug] [MainThread]: On master: COMMIT
[0m16:03:42.461394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:42.461566 [debug] [MainThread]: On master: Close
[0m16:03:42.461983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:42.462142 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m16:03:42.462301 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m16:03:42.462438 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m16:03:42.462614 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m16:03:42.462810 [info ] [MainThread]: 
[0m16:03:42.463019 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m16:03:42.464011 [debug] [MainThread]: Command end result
[0m16:03:42.467888 [info ] [MainThread]: 
[0m16:03:42.468152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:42.468440 [info ] [MainThread]: 
[0m16:03:42.468743 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m16:03:42.469150 [debug] [MainThread]: Command `dbt test` succeeded at 16:03:42.469096 after 0.30 seconds
[0m16:03:42.469364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb075c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2980fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf135400>]}
[0m16:03:42.469554 [debug] [MainThread]: Flushing usage events
[0m23:15:20.555346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d50b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d51210>]}


============================== 23:15:20.558290 | 9ad514ac-a15a-435d-b730-082b1399830a ==============================
[0m23:15:20.558290 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:15:20.558629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:15:20.569548 [info ] [MainThread]: dbt version: 1.9.2
[0m23:15:20.569825 [info ] [MainThread]: python version: 3.11.10
[0m23:15:20.569988 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m23:15:20.570123 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m23:15:20.616658 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m23:15:20.616971 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m23:15:20.617125 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m23:15:20.617558 [info ] [MainThread]: adapter type: postgres
[0m23:15:20.617743 [info ] [MainThread]: adapter version: 1.9.0
[0m23:15:20.659518 [info ] [MainThread]: Configuration:
[0m23:15:20.659838 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:15:20.659981 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:15:20.660109 [info ] [MainThread]: Required dependencies:
[0m23:15:20.660290 [debug] [MainThread]: Executing "git --help"
[0m23:15:20.686162 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:15:20.686759 [debug] [MainThread]: STDERR: "b''"
[0m23:15:20.686943 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:15:20.687106 [info ] [MainThread]: Connection:
[0m23:15:20.687290 [info ] [MainThread]:   host: host.docker.internal
[0m23:15:20.687418 [info ] [MainThread]:   port: 5432
[0m23:15:20.687536 [info ] [MainThread]:   user: airflow
[0m23:15:20.687653 [info ] [MainThread]:   database: re
[0m23:15:20.687766 [info ] [MainThread]:   schema: public
[0m23:15:20.687880 [info ] [MainThread]:   connect_timeout: 10
[0m23:15:20.688003 [info ] [MainThread]:   role: None
[0m23:15:20.688121 [info ] [MainThread]:   search_path: None
[0m23:15:20.688238 [info ] [MainThread]:   keepalives_idle: 0
[0m23:15:20.688351 [info ] [MainThread]:   sslmode: None
[0m23:15:20.688461 [info ] [MainThread]:   sslcert: None
[0m23:15:20.688573 [info ] [MainThread]:   sslkey: None
[0m23:15:20.688685 [info ] [MainThread]:   sslrootcert: None
[0m23:15:20.688797 [info ] [MainThread]:   application_name: dbt
[0m23:15:20.688940 [info ] [MainThread]:   retries: 1
[0m23:15:20.689302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:15:20.735030 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:15:20.760458 [debug] [MainThread]: Using postgres connection "debug"
[0m23:15:20.760691 [debug] [MainThread]: On debug: select 1 as id
[0m23:15:20.760836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:15:20.770920 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known

[0m23:15:20.772057 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m23:15:20.772197 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m23:15:20.772344 [debug] [MainThread]: On debug: No close available on handle
[0m23:15:20.772513 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:15:20.772671 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:15:20.772807 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:15:20.773937 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.25530112, "process_in_blocks": "0", "process_kernel_time": 0.193651, "process_mem_max_rss": "115752960", "process_out_blocks": "0", "process_user_time": 0.69961}
[0m23:15:20.774163 [debug] [MainThread]: Command `dbt debug` failed at 23:15:20.774114 after 0.26 seconds
[0m23:15:20.774342 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:15:20.774515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100987f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d511d0>]}
[0m23:15:20.774728 [debug] [MainThread]: Flushing usage events
[0m23:15:21.922800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:56.813458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e952d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efe010>]}


============================== 23:16:56.816259 | af1c13c3-f395-4bbc-8e50-6483beb3d1f6 ==============================
[0m23:16:56.816259 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:16:56.816578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -f', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:56.953015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eca5d0>]}
[0m23:16:56.977701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032e7f50>]}
[0m23:16:56.978468 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:16:57.028182 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:16:57.071146 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:16:57.071538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055af950>]}
[0m23:16:57.631341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7e490>]}
[0m23:16:57.666941 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:16:57.669818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:16:57.682712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142b950>]}
[0m23:16:57.682992 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:16:57.683164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1c13c3-f395-4bbc-8e50-6483beb3d1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106feff90>]}
[0m23:16:57.684082 [info ] [MainThread]: 
[0m23:16:57.684253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:16:57.684384 [info ] [MainThread]: 
[0m23:16:57.684601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:57.686418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m23:16:57.715361 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m23:16:57.715613 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m23:16:57.715926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:57.719336 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m23:16:57.721489 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m23:16:57.721660 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:16:57.721815 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:16:57.721935 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:16:57.722064 [debug] [ThreadPool]: On list_re: No close available on handle
[0m23:16:57.722364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:57.722492 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m23:16:57.722622 [info ] [MainThread]: 
[0m23:16:57.722769 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m23:16:57.722991 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m23:16:57.724295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.949206, "process_in_blocks": "0", "process_kernel_time": 0.200867, "process_mem_max_rss": "129957888", "process_out_blocks": "0", "process_user_time": 1.332237}
[0m23:16:57.724478 [debug] [MainThread]: Command `dbt run` failed at 23:16:57.724441 after 0.95 seconds
[0m23:16:57.724648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efe010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e40090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f3850>]}
[0m23:16:57.724835 [debug] [MainThread]: Flushing usage events
[0m23:16:58.944562 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:23.073190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ac95e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12acec2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12acfd590>]}


============================== 23:18:23.076239 | 43126629-0e78-4f27-825f-e2d18783423f ==============================
[0m23:18:23.076239 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:18:23.076565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -f', 'send_anonymous_usage_stats': 'True'}
[0m23:18:23.178535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129de8150>]}
[0m23:18:23.202477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9b850>]}
[0m23:18:23.203121 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:23.251724 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:18:23.294696 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:18:23.295035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1294fcdd0>]}
[0m23:18:23.842789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bad75d0>]}
[0m23:18:23.880487 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:18:23.883262 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:18:23.895827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d087fd0>]}
[0m23:18:23.896110 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:18:23.896282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba67d90>]}
[0m23:18:23.897210 [info ] [MainThread]: 
[0m23:18:23.897382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:23.897514 [info ] [MainThread]: 
[0m23:18:23.897736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:23.899587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m23:18:23.928901 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m23:18:23.929148 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m23:18:23.929285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:23.958366 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m23:18:23.959140 [debug] [ThreadPool]: On list_re: Close
[0m23:18:23.959923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m23:18:23.962990 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:18:23.963220 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m23:18:23.963351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:18:23.973218 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m23:18:23.973473 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:18:23.973667 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:18:23.975691 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m23:18:23.976335 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m23:18:23.977570 [debug] [ThreadPool]: On list_re_public: Close
[0m23:18:23.980309 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:23.980500 [debug] [MainThread]: On master: BEGIN
[0m23:18:23.980636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:23.988266 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:18:23.988507 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:23.988716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:23.990910 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:18:23.991655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12baee090>]}
[0m23:18:23.991943 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:23.992506 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:23.992673 [debug] [MainThread]: On master: BEGIN
[0m23:18:23.993507 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:18:23.993679 [debug] [MainThread]: On master: COMMIT
[0m23:18:23.993871 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:23.994038 [debug] [MainThread]: On master: COMMIT
[0m23:18:23.994586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:23.994748 [debug] [MainThread]: On master: Close
[0m23:18:23.995569 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m23:18:23.995842 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m23:18:23.996074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m23:18:23.996236 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m23:18:24.000235 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m23:18:24.001040 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m23:18:24.018376 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m23:18:24.018929 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.019100 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m23:18:24.019250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:24.030672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:18:24.031036 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.031265 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m23:18:24.053787 [debug] [Thread-1 (]: SQL status: SELECT 15309 in 0.022 seconds
[0m23:18:24.057390 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.057614 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m23:18:24.058490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.059940 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.060121 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m23:18:24.060834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.070362 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m23:18:24.070599 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.070763 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m23:18:24.075152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:18:24.078349 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."staging_table__dbt_backup"
[0m23:18:24.080640 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m23:18:24.080841 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "re"."public"."staging_table__dbt_backup" cascade
[0m23:18:24.083016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:18:24.084236 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m23:18:24.085335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0b6ad0>]}
[0m23:18:24.085679 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 15309[0m in 0.09s]
[0m23:18:24.085942 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m23:18:24.086361 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m23:18:24.086564 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m23:18:24.086710 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m23:18:24.086946 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m23:18:24.087190 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m23:18:24.087425 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m23:18:24.087792 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m23:18:24.088030 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m23:18:24.088248 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m23:18:24.088416 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m23:18:24.088568 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m23:18:24.088715 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m23:18:24.090136 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m23:18:24.091559 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m23:18:24.093222 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m23:18:24.093802 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m23:18:24.093992 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m23:18:24.094160 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m23:18:24.096729 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m23:18:24.098356 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m23:18:24.100200 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m23:18:24.100710 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:18:24.100970 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m23:18:24.101174 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:18:24.101380 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:18:24.101566 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:18:24.101741 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m23:18:24.101890 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m23:18:24.102111 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:18:24.102268 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:18:24.117001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:18:24.117250 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m23:18:24.117425 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m23:18:24.117638 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:18:24.117793 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:18:24.117937 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:18:24.118133 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "re"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "re"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m23:18:24.118380 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "re"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "re"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m23:18:24.118606 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "re"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "re"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m23:18:24.130568 [debug] [Thread-3 (]: SQL status: SELECT 242 in 0.012 seconds
[0m23:18:24.132291 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:18:24.132487 [debug] [Thread-2 (]: SQL status: SELECT 87 in 0.014 seconds
[0m23:18:24.132658 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m23:18:24.133993 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:18:24.134221 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m23:18:24.134791 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.134962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.135647 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m23:18:24.136383 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m23:18:24.136549 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:18:24.136704 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:18:24.136847 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m23:18:24.136988 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m23:18:24.138218 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:18:24.138442 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:18:24.139578 [debug] [Thread-3 (]: Applying DROP to: "re"."public"."dim_broker__dbt_backup"
[0m23:18:24.140611 [debug] [Thread-2 (]: Applying DROP to: "re"."public"."dim_project__dbt_backup"
[0m23:18:24.140945 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m23:18:24.141278 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m23:18:24.141442 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "re"."public"."dim_broker__dbt_backup" cascade
[0m23:18:24.141614 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "re"."public"."dim_project__dbt_backup" cascade
[0m23:18:24.142275 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m23:18:24.142416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:18:24.143001 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m23:18:24.143533 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m23:18:24.143823 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d369910>]}
[0m23:18:24.144121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d50c590>]}
[0m23:18:24.144490 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 242[0m in 0.06s]
[0m23:18:24.144826 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 87[0m in 0.06s]
[0m23:18:24.145084 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m23:18:24.145328 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m23:18:24.161506 [debug] [Thread-4 (]: SQL status: SELECT 2187 in 0.043 seconds
[0m23:18:24.163420 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:18:24.163693 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m23:18:24.164684 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.165667 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m23:18:24.165850 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:18:24.166005 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m23:18:24.167759 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:24.169131 [debug] [Thread-4 (]: Applying DROP to: "re"."public"."dim_post__dbt_backup"
[0m23:18:24.169518 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m23:18:24.169690 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "re"."public"."dim_post__dbt_backup" cascade
[0m23:18:24.170382 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:18:24.171071 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m23:18:24.171366 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d0af1d0>]}
[0m23:18:24.171676 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 2187[0m in 0.08s]
[0m23:18:24.171925 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m23:18:24.172281 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m23:18:24.172560 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m23:18:24.172778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m23:18:24.172940 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m23:18:24.175000 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m23:18:24.175471 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m23:18:24.178257 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m23:18:24.178657 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:18:24.178814 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m23:18:24.178961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:24.192261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:18:24.192608 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:18:24.192836 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m23:18:24.374912 [debug] [Thread-1 (]: SQL status: SELECT 2187 in 0.182 seconds
[0m23:18:24.376569 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:18:24.376739 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m23:18:24.377473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:18:24.378149 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:18:24.378300 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:18:24.378438 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m23:18:24.380519 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:18:24.381534 [debug] [Thread-1 (]: Applying DROP to: "re"."public"."fact_all_apartment__dbt_backup"
[0m23:18:24.381839 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m23:18:24.381988 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m23:18:24.382670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:18:24.383211 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m23:18:24.383485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43126629-0e78-4f27-825f-e2d18783423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d5530d0>]}
[0m23:18:24.383779 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 2187[0m in 0.21s]
[0m23:18:24.384028 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m23:18:24.384688 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:24.384864 [debug] [MainThread]: On master: BEGIN
[0m23:18:24.384994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:24.393102 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:18:24.393398 [debug] [MainThread]: On master: COMMIT
[0m23:18:24.393543 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:24.393668 [debug] [MainThread]: On master: COMMIT
[0m23:18:24.394384 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m23:18:24.394642 [debug] [MainThread]: On master: Close
[0m23:18:24.394876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:24.395005 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m23:18:24.395121 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m23:18:24.395234 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m23:18:24.395346 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m23:18:24.395538 [info ] [MainThread]: 
[0m23:18:24.395696 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m23:18:24.396262 [debug] [MainThread]: Command end result
[0m23:18:24.407681 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:18:24.408614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:18:24.411458 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m23:18:24.411630 [info ] [MainThread]: 
[0m23:18:24.411808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:24.411939 [info ] [MainThread]: 
[0m23:18:24.412076 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:18:24.413336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3773404, "process_in_blocks": "0", "process_kernel_time": 0.230137, "process_mem_max_rss": "136773632", "process_out_blocks": "0", "process_user_time": 1.503416}
[0m23:18:24.413635 [debug] [MainThread]: Command `dbt run` succeeded at 23:18:24.413578 after 1.38 seconds
[0m23:18:24.413830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a94090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b80f10>]}
[0m23:18:24.414003 [debug] [MainThread]: Flushing usage events
[0m23:18:25.732608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:29.743390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f59d0>]}


============================== 23:18:29.745917 | 3a5c7d21-6e43-4929-9696-32e668b8f876 ==============================
[0m23:18:29.745917 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:18:29.746227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m23:18:29.835320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692d4d0>]}
[0m23:18:29.858967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c9bdd0>]}
[0m23:18:29.859829 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:18:29.907710 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:18:29.982816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:18:29.983069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:18:30.003566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106879850>]}
[0m23:18:30.043084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:18:30.046425 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:18:30.066842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbbc10>]}
[0m23:18:30.067174 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m23:18:30.067342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aee3d0>]}
[0m23:18:30.068388 [info ] [MainThread]: 
[0m23:18:30.068568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:18:30.068699 [info ] [MainThread]: 
[0m23:18:30.068988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:18:30.070837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m23:18:30.096284 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:18:30.096519 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m23:18:30.096655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:18:30.117847 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m23:18:30.118092 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m23:18:30.118246 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:18:30.120687 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m23:18:30.121449 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m23:18:30.122085 [debug] [ThreadPool]: On list_re_public: Close
[0m23:18:30.124748 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.124956 [debug] [MainThread]: On master: BEGIN
[0m23:18:30.125280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:18:30.132749 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m23:18:30.133042 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.133267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:18:30.135408 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:18:30.136053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a5c7d21-6e43-4929-9696-32e668b8f876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a51d0>]}
[0m23:18:30.136331 [debug] [MainThread]: On master: ROLLBACK
[0m23:18:30.136859 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.136995 [debug] [MainThread]: On master: BEGIN
[0m23:18:30.137843 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:18:30.138059 [debug] [MainThread]: On master: COMMIT
[0m23:18:30.138209 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.138340 [debug] [MainThread]: On master: COMMIT
[0m23:18:30.138862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:30.139064 [debug] [MainThread]: On master: Close
[0m23:18:30.139994 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:18:30.140198 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:18:30.140377 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:18:30.140529 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:18:30.140707 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m23:18:30.140921 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m23:18:30.141095 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m23:18:30.141280 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m23:18:30.141521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m23:18:30.141766 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m23:18:30.141999 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m23:18:30.142209 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m23:18:30.142377 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:18:30.142536 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:18:30.142679 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:18:30.142826 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:18:30.151195 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:18:30.153087 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:18:30.154755 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:18:30.158188 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:18:30.158707 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:18:30.165774 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:18:30.166119 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:18:30.167232 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:18:30.167479 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:18:30.168583 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:18:30.168841 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:18:30.169078 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:18:30.169265 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:18:30.171145 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:18:30.171327 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:18:30.171522 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m23:18:30.171705 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m23:18:30.171940 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m23:18:30.172121 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:18:30.172291 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:18:30.172447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:30.172604 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:18:30.172824 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m23:18:30.173084 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:18:30.185670 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m23:18:30.185980 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m23:18:30.186187 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:18:30.186856 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m23:18:30.187063 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m23:18:30.187242 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "re"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m23:18:30.187841 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.188082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m23:18:30.188448 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.190657 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m23:18:30.190859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m23:18:30.191053 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m23:18:30.191617 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m23:18:30.191884 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m23:18:30.192160 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "re"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m23:18:30.192401 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m23:18:30.192641 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "re"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m23:18:30.193218 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.05s]
[0m23:18:30.193484 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m23:18:30.193784 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m23:18:30.193977 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.194158 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.194438 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.05s]
[0m23:18:30.194743 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:18:30.195611 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m23:18:30.196276 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m23:18:30.196547 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m23:18:30.196736 [info ] [Thread-4 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m23:18:30.197025 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:18:30.197337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m23:18:30.197524 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m23:18:30.197688 [info ] [Thread-3 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m23:18:30.197929 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m23:18:30.198115 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:18:30.198406 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.06s]
[0m23:18:30.198622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m23:18:30.231484 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.09s]
[0m23:18:30.234714 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:18:30.235108 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m23:18:30.235303 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:18:30.235570 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m23:18:30.235858 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:18:30.238982 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:18:30.239346 [debug] [Thread-1 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:18:30.239610 [info ] [Thread-2 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m23:18:30.239851 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:18:30.240030 [info ] [Thread-1 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m23:18:30.240312 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m23:18:30.240500 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:18:30.241637 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:18:30.241826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m23:18:30.241989 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:18:30.243076 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:18:30.243337 [debug] [Thread-1 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:18:30.246632 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:18:30.247089 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:18:30.249090 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:18:30.249501 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:18:30.249753 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m23:18:30.250021 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:18:30.250201 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m23:18:30.250416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:18:30.250595 [debug] [Thread-1 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:18:30.251911 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:18:30.252214 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:18:30.253644 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:18:30.254221 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:18:30.254446 [debug] [Thread-1 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m23:18:30.254655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:18:30.254875 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:18:30.255121 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m23:18:30.255267 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:18:30.260518 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m23:18:30.260797 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m23:18:30.260992 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "re"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "re"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:18:30.261445 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m23:18:30.261651 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m23:18:30.261847 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "re"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "re"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m23:18:30.262797 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:18:30.263622 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m23:18:30.263877 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m23:18:30.264783 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m23:18:30.265023 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m23:18:30.265256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m23:18:30.265436 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m23:18:30.265980 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m23:18:30.265819 [info ] [Thread-4 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.07s]
[0m23:18:30.266198 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m23:18:30.266369 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m23:18:30.266560 [debug] [Thread-1 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:18:30.266825 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m23:18:30.267034 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:18:30.267332 [info ] [Thread-3 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.07s]
[0m23:18:30.267633 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:18:30.267938 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m23:18:30.268154 [info ] [Thread-4 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m23:18:30.268524 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m23:18:30.268714 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:18:30.268878 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.271067 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:18:30.271303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m23:18:30.272089 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m23:18:30.272838 [debug] [Thread-1 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m23:18:30.273153 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:18:30.274363 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:18:30.274563 [debug] [Thread-1 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m23:18:30.274706 [debug] [Thread-2 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m23:18:30.275191 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:18:30.275009 [info ] [Thread-1 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.03s]
[0m23:18:30.275556 [info ] [Thread-2 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.04s]
[0m23:18:30.275790 [debug] [Thread-4 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m23:18:30.276039 [debug] [Thread-1 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m23:18:30.276267 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m23:18:30.276448 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:18:30.283772 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m23:18:30.284013 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m23:18:30.284197 [debug] [Thread-4 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:18:30.285899 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m23:18:30.286745 [debug] [Thread-4 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m23:18:30.287259 [debug] [Thread-4 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m23:18:30.287590 [info ] [Thread-4 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.02s]
[0m23:18:30.287876 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m23:18:30.288691 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.288848 [debug] [MainThread]: On master: BEGIN
[0m23:18:30.288966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:18:30.298798 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m23:18:30.299154 [debug] [MainThread]: On master: COMMIT
[0m23:18:30.299322 [debug] [MainThread]: Using postgres connection "master"
[0m23:18:30.299459 [debug] [MainThread]: On master: COMMIT
[0m23:18:30.300018 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:18:30.300161 [debug] [MainThread]: On master: Close
[0m23:18:30.300379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:18:30.300583 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m23:18:30.300723 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m23:18:30.300840 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1' was properly closed.
[0m23:18:30.300955 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m23:18:30.301115 [info ] [MainThread]: 
[0m23:18:30.301263 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:18:30.301946 [debug] [MainThread]: Command end result
[0m23:18:30.314375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m23:18:30.315176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m23:18:30.318303 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m23:18:30.318477 [info ] [MainThread]: 
[0m23:18:30.318658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:18:30.318800 [info ] [MainThread]: 
[0m23:18:30.318952 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m23:18:30.320196 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6113722, "process_in_blocks": "0", "process_kernel_time": 0.179579, "process_mem_max_rss": "131923968", "process_out_blocks": "0", "process_user_time": 1.040553}
[0m23:18:30.320495 [debug] [MainThread]: Command `dbt test` succeeded at 23:18:30.320454 after 0.61 seconds
[0m23:18:30.320695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b0bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d24e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d0f6d0>]}
[0m23:18:30.320889 [debug] [MainThread]: Flushing usage events
[0m23:18:31.514826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:47.347386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0755580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa032f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04de7b0>]}


============================== 12:42:47.351840 | 642039e1-2eaf-4b9a-9393-6c6868173054 ==============================
[0m12:42:47.351840 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:42:47.352214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:42:47.385715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa044f710>]}
[0m12:42:47.393994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa021f740>]}
[0m12:42:47.400701 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m12:42:47.408309 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m12:42:47.408688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa03302f0>]}
[0m12:42:47.669181 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m12:42:47.677648 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m12:42:47.679867 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m12:42:47.681729 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m12:42:47.683468 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m12:42:47.740526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5240b0>]}
[0m12:42:47.744666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f545b80>]}
[0m12:42:47.744913 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:42:47.745169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642039e1-2eaf-4b9a-9393-6c6868173054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa021fd40>]}
[0m12:42:47.746139 [info ] [MainThread]: 
[0m12:42:47.746650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:42:47.747390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m12:42:47.752889 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m12:42:47.753181 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m12:42:47.753444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:47.754379 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:42:47.755257 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m12:42:47.755434 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:42:47.755596 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:42:47.755727 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:42:47.755856 [debug] [ThreadPool]: On list_re: No close available on handle
[0m12:42:47.756413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:47.756582 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m12:42:47.756750 [info ] [MainThread]: 
[0m12:42:47.756976 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m12:42:47.757390 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:42:47.757870 [debug] [MainThread]: Command `dbt run` failed at 12:42:47.757769 after 0.42 seconds
[0m12:42:47.758170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0755580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0232db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5443e0>]}
[0m12:42:47.758384 [debug] [MainThread]: Flushing usage events
[0m12:43:50.404106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a97470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84a8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80d9dc0>]}


============================== 12:43:50.408289 | 56b1ac83-8e4a-403e-bf01-7e43db1933cb ==============================
[0m12:43:50.408289 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:43:50.408637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:43:50.438183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8677620>]}
[0m12:43:50.445328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80d8b90>]}
[0m12:43:50.450209 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m12:43:50.455132 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:43:50.455443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fccce0>]}
[0m12:43:50.712021 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m12:43:50.719047 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m12:43:50.720851 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m12:43:50.722426 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m12:43:50.724059 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m12:43:50.783541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa727a2a0>]}
[0m12:43:50.787538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7279160>]}
[0m12:43:50.787831 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:43:50.788166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fade80>]}
[0m12:43:50.789298 [info ] [MainThread]: 
[0m12:43:50.789866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:50.790650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m12:43:50.796310 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m12:43:50.796566 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m12:43:50.796771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:50.807080 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:43:50.807985 [debug] [ThreadPool]: On list_re: Close
[0m12:43:50.809091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m12:43:50.812292 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m12:43:50.812578 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m12:43:50.812757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:50.820261 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.820504 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m12:43:50.820676 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:43:50.822738 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:50.823497 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m12:43:50.824182 [debug] [ThreadPool]: On list_re_public: Close
[0m12:43:50.826950 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:50.827233 [debug] [MainThread]: On master: BEGIN
[0m12:43:50.827390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:50.835181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.835450 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:50.835652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:50.838196 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:43:50.839092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85dab10>]}
[0m12:43:50.839376 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:50.840108 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:50.840264 [debug] [MainThread]: On master: BEGIN
[0m12:43:50.841400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.841594 [debug] [MainThread]: On master: COMMIT
[0m12:43:50.841756 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:50.841893 [debug] [MainThread]: On master: COMMIT
[0m12:43:50.842473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:50.842647 [debug] [MainThread]: On master: Close
[0m12:43:50.843058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:50.843327 [info ] [MainThread]: 
[0m12:43:50.855691 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m12:43:50.856047 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m12:43:50.856510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m12:43:50.856757 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m12:43:50.858317 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m12:43:50.860410 [debug] [Thread-1 (]: Timing info for model.real_estate.staging_table (compile): 12:43:50.856900 => 12:43:50.860305
[0m12:43:50.860606 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m12:43:50.879668 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m12:43:50.880858 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.881064 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m12:43:50.881233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:50.888870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.889124 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.889303 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m12:43:50.929396 [debug] [Thread-1 (]: SQL status: SELECT 19683 in 0.0 seconds
[0m12:43:50.933203 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.933495 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m12:43:50.934580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:50.936054 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.936242 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
alter table "re"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m12:43:50.937188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:50.947416 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m12:43:50.947675 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.947887 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m12:43:50.958352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:43:50.961450 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m12:43:50.961709 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */
drop table if exists "re"."public"."staging_table__dbt_backup" cascade
[0m12:43:50.966808 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:43:50.967739 [debug] [Thread-1 (]: Timing info for model.real_estate.staging_table (execute): 12:43:50.860722 => 12:43:50.967643
[0m12:43:50.967932 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m12:43:50.968441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8082db0>]}
[0m12:43:50.968793 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSELECT 19683[0m in 0.11s]
[0m12:43:50.969231 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m12:43:50.969947 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m12:43:50.970183 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m12:43:50.970371 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m12:43:50.970603 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m12:43:50.971206 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m12:43:50.971569 [info ] [Thread-2 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m12:43:50.972154 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.real_estate.dim_broker'
[0m12:43:50.973185 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m12:43:50.972970 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.real_estate.dim_project'
[0m12:43:50.972577 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.real_estate.dim_post'
[0m12:43:50.975559 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m12:43:50.975843 [debug] [Thread-2 (]: Began compiling node model.real_estate.dim_project
[0m12:43:50.976078 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m12:43:50.977626 [debug] [Thread-2 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m12:43:50.979242 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m12:43:50.980093 [debug] [Thread-3 (]: Timing info for model.real_estate.dim_broker (compile): 12:43:50.973321 => 12:43:50.979976
[0m12:43:50.980319 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m12:43:50.982453 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m12:43:50.982694 [debug] [Thread-2 (]: Timing info for model.real_estate.dim_project (compile): 12:43:50.976356 => 12:43:50.982593
[0m12:43:50.982998 [debug] [Thread-4 (]: Timing info for model.real_estate.dim_post (compile): 12:43:50.977829 => 12:43:50.982898
[0m12:43:50.983161 [debug] [Thread-2 (]: Began executing node model.real_estate.dim_project
[0m12:43:50.983377 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m12:43:50.985449 [debug] [Thread-2 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m12:43:50.987460 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m12:43:50.987773 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m12:43:50.988095 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m12:43:50.988332 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:50.988542 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m12:43:50.989032 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m12:43:50.989294 [debug] [Thread-2 (]: On model.real_estate.dim_project: BEGIN
[0m12:43:50.989686 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m12:43:50.990359 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:50.990077 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:50.999023 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.999301 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:50.999533 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m12:43:50.999821 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m12:43:51.000072 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:51.000975 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m12:43:51.000616 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table "re"."public"."dim_broker__dbt_tmp"
  
  
    as
  
  (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "re"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
  
[0m12:43:51.000258 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table "re"."public"."dim_project__dbt_tmp"
  
  
    as
  
  (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "re"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
  
[0m12:43:51.001310 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table "re"."public"."dim_post__dbt_tmp"
  
  
    as
  
  (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "re"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
  
[0m12:43:51.014800 [debug] [Thread-3 (]: SQL status: SELECT 484 in 0.0 seconds
[0m12:43:51.016879 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m12:43:51.017112 [debug] [Thread-2 (]: SQL status: SELECT 174 in 0.0 seconds
[0m12:43:51.017310 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
alter table "re"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m12:43:51.018816 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m12:43:51.019189 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
alter table "re"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m12:43:51.019910 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:51.020129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:51.021174 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m12:43:51.022184 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m12:43:51.022422 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m12:43:51.022651 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m12:43:51.022875 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m12:43:51.023071 [debug] [Thread-2 (]: On model.real_estate.dim_project: COMMIT
[0m12:43:51.024778 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:43:51.025023 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:43:51.026396 [debug] [Thread-3 (]: Using postgres connection "model.real_estate.dim_broker"
[0m12:43:51.027695 [debug] [Thread-2 (]: Using postgres connection "model.real_estate.dim_project"
[0m12:43:51.027943 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "re"."public"."dim_broker__dbt_backup" cascade
[0m12:43:51.028144 [debug] [Thread-2 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_project"} */
drop table if exists "re"."public"."dim_project__dbt_backup" cascade
[0m12:43:51.028980 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:43:51.029148 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:43:51.029926 [debug] [Thread-2 (]: Timing info for model.real_estate.dim_project (execute): 12:43:50.983591 => 12:43:51.029834
[0m12:43:51.030650 [debug] [Thread-3 (]: Timing info for model.real_estate.dim_broker (execute): 12:43:50.980503 => 12:43:51.030569
[0m12:43:51.030858 [debug] [Thread-2 (]: On model.real_estate.dim_project: Close
[0m12:43:51.031071 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m12:43:51.031599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f03950>]}
[0m12:43:51.032080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fd7d40>]}
[0m12:43:51.032409 [info ] [Thread-2 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSELECT 174[0m in 0.06s]
[0m12:43:51.032980 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSELECT 484[0m in 0.06s]
[0m12:43:51.033594 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m12:43:51.034021 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m12:43:51.072475 [debug] [Thread-4 (]: SQL status: SELECT 4374 in 0.0 seconds
[0m12:43:51.074219 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m12:43:51.074438 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
alter table "re"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m12:43:51.075297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:51.076310 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m12:43:51.076490 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m12:43:51.076664 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m12:43:51.081563 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:43:51.083006 [debug] [Thread-4 (]: Using postgres connection "model.real_estate.dim_post"
[0m12:43:51.083224 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.dim_post"} */
drop table if exists "re"."public"."dim_post__dbt_backup" cascade
[0m12:43:51.083955 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:43:51.084701 [debug] [Thread-4 (]: Timing info for model.real_estate.dim_post (execute): 12:43:50.985618 => 12:43:51.084614
[0m12:43:51.084882 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m12:43:51.085329 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fdb1d0>]}
[0m12:43:51.085674 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSELECT 4374[0m in 0.11s]
[0m12:43:51.086024 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m12:43:51.086618 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m12:43:51.086894 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m12:43:51.087420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m12:43:51.087665 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m12:43:51.089681 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m12:43:51.090839 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (compile): 12:43:51.087839 => 12:43:51.090742
[0m12:43:51.091026 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m12:43:51.093116 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m12:43:51.093708 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m12:43:51.093914 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m12:43:51.094074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:51.101013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:51.101271 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m12:43:51.101509 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table "re"."public"."fact_all_apartment__dbt_tmp"
  
  
    as
  
  (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "re"."public"."staging_table" s   
                    LEFT JOIN "re"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "re"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "re"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
  
[0m12:43:51.347279 [debug] [Thread-1 (]: SQL status: SELECT 4374 in 0.0 seconds
[0m12:43:51.350077 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m12:43:51.350318 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "re"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m12:43:51.351312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:43:51.352369 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m12:43:51.352585 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m12:43:51.352753 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m12:43:51.356499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:43:51.357794 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.fact_all_apartment"
[0m12:43:51.358005 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "re"."public"."fact_all_apartment__dbt_backup" cascade
[0m12:43:51.358838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:43:51.359789 [debug] [Thread-1 (]: Timing info for model.real_estate.fact_all_apartment (execute): 12:43:51.091147 => 12:43:51.359683
[0m12:43:51.359998 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m12:43:51.360468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b1ac83-8e4a-403e-bf01-7e43db1933cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f40b90>]}
[0m12:43:51.360809 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSELECT 4374[0m in 0.27s]
[0m12:43:51.361227 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m12:43:51.362406 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.362712 [debug] [MainThread]: On master: BEGIN
[0m12:43:51.362880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:51.370453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:51.370749 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.370937 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:51.371130 [debug] [MainThread]: On master: COMMIT
[0m12:43:51.371770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:51.371962 [debug] [MainThread]: On master: Close
[0m12:43:51.372406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:51.372573 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m12:43:51.372735 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m12:43:51.372863 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m12:43:51.372988 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m12:43:51.373161 [info ] [MainThread]: 
[0m12:43:51.373446 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:43:51.374347 [debug] [MainThread]: Command end result
[0m12:43:51.378456 [info ] [MainThread]: 
[0m12:43:51.378771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:51.379098 [info ] [MainThread]: 
[0m12:43:51.379403 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:43:51.379845 [debug] [MainThread]: Command `dbt run` succeeded at 12:43:51.379756 after 0.98 seconds
[0m12:43:51.380070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a60680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa84a8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac76b0b0>]}
[0m12:43:51.380271 [debug] [MainThread]: Flushing usage events
[0m12:43:57.914795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86588ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8611b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85520bf0>]}


============================== 12:43:57.919240 | 9b452366-3de5-4d2b-97a0-10efe78cc386 ==============================
[0m12:43:57.919240 [info ] [MainThread]: Running with dbt=1.5.0
[0m12:43:57.919657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:43:57.949806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85257a10>]}
[0m12:43:57.956969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85375310>]}
[0m12:43:57.961869 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m12:43:57.976325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:57.976591 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:57.979486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8526f8c0>]}
[0m12:43:57.983206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85186ed0>]}
[0m12:43:57.983472 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m12:43:57.983723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85256270>]}
[0m12:43:57.984730 [info ] [MainThread]: 
[0m12:43:57.985224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:57.985975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re_public'
[0m12:43:57.991096 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m12:43:57.991304 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m12:43:57.991455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:57.999673 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:43:57.999938 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m12:43:58.000099 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m12:43:58.002051 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:43:58.002900 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m12:43:58.003561 [debug] [ThreadPool]: On list_re_public: Close
[0m12:43:58.006671 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.006933 [debug] [MainThread]: On master: BEGIN
[0m12:43:58.007098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:58.015252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.015518 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.015740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:58.018128 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:43:58.018919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b452366-3de5-4d2b-97a0-10efe78cc386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85268170>]}
[0m12:43:58.019194 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:58.019905 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.020097 [debug] [MainThread]: On master: BEGIN
[0m12:43:58.021210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.021424 [debug] [MainThread]: On master: COMMIT
[0m12:43:58.021582 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.021744 [debug] [MainThread]: On master: COMMIT
[0m12:43:58.022340 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:58.022559 [debug] [MainThread]: On master: Close
[0m12:43:58.023018 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:58.023285 [info ] [MainThread]: 
[0m12:43:58.035702 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m12:43:58.035977 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m12:43:58.036918 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_post_post_id .................................... [RUN]
[0m12:43:58.036374 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_broker_broker_id ................................ [RUN]
[0m12:43:58.036683 [debug] [Thread-4 (]: Began running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m12:43:58.036181 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m12:43:58.037458 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m12:43:58.038004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m12:43:58.038346 [info ] [Thread-4 (]: 4 of 9 START test relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [RUN]
[0m12:43:58.038726 [info ] [Thread-3 (]: 3 of 9 START test not_null_dim_project_project_id .............................. [RUN]
[0m12:43:58.039081 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m12:43:58.039335 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m12:43:58.039814 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da'
[0m12:43:58.040199 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3'
[0m12:43:58.047864 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m12:43:58.050105 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m12:43:58.050499 [debug] [Thread-4 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m12:43:58.050749 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m12:43:58.056641 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m12:43:58.058939 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m12:43:58.059617 [debug] [Thread-2 (]: Timing info for test.real_estate.not_null_dim_post_post_id.5d776b2d46 (compile): 12:43:58.040382 => 12:43:58.059489
[0m12:43:58.059849 [debug] [Thread-1 (]: Timing info for test.real_estate.not_null_dim_broker_broker_id.b2317a90a1 (compile): 12:43:58.048061 => 12:43:58.059734
[0m12:43:58.060065 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m12:43:58.060338 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m12:43:58.067900 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m12:43:58.068255 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da (compile): 12:43:58.052315 => 12:43:58.068117
[0m12:43:58.068498 [debug] [Thread-3 (]: Timing info for test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3 (compile): 12:43:58.056925 => 12:43:58.068408
[0m12:43:58.069699 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m12:43:58.070054 [debug] [Thread-4 (]: Began executing node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m12:43:58.070297 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m12:43:58.071609 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m12:43:58.071931 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m12:43:58.072946 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m12:43:58.073303 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m12:43:58.073480 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m12:43:58.073896 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m12:43:58.074150 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m12:43:58.074317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:58.074538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:58.074691 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m12:43:58.075431 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m12:43:58.074891 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: BEGIN
[0m12:43:58.076089 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:58.075715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:58.085709 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.085990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.086276 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.087078 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m12:43:58.086612 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m12:43:58.086855 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m12:43:58.086443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.087975 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"
[0m12:43:58.087499 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "re"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m12:43:58.087760 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "re"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m12:43:58.087259 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "re"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m12:43:58.088165 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select broker_id as from_field
    from "re"."public"."fact_all_apartment"
    where broker_id is not null
),

parent as (
    select broker_id as to_field
    from "re"."public"."dim_broker"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:58.089490 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.089773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.089960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.091286 [debug] [Thread-1 (]: Timing info for test.real_estate.not_null_dim_broker_broker_id.b2317a90a1 (execute): 12:43:58.068623 => 12:43:58.091174
[0m12:43:58.091507 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.092158 [debug] [Thread-3 (]: Timing info for test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3 (execute): 12:43:58.072054 => 12:43:58.092073
[0m12:43:58.092872 [debug] [Thread-2 (]: Timing info for test.real_estate.not_null_dim_post_post_id.5d776b2d46 (execute): 12:43:58.060592 => 12:43:58.092786
[0m12:43:58.093119 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m12:43:58.093869 [debug] [Thread-4 (]: Timing info for test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da (execute): 12:43:58.070588 => 12:43:58.093770
[0m12:43:58.094094 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m12:43:58.094315 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m12:43:58.094694 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: ROLLBACK
[0m12:43:58.095419 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m12:43:58.095785 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m12:43:58.095960 [debug] [Thread-4 (]: On test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da: Close
[0m12:43:58.096151 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m12:43:58.096686 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_broker_broker_id ...................................... [[32mPASS[0m in 0.06s]
[0m12:43:58.097417 [info ] [Thread-3 (]: 3 of 9 PASS not_null_dim_project_project_id .................................... [[32mPASS[0m in 0.06s]
[0m12:43:58.098413 [info ] [Thread-4 (]: 4 of 9 PASS relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_  [[32mPASS[0m in 0.06s]
[0m12:43:58.098996 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_post_post_id .......................................... [[32mPASS[0m in 0.06s]
[0m12:43:58.099441 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m12:43:58.099870 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m12:43:58.100163 [debug] [Thread-4 (]: Finished running node test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da
[0m12:43:58.100720 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m12:43:58.101035 [debug] [Thread-1 (]: Began running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m12:43:58.101349 [debug] [Thread-3 (]: Began running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m12:43:58.101640 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m12:43:58.101908 [debug] [Thread-2 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m12:43:58.102153 [info ] [Thread-1 (]: 5 of 9 START test relationships_fact_all_apartment_post_id__post_id__ref_dim_post_  [RUN]
[0m12:43:58.102495 [info ] [Thread-3 (]: 6 of 9 START test relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [RUN]
[0m12:43:58.104201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1)
[0m12:43:58.103238 [info ] [Thread-2 (]: 8 of 9 START test unique_dim_post_post_id ...................................... [RUN]
[0m12:43:58.103770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1)
[0m12:43:58.102851 [info ] [Thread-4 (]: 7 of 9 START test unique_dim_broker_broker_id .................................. [RUN]
[0m12:43:58.105411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_broker_id__broker_id__ref_dim_broker_.8e22cc27da, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m12:43:58.104814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m12:43:58.105065 [debug] [Thread-1 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m12:43:58.104416 [debug] [Thread-3 (]: Began compiling node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m12:43:58.105646 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m12:43:58.105861 [debug] [Thread-2 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m12:43:58.109149 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m12:43:58.111890 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m12:43:58.115234 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m12:43:58.117295 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m12:43:58.118632 [debug] [Thread-1 (]: Timing info for test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1 (compile): 12:43:58.106029 => 12:43:58.118488
[0m12:43:58.118881 [debug] [Thread-3 (]: Timing info for test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1 (compile): 12:43:58.109361 => 12:43:58.118790
[0m12:43:58.119097 [debug] [Thread-1 (]: Began executing node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m12:43:58.119442 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_post_post_id.91979bbf4d (compile): 12:43:58.115476 => 12:43:58.119328
[0m12:43:58.119629 [debug] [Thread-3 (]: Began executing node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m12:43:58.119834 [debug] [Thread-4 (]: Timing info for test.real_estate.unique_dim_broker_broker_id.4fb11e03af (compile): 12:43:58.112078 => 12:43:58.119745
[0m12:43:58.121088 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m12:43:58.121321 [debug] [Thread-2 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m12:43:58.122477 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m12:43:58.122738 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m12:43:58.123865 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m12:43:58.125930 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m12:43:58.126348 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m12:43:58.127056 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: BEGIN
[0m12:43:58.127418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:58.127262 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m12:43:58.127885 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: BEGIN
[0m12:43:58.128134 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m12:43:58.128337 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m12:43:58.128531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:58.128780 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m12:43:58.129063 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m12:43:58.129577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:58.130067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:58.138866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.139231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.139496 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"
[0m12:43:58.139878 [debug] [Thread-1 (]: Using postgres connection "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"
[0m12:43:58.140278 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select project_id as from_field
    from "re"."public"."fact_all_apartment"
    where project_id is not null
),

parent as (
    select project_id as to_field
    from "re"."public"."dim_project"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:58.140656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.140873 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.141072 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select post_id as from_field
    from "re"."public"."fact_all_apartment"
    where post_id is not null
),

parent as (
    select post_id as to_field
    from "re"."public"."dim_post"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:58.141417 [debug] [Thread-2 (]: Using postgres connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m12:43:58.141721 [debug] [Thread-4 (]: Using postgres connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m12:43:58.142136 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:58.142409 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:58.143209 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.144304 [debug] [Thread-3 (]: Timing info for test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1 (execute): 12:43:58.121509 => 12:43:58.144183
[0m12:43:58.144575 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.144850 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.145078 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: ROLLBACK
[0m12:43:58.145230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.146021 [debug] [Thread-4 (]: Timing info for test.real_estate.unique_dim_broker_broker_id.4fb11e03af (execute): 12:43:58.124176 => 12:43:58.145925
[0m12:43:58.146772 [debug] [Thread-1 (]: Timing info for test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1 (execute): 12:43:58.119997 => 12:43:58.146667
[0m12:43:58.147610 [debug] [Thread-2 (]: Timing info for test.real_estate.unique_dim_post_post_id.91979bbf4d (execute): 12:43:58.122969 => 12:43:58.147502
[0m12:43:58.147986 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m12:43:58.148225 [debug] [Thread-3 (]: On test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1: Close
[0m12:43:58.148565 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: ROLLBACK
[0m12:43:58.148814 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m12:43:58.149578 [info ] [Thread-3 (]: 6 of 9 PASS relationships_fact_all_apartment_project_id__project_id__ref_dim_project_  [[32mPASS[0m in 0.05s]
[0m12:43:58.150332 [debug] [Thread-3 (]: Finished running node test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1
[0m12:43:58.150542 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m12:43:58.150872 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m12:43:58.151215 [debug] [Thread-2 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m12:43:58.151530 [debug] [Thread-1 (]: On test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1: Close
[0m12:43:58.152037 [info ] [Thread-4 (]: 7 of 9 PASS unique_dim_broker_broker_id ........................................ [[32mPASS[0m in 0.05s]
[0m12:43:58.152445 [info ] [Thread-3 (]: 9 of 9 START test unique_dim_project_project_id ................................ [RUN]
[0m12:43:58.153365 [info ] [Thread-2 (]: 8 of 9 PASS unique_dim_post_post_id ............................................ [[32mPASS[0m in 0.05s]
[0m12:43:58.153959 [info ] [Thread-1 (]: 5 of 9 PASS relationships_fact_all_apartment_post_id__post_id__ref_dim_post_ ... [[32mPASS[0m in 0.05s]
[0m12:43:58.154345 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m12:43:58.154825 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.relationships_fact_all_apartment_project_id__project_id__ref_dim_project_.f50f612cf1, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m12:43:58.156187 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m12:43:58.155740 [debug] [Thread-1 (]: Finished running node test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1
[0m12:43:58.155298 [debug] [Thread-2 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m12:43:58.180816 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m12:43:58.181842 [debug] [Thread-3 (]: Timing info for test.real_estate.unique_dim_project_project_id.87b4f343a2 (compile): 12:43:58.156388 => 12:43:58.181734
[0m12:43:58.182029 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m12:43:58.183172 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m12:43:58.183756 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m12:43:58.183957 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m12:43:58.184124 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:58.192351 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.192678 [debug] [Thread-3 (]: Using postgres connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m12:43:58.193109 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "real_estate", "target_name": "dev", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "re"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:58.194636 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:58.195668 [debug] [Thread-3 (]: Timing info for test.real_estate.unique_dim_project_project_id.87b4f343a2 (execute): 12:43:58.182154 => 12:43:58.195537
[0m12:43:58.195885 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m12:43:58.196679 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m12:43:58.197267 [info ] [Thread-3 (]: 9 of 9 PASS unique_dim_project_project_id ...................................... [[32mPASS[0m in 0.04s]
[0m12:43:58.197659 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m12:43:58.198822 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.199110 [debug] [MainThread]: On master: BEGIN
[0m12:43:58.199287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:58.207760 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:58.208017 [debug] [MainThread]: On master: COMMIT
[0m12:43:58.208168 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:58.208305 [debug] [MainThread]: On master: COMMIT
[0m12:43:58.209054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:58.209355 [debug] [MainThread]: On master: Close
[0m12:43:58.209872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:58.210036 [debug] [MainThread]: Connection 'test.real_estate.relationships_fact_all_apartment_post_id__post_id__ref_dim_post_.959fcb54c1' was properly closed.
[0m12:43:58.210204 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m12:43:58.210342 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m12:43:58.210468 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m12:43:58.210700 [info ] [MainThread]: 
[0m12:43:58.210949 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:43:58.212005 [debug] [MainThread]: Command end result
[0m12:43:58.215842 [info ] [MainThread]: 
[0m12:43:58.216126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:43:58.216488 [info ] [MainThread]: 
[0m12:43:58.216755 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m12:43:58.217284 [debug] [MainThread]: Command `dbt test` succeeded at 12:43:58.217217 after 0.31 seconds
[0m12:43:58.217497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff865c0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ddbbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857fd4c0>]}
[0m12:43:58.217718 [debug] [MainThread]: Flushing usage events
[0m20:50:56.627058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e95590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef6090>]}


============================== 20:50:56.629905 | 9d1737ac-a3f5-4fba-98a4-efe66d46ef96 ==============================
[0m20:50:56.629905 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:50:56.630224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -f', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:56.756628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec5bd0>]}
[0m20:50:56.780997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b4310>]}
[0m20:50:56.781603 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:56.833946 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:50:56.878195 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:50:56.878542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108600d50>]}
[0m20:50:57.420502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae87090>]}
[0m20:50:57.456815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m20:50:57.459654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m20:50:57.471791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d6bad0>]}
[0m20:50:57.472061 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m20:50:57.472232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1737ac-a3f5-4fba-98a4-efe66d46ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad99a50>]}
[0m20:50:57.473136 [info ] [MainThread]: 
[0m20:50:57.473304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:57.473433 [info ] [MainThread]: 
[0m20:50:57.473651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:57.475418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m20:50:57.505024 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m20:50:57.505273 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m20:50:57.505412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:57.522867 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known

[0m20:50:57.524322 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m20:50:57.524470 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:50:57.524636 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:50:57.524758 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:50:57.524894 [debug] [ThreadPool]: On list_re: No close available on handle
[0m20:50:57.525224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:57.525350 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m20:50:57.525499 [info ] [MainThread]: 
[0m20:50:57.525653 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m20:50:57.525890 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known
  
[0m20:50:57.526940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.937552, "process_in_blocks": "0", "process_kernel_time": 0.220834, "process_mem_max_rss": "129171456", "process_out_blocks": "0", "process_user_time": 1.326279}
[0m20:50:57.527163 [debug] [MainThread]: Command `dbt run` failed at 20:50:57.527092 after 0.94 seconds
[0m20:50:57.527415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bfc090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeefcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef6310>]}
[0m20:50:57.527630 [debug] [MainThread]: Flushing usage events
[0m20:50:58.797022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:56.068943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109148f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9f50>]}


============================== 20:51:56.071876 | 5c917b57-756d-4bf9-b514-2329c4b74d27 ==============================
[0m20:51:56.071876 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:51:56.072199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -f', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:51:56.185114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918c3d0>]}
[0m20:51:56.209453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c82d0>]}
[0m20:51:56.210255 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:56.260576 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:51:56.304303 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:51:56.304629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63b50>]}
[0m20:51:56.841598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d9b1d0>]}
[0m20:51:56.877688 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m20:51:56.880429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m20:51:56.892464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a43d0>]}
[0m20:51:56.892735 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m20:51:56.892911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c917b57-756d-4bf9-b514-2329c4b74d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12f150>]}
[0m20:51:56.893819 [info ] [MainThread]: 
[0m20:51:56.893991 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:56.894120 [info ] [MainThread]: 
[0m20:51:56.894341 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:56.896192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m20:51:56.925994 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m20:51:56.926334 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m20:51:56.926510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:06.931739 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m20:52:16.936824 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m20:52:16.938009 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:52:16.939206 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m20:52:16.939752 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m20:52:16.940256 [debug] [ThreadPool]: On list_re: No close available on handle
[0m20:52:16.941371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:16.941658 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m20:52:16.941845 [info ] [MainThread]: 
[0m20:52:16.942041 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m20:52:16.942338 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  
[0m20:52:16.943719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.912838, "process_in_blocks": "0", "process_kernel_time": 0.205082, "process_mem_max_rss": "129318912", "process_out_blocks": "0", "process_user_time": 1.331182}
[0m20:52:16.943951 [debug] [MainThread]: Command `dbt run` failed at 20:52:16.943907 after 20.91 seconds
[0m20:52:16.944169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e08050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976cad0>]}
[0m20:52:16.944390 [debug] [MainThread]: Flushing usage events
[0m20:52:17.986157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:25.507058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105471b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ecf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ed590>]}


============================== 20:52:25.509222 | 0d32be66-8c4e-4343-b49d-e56b72fd9f52 ==============================
[0m20:52:25.509222 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:52:25.509541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:25.516519 [info ] [MainThread]: dbt version: 1.9.2
[0m20:52:25.516776 [info ] [MainThread]: python version: 3.11.10
[0m20:52:25.516966 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:52:25.517108 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:52:25.547214 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:52:25.547531 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:52:25.547682 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:52:25.547960 [info ] [MainThread]: adapter type: postgres
[0m20:52:25.548092 [info ] [MainThread]: adapter version: 1.9.0
[0m20:52:25.589058 [info ] [MainThread]: Configuration:
[0m20:52:25.589378 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:52:25.589520 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:52:25.589654 [info ] [MainThread]: Required dependencies:
[0m20:52:25.589840 [debug] [MainThread]: Executing "git --help"
[0m20:52:25.614959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:52:25.615581 [debug] [MainThread]: STDERR: "b''"
[0m20:52:25.615772 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:52:25.615945 [info ] [MainThread]: Connection:
[0m20:52:25.616129 [info ] [MainThread]:   host: 172.19.0.3
[0m20:52:25.616252 [info ] [MainThread]:   port: 5432
[0m20:52:25.616378 [info ] [MainThread]:   user: airflow
[0m20:52:25.616493 [info ] [MainThread]:   database: re
[0m20:52:25.616606 [info ] [MainThread]:   schema: public
[0m20:52:25.616722 [info ] [MainThread]:   connect_timeout: 10
[0m20:52:25.616838 [info ] [MainThread]:   role: None
[0m20:52:25.616960 [info ] [MainThread]:   search_path: None
[0m20:52:25.617072 [info ] [MainThread]:   keepalives_idle: 0
[0m20:52:25.617188 [info ] [MainThread]:   sslmode: None
[0m20:52:25.617300 [info ] [MainThread]:   sslcert: None
[0m20:52:25.617410 [info ] [MainThread]:   sslkey: None
[0m20:52:25.617524 [info ] [MainThread]:   sslrootcert: None
[0m20:52:25.617634 [info ] [MainThread]:   application_name: dbt
[0m20:52:25.617745 [info ] [MainThread]:   retries: 1
[0m20:52:25.618061 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:52:25.660384 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:52:25.682217 [debug] [MainThread]: Using postgres connection "debug"
[0m20:52:25.682463 [debug] [MainThread]: On debug: select 1 as id
[0m20:52:25.682609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:35.685740 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m20:52:45.690891 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:52:45.694474 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:52:45.695248 [debug] [MainThread]: On debug: No close available on handle
[0m20:52:45.695868 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:52:45.696383 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:52:45.696778 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:52:45.700468 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.226213, "process_in_blocks": "0", "process_kernel_time": 0.160846, "process_mem_max_rss": "116752384", "process_out_blocks": "0", "process_user_time": 0.692085}
[0m20:52:45.701136 [debug] [MainThread]: Command `dbt debug` failed at 20:52:45.700982 after 20.23 seconds
[0m20:52:45.701622 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:52:45.702119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101123f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ed1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ed890>]}
[0m20:52:45.702743 [debug] [MainThread]: Flushing usage events
[0m20:52:46.924551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:54.541626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b796ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b811710>]}


============================== 20:53:54.544627 | 1e370943-1c97-47e2-9841-c6a72447639a ==============================
[0m20:53:54.544627 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:53:54.544985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:53:54.556228 [info ] [MainThread]: dbt version: 1.9.2
[0m20:53:54.556512 [info ] [MainThread]: python version: 3.11.10
[0m20:53:54.556675 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:53:54.556814 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:53:54.601388 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:53:54.601719 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:53:54.601866 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:53:54.602319 [info ] [MainThread]: adapter type: postgres
[0m20:53:54.602502 [info ] [MainThread]: adapter version: 1.9.0
[0m20:53:54.644082 [info ] [MainThread]: Configuration:
[0m20:53:54.644391 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:53:54.644535 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:53:54.644658 [info ] [MainThread]: Required dependencies:
[0m20:53:54.644853 [debug] [MainThread]: Executing "git --help"
[0m20:53:54.667585 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:53:54.668190 [debug] [MainThread]: STDERR: "b''"
[0m20:53:54.668383 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:53:54.668553 [info ] [MainThread]: Connection:
[0m20:53:54.668733 [info ] [MainThread]:   host: 172.19.0.3
[0m20:53:54.668856 [info ] [MainThread]:   port: 5432
[0m20:53:54.668972 [info ] [MainThread]:   user: airflow
[0m20:53:54.669088 [info ] [MainThread]:   database: airflow
[0m20:53:54.669210 [info ] [MainThread]:   schema: public
[0m20:53:54.669333 [info ] [MainThread]:   connect_timeout: 10
[0m20:53:54.669446 [info ] [MainThread]:   role: None
[0m20:53:54.669565 [info ] [MainThread]:   search_path: None
[0m20:53:54.669679 [info ] [MainThread]:   keepalives_idle: 0
[0m20:53:54.669802 [info ] [MainThread]:   sslmode: None
[0m20:53:54.669910 [info ] [MainThread]:   sslcert: None
[0m20:53:54.670019 [info ] [MainThread]:   sslkey: None
[0m20:53:54.670132 [info ] [MainThread]:   sslrootcert: None
[0m20:53:54.670252 [info ] [MainThread]:   application_name: dbt
[0m20:53:54.670368 [info ] [MainThread]:   retries: 1
[0m20:53:54.670681 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:53:54.716122 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:53:54.740961 [debug] [MainThread]: Using postgres connection "debug"
[0m20:53:54.741172 [debug] [MainThread]: On debug: select 1 as id
[0m20:53:54.741314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:04.745508 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m20:54:14.749461 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:54:14.751243 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:54:14.752034 [debug] [MainThread]: On debug: No close available on handle
[0m20:54:14.752622 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:54:14.753119 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:54:14.753521 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:54:14.758674 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.252808, "process_in_blocks": "0", "process_kernel_time": 0.199537, "process_mem_max_rss": "116523008", "process_out_blocks": "0", "process_user_time": 0.707339}
[0m20:54:14.759611 [debug] [MainThread]: Command `dbt debug` failed at 20:54:14.759303 after 20.25 seconds
[0m20:54:14.760310 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:54:14.760812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7e6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be15d10>]}
[0m20:54:14.761393 [debug] [MainThread]: Flushing usage events
[0m20:54:15.967598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:35.772072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109396010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109410c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e6cd0>]}


============================== 20:54:35.774151 | 1af95e2a-51ba-4a85-8119-b234bdf83206 ==============================
[0m20:54:35.774151 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:54:35.774468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:54:35.779580 [info ] [MainThread]: dbt version: 1.9.2
[0m20:54:35.779781 [info ] [MainThread]: python version: 3.11.10
[0m20:54:35.779951 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:54:35.780147 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:54:35.809407 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:54:35.809836 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:54:35.810021 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:54:35.810373 [info ] [MainThread]: adapter type: postgres
[0m20:54:35.810535 [info ] [MainThread]: adapter version: 1.9.0
[0m20:54:35.851657 [info ] [MainThread]: Configuration:
[0m20:54:35.851983 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:54:35.852126 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:54:35.852264 [info ] [MainThread]: Required dependencies:
[0m20:54:35.852469 [debug] [MainThread]: Executing "git --help"
[0m20:54:35.875112 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:54:35.875814 [debug] [MainThread]: STDERR: "b''"
[0m20:54:35.876077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:54:35.876267 [info ] [MainThread]: Connection:
[0m20:54:35.876549 [info ] [MainThread]:   host: postgres
[0m20:54:35.876698 [info ] [MainThread]:   port: 5432
[0m20:54:35.876831 [info ] [MainThread]:   user: airflow
[0m20:54:35.876950 [info ] [MainThread]:   database: airflow
[0m20:54:35.877069 [info ] [MainThread]:   schema: public
[0m20:54:35.877184 [info ] [MainThread]:   connect_timeout: 10
[0m20:54:35.877303 [info ] [MainThread]:   role: None
[0m20:54:35.877420 [info ] [MainThread]:   search_path: None
[0m20:54:35.877533 [info ] [MainThread]:   keepalives_idle: 0
[0m20:54:35.877648 [info ] [MainThread]:   sslmode: None
[0m20:54:35.877765 [info ] [MainThread]:   sslcert: None
[0m20:54:35.877877 [info ] [MainThread]:   sslkey: None
[0m20:54:35.877994 [info ] [MainThread]:   sslrootcert: None
[0m20:54:35.878107 [info ] [MainThread]:   application_name: dbt
[0m20:54:35.878219 [info ] [MainThread]:   retries: 1
[0m20:54:35.878554 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:35.920296 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:54:35.941746 [debug] [MainThread]: Using postgres connection "debug"
[0m20:54:35.941969 [debug] [MainThread]: On debug: select 1 as id
[0m20:54:35.942105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:35.954183 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:54:35.956459 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:54:35.956602 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:54:35.956749 [debug] [MainThread]: On debug: No close available on handle
[0m20:54:35.956913 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:54:35.957074 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:54:35.957217 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:54:35.958135 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22046359, "process_in_blocks": "0", "process_kernel_time": 0.153328, "process_mem_max_rss": "116965376", "process_out_blocks": "0", "process_user_time": 0.680284}
[0m20:54:35.958348 [debug] [MainThread]: Command `dbt debug` failed at 20:54:35.958299 after 0.22 seconds
[0m20:54:35.958517 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:54:35.958688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4d090>]}
[0m20:54:35.958887 [debug] [MainThread]: Flushing usage events
[0m20:54:36.997863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:44.296201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106711090>]}


============================== 20:54:44.298388 | 52faa32a-c2e2-4009-bd9f-7c8d99c9da65 ==============================
[0m20:54:44.298388 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:54:44.298709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:54:44.303695 [info ] [MainThread]: dbt version: 1.9.2
[0m20:54:44.303890 [info ] [MainThread]: python version: 3.11.10
[0m20:54:44.304092 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:54:44.304309 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:54:44.332847 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:54:44.333168 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:54:44.333311 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:54:44.333560 [info ] [MainThread]: adapter type: postgres
[0m20:54:44.333689 [info ] [MainThread]: adapter version: 1.9.0
[0m20:54:44.374916 [info ] [MainThread]: Configuration:
[0m20:54:44.375250 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:54:44.375443 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:54:44.375780 [info ] [MainThread]: Required dependencies:
[0m20:54:44.376029 [debug] [MainThread]: Executing "git --help"
[0m20:54:44.396300 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:54:44.396964 [debug] [MainThread]: STDERR: "b''"
[0m20:54:44.397151 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:54:44.397320 [info ] [MainThread]: Connection:
[0m20:54:44.397554 [info ] [MainThread]:   host: postgres
[0m20:54:44.397677 [info ] [MainThread]:   port: 5432
[0m20:54:44.397798 [info ] [MainThread]:   user: airflow
[0m20:54:44.397912 [info ] [MainThread]:   database: airflow
[0m20:54:44.398029 [info ] [MainThread]:   schema: public
[0m20:54:44.398148 [info ] [MainThread]:   connect_timeout: 10
[0m20:54:44.398260 [info ] [MainThread]:   role: None
[0m20:54:44.398373 [info ] [MainThread]:   search_path: None
[0m20:54:44.398481 [info ] [MainThread]:   keepalives_idle: 0
[0m20:54:44.398590 [info ] [MainThread]:   sslmode: None
[0m20:54:44.398697 [info ] [MainThread]:   sslcert: None
[0m20:54:44.398802 [info ] [MainThread]:   sslkey: None
[0m20:54:44.398913 [info ] [MainThread]:   sslrootcert: None
[0m20:54:44.399020 [info ] [MainThread]:   application_name: dbt
[0m20:54:44.399133 [info ] [MainThread]:   retries: 1
[0m20:54:44.399471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:44.441308 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:54:44.458426 [debug] [MainThread]: Using postgres connection "debug"
[0m20:54:44.458649 [debug] [MainThread]: On debug: select 1 as id
[0m20:54:44.458797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:44.461989 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:54:44.464242 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:54:44.464384 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:54:44.464536 [debug] [MainThread]: On debug: No close available on handle
[0m20:54:44.464710 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:54:44.464864 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:54:44.465003 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:54:44.465972 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2028863, "process_in_blocks": "0", "process_kernel_time": 0.143372, "process_mem_max_rss": "116621312", "process_out_blocks": "0", "process_user_time": 0.697505}
[0m20:54:44.466179 [debug] [MainThread]: Command `dbt debug` failed at 20:54:44.466135 after 0.20 seconds
[0m20:54:44.466348 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:54:44.466513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ddbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106710f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107451990>]}
[0m20:54:44.466734 [debug] [MainThread]: Flushing usage events
[0m20:54:45.520671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:55.692459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109051610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ccf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cd610>]}


============================== 20:54:55.694605 | e2057409-5082-4366-9844-4d115b4a4a59 ==============================
[0m20:54:55.694605 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:54:55.694931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:54:55.699892 [info ] [MainThread]: dbt version: 1.9.2
[0m20:54:55.700095 [info ] [MainThread]: python version: 3.11.10
[0m20:54:55.700323 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:54:55.700619 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:54:55.729697 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:54:55.730039 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:54:55.730198 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:54:55.730453 [info ] [MainThread]: adapter type: postgres
[0m20:54:55.730585 [info ] [MainThread]: adapter version: 1.9.0
[0m20:54:55.772274 [info ] [MainThread]: Configuration:
[0m20:54:55.772594 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:54:55.772737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:54:55.772863 [info ] [MainThread]: Required dependencies:
[0m20:54:55.773054 [debug] [MainThread]: Executing "git --help"
[0m20:54:55.793382 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:54:55.794004 [debug] [MainThread]: STDERR: "b''"
[0m20:54:55.794231 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:54:55.794411 [info ] [MainThread]: Connection:
[0m20:54:55.794610 [info ] [MainThread]:   host: postgres
[0m20:54:55.794732 [info ] [MainThread]:   port: 5432
[0m20:54:55.794855 [info ] [MainThread]:   user: airflow
[0m20:54:55.794970 [info ] [MainThread]:   database: re
[0m20:54:55.795081 [info ] [MainThread]:   schema: public
[0m20:54:55.795194 [info ] [MainThread]:   connect_timeout: 10
[0m20:54:55.795306 [info ] [MainThread]:   role: None
[0m20:54:55.795424 [info ] [MainThread]:   search_path: None
[0m20:54:55.795537 [info ] [MainThread]:   keepalives_idle: 0
[0m20:54:55.795644 [info ] [MainThread]:   sslmode: None
[0m20:54:55.795754 [info ] [MainThread]:   sslcert: None
[0m20:54:55.795867 [info ] [MainThread]:   sslkey: None
[0m20:54:55.795976 [info ] [MainThread]:   sslrootcert: None
[0m20:54:55.796086 [info ] [MainThread]:   application_name: dbt
[0m20:54:55.796196 [info ] [MainThread]:   retries: 1
[0m20:54:55.796518 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:55.837989 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:54:55.854948 [debug] [MainThread]: Using postgres connection "debug"
[0m20:54:55.855157 [debug] [MainThread]: On debug: select 1 as id
[0m20:54:55.855302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:55.858428 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:54:55.860574 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:54:55.860703 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:54:55.860840 [debug] [MainThread]: On debug: No close available on handle
[0m20:54:55.860990 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:54:55.861143 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:54:55.861277 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:54:55.862172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20324008, "process_in_blocks": "0", "process_kernel_time": 0.137317, "process_mem_max_rss": "116817920", "process_out_blocks": "0", "process_user_time": 0.682946}
[0m20:54:55.862379 [debug] [MainThread]: Command `dbt debug` failed at 20:54:55.862328 after 0.20 seconds
[0m20:54:55.862546 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:54:55.862713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d03f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e64ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976de90>]}
[0m20:54:55.862907 [debug] [MainThread]: Flushing usage events
[0m20:54:56.973736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:58.511506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d97050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de6cd0>]}


============================== 20:54:58.513550 | e117a988-d0de-4a2f-8dd5-486582f9999b ==============================
[0m20:54:58.513550 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:54:58.513865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:54:58.518772 [info ] [MainThread]: dbt version: 1.9.2
[0m20:54:58.518973 [info ] [MainThread]: python version: 3.11.10
[0m20:54:58.519134 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:54:58.519272 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:54:58.548321 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:54:58.548638 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:54:58.548785 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:54:58.549015 [info ] [MainThread]: adapter type: postgres
[0m20:54:58.549146 [info ] [MainThread]: adapter version: 1.9.0
[0m20:54:58.590182 [info ] [MainThread]: Configuration:
[0m20:54:58.590492 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:54:58.590636 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:54:58.590762 [info ] [MainThread]: Required dependencies:
[0m20:54:58.590952 [debug] [MainThread]: Executing "git --help"
[0m20:54:58.611123 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:54:58.611693 [debug] [MainThread]: STDERR: "b''"
[0m20:54:58.611884 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:54:58.612050 [info ] [MainThread]: Connection:
[0m20:54:58.612238 [info ] [MainThread]:   host: postgres
[0m20:54:58.612359 [info ] [MainThread]:   port: 5432
[0m20:54:58.612475 [info ] [MainThread]:   user: airflow
[0m20:54:58.612586 [info ] [MainThread]:   database: re
[0m20:54:58.612703 [info ] [MainThread]:   schema: public
[0m20:54:58.612817 [info ] [MainThread]:   connect_timeout: 10
[0m20:54:58.612929 [info ] [MainThread]:   role: None
[0m20:54:58.613042 [info ] [MainThread]:   search_path: None
[0m20:54:58.613151 [info ] [MainThread]:   keepalives_idle: 0
[0m20:54:58.613260 [info ] [MainThread]:   sslmode: None
[0m20:54:58.613370 [info ] [MainThread]:   sslcert: None
[0m20:54:58.613477 [info ] [MainThread]:   sslkey: None
[0m20:54:58.613589 [info ] [MainThread]:   sslrootcert: None
[0m20:54:58.613697 [info ] [MainThread]:   application_name: dbt
[0m20:54:58.613813 [info ] [MainThread]:   retries: 1
[0m20:54:58.614120 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:54:58.654766 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:54:58.671356 [debug] [MainThread]: Using postgres connection "debug"
[0m20:54:58.671577 [debug] [MainThread]: On debug: select 1 as id
[0m20:54:58.671720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:58.674938 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:54:58.677003 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:54:58.677148 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:54:58.677291 [debug] [MainThread]: On debug: No close available on handle
[0m20:54:58.677445 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:54:58.677603 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:54:58.677743 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:54:58.678626 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.19975129, "process_in_blocks": "0", "process_kernel_time": 0.138297, "process_mem_max_rss": "117243904", "process_out_blocks": "0", "process_user_time": 0.681341}
[0m20:54:58.678833 [debug] [MainThread]: Command `dbt debug` failed at 20:54:58.678787 after 0.20 seconds
[0m20:54:58.679004 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:54:58.679182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10068bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc8e10>]}
[0m20:54:58.679386 [debug] [MainThread]: Flushing usage events
[0m20:54:59.731904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:20.131033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113496c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135114d0>]}


============================== 20:55:20.133509 | 8deb6fe1-18f9-4796-8ead-3b2047c685c9 ==============================
[0m20:55:20.133509 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:55:20.133840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:20.139902 [info ] [MainThread]: dbt version: 1.9.2
[0m20:55:20.140128 [info ] [MainThread]: python version: 3.11.10
[0m20:55:20.140424 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:55:20.140670 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:55:20.171691 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:55:20.172031 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:55:20.172174 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:55:20.172449 [info ] [MainThread]: adapter type: postgres
[0m20:55:20.172577 [info ] [MainThread]: adapter version: 1.9.0
[0m20:55:20.214645 [info ] [MainThread]: Configuration:
[0m20:55:20.214961 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:55:20.215113 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:55:20.215244 [info ] [MainThread]: Required dependencies:
[0m20:55:20.215424 [debug] [MainThread]: Executing "git --help"
[0m20:55:20.235675 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:55:20.236291 [debug] [MainThread]: STDERR: "b''"
[0m20:55:20.236490 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:55:20.236652 [info ] [MainThread]: Connection:
[0m20:55:20.236831 [info ] [MainThread]:   host: host.docker.internal
[0m20:55:20.236952 [info ] [MainThread]:   port: 5432
[0m20:55:20.237067 [info ] [MainThread]:   user: airflow
[0m20:55:20.237180 [info ] [MainThread]:   database: re
[0m20:55:20.237293 [info ] [MainThread]:   schema: public
[0m20:55:20.237401 [info ] [MainThread]:   connect_timeout: 10
[0m20:55:20.237514 [info ] [MainThread]:   role: None
[0m20:55:20.237626 [info ] [MainThread]:   search_path: None
[0m20:55:20.237738 [info ] [MainThread]:   keepalives_idle: 0
[0m20:55:20.237848 [info ] [MainThread]:   sslmode: None
[0m20:55:20.237957 [info ] [MainThread]:   sslcert: None
[0m20:55:20.238069 [info ] [MainThread]:   sslkey: None
[0m20:55:20.238179 [info ] [MainThread]:   sslrootcert: None
[0m20:55:20.238292 [info ] [MainThread]:   application_name: dbt
[0m20:55:20.238401 [info ] [MainThread]:   retries: 1
[0m20:55:20.238705 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:55:20.280564 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:55:20.301851 [debug] [MainThread]: Using postgres connection "debug"
[0m20:55:20.302063 [debug] [MainThread]: On debug: select 1 as id
[0m20:55:20.302204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:20.304290 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known

[0m20:55:20.305256 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:55:20.305397 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:55:20.305536 [debug] [MainThread]: On debug: No close available on handle
[0m20:55:20.305686 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:55:20.305841 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:55:20.305983 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "host.docker.internal" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:55:20.306912 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.21215308, "process_in_blocks": "0", "process_kernel_time": 0.158189, "process_mem_max_rss": "118505472", "process_out_blocks": "0", "process_user_time": 0.692776}
[0m20:55:20.307135 [debug] [MainThread]: Command `dbt debug` failed at 20:55:20.307090 after 0.21 seconds
[0m20:55:20.307303 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:55:20.307472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ea3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113496150>]}
[0m20:55:20.307673 [debug] [MainThread]: Flushing usage events
[0m20:55:21.444851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:53.714272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108691390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108690cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870d7d0>]}


============================== 20:55:53.716481 | dcea307c-de7c-44ce-843c-32f41af73122 ==============================
[0m20:55:53.716481 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:55:53.716799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:55:53.722025 [info ] [MainThread]: dbt version: 1.9.2
[0m20:55:53.722227 [info ] [MainThread]: python version: 3.11.10
[0m20:55:53.722392 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:55:53.722530 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:55:53.752062 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:55:53.752342 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:55:53.752480 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:55:53.752707 [info ] [MainThread]: adapter type: postgres
[0m20:55:53.752839 [info ] [MainThread]: adapter version: 1.9.0
[0m20:55:53.794826 [info ] [MainThread]: Configuration:
[0m20:55:53.795163 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:55:53.795310 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:55:53.795440 [info ] [MainThread]: Required dependencies:
[0m20:55:53.795631 [debug] [MainThread]: Executing "git --help"
[0m20:55:53.817550 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:55:53.818223 [debug] [MainThread]: STDERR: "b''"
[0m20:55:53.818407 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:55:53.818572 [info ] [MainThread]: Connection:
[0m20:55:53.818768 [info ] [MainThread]:   host: postgres
[0m20:55:53.818889 [info ] [MainThread]:   port: 5432
[0m20:55:53.819006 [info ] [MainThread]:   user: airflow
[0m20:55:53.819124 [info ] [MainThread]:   database: re
[0m20:55:53.819239 [info ] [MainThread]:   schema: public
[0m20:55:53.819365 [info ] [MainThread]:   connect_timeout: 10
[0m20:55:53.819490 [info ] [MainThread]:   role: None
[0m20:55:53.819612 [info ] [MainThread]:   search_path: None
[0m20:55:53.819728 [info ] [MainThread]:   keepalives_idle: 0
[0m20:55:53.819845 [info ] [MainThread]:   sslmode: None
[0m20:55:53.819961 [info ] [MainThread]:   sslcert: None
[0m20:55:53.820069 [info ] [MainThread]:   sslkey: None
[0m20:55:53.820192 [info ] [MainThread]:   sslrootcert: None
[0m20:55:53.820305 [info ] [MainThread]:   application_name: dbt
[0m20:55:53.820414 [info ] [MainThread]:   retries: 1
[0m20:55:53.820765 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:55:53.861224 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:55:53.882904 [debug] [MainThread]: Using postgres connection "debug"
[0m20:55:53.883147 [debug] [MainThread]: On debug: select 1 as id
[0m20:55:53.883294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:53.886854 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:55:53.889161 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:55:53.889311 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:55:53.889460 [debug] [MainThread]: On debug: No close available on handle
[0m20:55:53.889649 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:55:53.889811 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:55:53.889953 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:55:53.890893 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20994116, "process_in_blocks": "0", "process_kernel_time": 0.150895, "process_mem_max_rss": "116523008", "process_out_blocks": "0", "process_user_time": 0.684259}
[0m20:55:53.891120 [debug] [MainThread]: Command `dbt debug` failed at 20:55:53.891065 after 0.21 seconds
[0m20:55:53.891293 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:55:53.891475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104343f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daa090>]}
[0m20:55:53.891688 [debug] [MainThread]: Flushing usage events
[0m20:55:54.933196 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:35.890390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106194710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106196650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f5950>]}


============================== 20:56:35.892551 | 8374b4b3-2794-4436-944c-daf5f9ea48d6 ==============================
[0m20:56:35.892551 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:56:35.892877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:56:35.898053 [info ] [MainThread]: dbt version: 1.9.2
[0m20:56:35.898255 [info ] [MainThread]: python version: 3.11.10
[0m20:56:35.898482 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:56:35.898771 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:56:35.928228 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:56:35.928549 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:56:35.928696 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:56:35.928939 [info ] [MainThread]: adapter type: postgres
[0m20:56:35.929069 [info ] [MainThread]: adapter version: 1.9.0
[0m20:56:35.970531 [info ] [MainThread]: Configuration:
[0m20:56:35.970852 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:56:35.970995 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:56:35.971121 [info ] [MainThread]: Required dependencies:
[0m20:56:35.971303 [debug] [MainThread]: Executing "git --help"
[0m20:56:35.991522 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:56:35.992211 [debug] [MainThread]: STDERR: "b''"
[0m20:56:35.992524 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:56:35.992787 [info ] [MainThread]: Connection:
[0m20:56:35.993032 [info ] [MainThread]:   host: postgres
[0m20:56:35.993178 [info ] [MainThread]:   port: 5432
[0m20:56:35.993301 [info ] [MainThread]:   user: airflow
[0m20:56:35.993417 [info ] [MainThread]:   database: re
[0m20:56:35.993529 [info ] [MainThread]:   schema: public
[0m20:56:35.993642 [info ] [MainThread]:   connect_timeout: 10
[0m20:56:35.993780 [info ] [MainThread]:   role: None
[0m20:56:35.993893 [info ] [MainThread]:   search_path: None
[0m20:56:35.994002 [info ] [MainThread]:   keepalives_idle: 0
[0m20:56:35.994113 [info ] [MainThread]:   sslmode: None
[0m20:56:35.994221 [info ] [MainThread]:   sslcert: None
[0m20:56:35.994327 [info ] [MainThread]:   sslkey: None
[0m20:56:35.994438 [info ] [MainThread]:   sslrootcert: None
[0m20:56:35.994549 [info ] [MainThread]:   application_name: dbt
[0m20:56:35.994658 [info ] [MainThread]:   retries: 1
[0m20:56:35.994961 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:36.055376 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:56:36.077014 [debug] [MainThread]: Using postgres connection "debug"
[0m20:56:36.077222 [debug] [MainThread]: On debug: select 1 as id
[0m20:56:36.077365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:36.080499 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:56:36.082651 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:56:36.082779 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:56:36.082914 [debug] [MainThread]: On debug: No close available on handle
[0m20:56:36.083073 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:56:36.083220 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:56:36.083355 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:56:36.084239 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.22659221, "process_in_blocks": "0", "process_kernel_time": 0.159846, "process_mem_max_rss": "116867072", "process_out_blocks": "0", "process_user_time": 0.687518}
[0m20:56:36.084445 [debug] [MainThread]: Command `dbt debug` failed at 20:56:36.084400 after 0.23 seconds
[0m20:56:36.084609 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:56:36.084772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100aeff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e6d50>]}
[0m20:56:36.084968 [debug] [MainThread]: Flushing usage events
[0m20:56:37.325131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:07.656605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ad4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a28e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a294d0>]}


============================== 20:57:07.659817 | ef15009a-528c-468e-99fe-8703a27787be ==============================
[0m20:57:07.659817 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:57:07.660207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:57:07.671619 [info ] [MainThread]: dbt version: 1.9.2
[0m20:57:07.671943 [info ] [MainThread]: python version: 3.11.10
[0m20:57:07.672125 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:57:07.672268 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:57:07.718996 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:57:07.719342 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:57:07.719499 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:57:07.719976 [info ] [MainThread]: adapter type: postgres
[0m20:57:07.720114 [info ] [MainThread]: adapter version: 1.9.0
[0m20:57:07.762562 [info ] [MainThread]: Configuration:
[0m20:57:07.762926 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:57:07.763121 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:57:07.763260 [info ] [MainThread]: Required dependencies:
[0m20:57:07.763467 [debug] [MainThread]: Executing "git --help"
[0m20:57:07.788473 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:57:07.789044 [debug] [MainThread]: STDERR: "b''"
[0m20:57:07.789244 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:57:07.789415 [info ] [MainThread]: Connection:
[0m20:57:07.789600 [info ] [MainThread]:   host: postgres
[0m20:57:07.789725 [info ] [MainThread]:   port: 5432
[0m20:57:07.789842 [info ] [MainThread]:   user: airflow
[0m20:57:07.789959 [info ] [MainThread]:   database: re
[0m20:57:07.790073 [info ] [MainThread]:   schema: public
[0m20:57:07.790186 [info ] [MainThread]:   connect_timeout: 10
[0m20:57:07.790303 [info ] [MainThread]:   role: None
[0m20:57:07.790418 [info ] [MainThread]:   search_path: None
[0m20:57:07.790531 [info ] [MainThread]:   keepalives_idle: 0
[0m20:57:07.790645 [info ] [MainThread]:   sslmode: None
[0m20:57:07.790757 [info ] [MainThread]:   sslcert: None
[0m20:57:07.790868 [info ] [MainThread]:   sslkey: None
[0m20:57:07.790981 [info ] [MainThread]:   sslrootcert: None
[0m20:57:07.791092 [info ] [MainThread]:   application_name: dbt
[0m20:57:07.791275 [info ] [MainThread]:   retries: 1
[0m20:57:07.791747 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:57:07.837182 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:57:07.865047 [debug] [MainThread]: Using postgres connection "debug"
[0m20:57:07.865325 [debug] [MainThread]: On debug: select 1 as id
[0m20:57:07.865483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:07.869381 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m20:57:07.871379 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:57:07.871557 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:57:07.871719 [debug] [MainThread]: On debug: No close available on handle
[0m20:57:07.871888 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:57:07.872050 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:57:07.872184 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:57:07.873427 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.25620025, "process_in_blocks": "0", "process_kernel_time": 0.192379, "process_mem_max_rss": "116293632", "process_out_blocks": "0", "process_user_time": 0.710949}
[0m20:57:07.873668 [debug] [MainThread]: Command `dbt debug` failed at 20:57:07.873615 after 0.26 seconds
[0m20:57:07.873858 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:57:07.874053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a29590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10065ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a046d0>]}
[0m20:57:07.874266 [debug] [MainThread]: Flushing usage events
[0m20:57:08.964416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:23.644321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f99d0>]}


============================== 20:57:23.646387 | 0bda60d2-ea52-4d19-8d4e-451296ff9231 ==============================
[0m20:57:23.646387 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:57:23.646702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:57:23.651760 [info ] [MainThread]: dbt version: 1.9.2
[0m20:57:23.651969 [info ] [MainThread]: python version: 3.11.10
[0m20:57:23.652134 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:57:23.652361 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:57:23.682189 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:57:23.682435 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:57:23.682574 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:57:23.682818 [info ] [MainThread]: adapter type: postgres
[0m20:57:23.682946 [info ] [MainThread]: adapter version: 1.9.0
[0m20:57:23.723527 [info ] [MainThread]: Configuration:
[0m20:57:23.723844 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:57:23.724084 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:57:23.724248 [info ] [MainThread]: Required dependencies:
[0m20:57:23.724454 [debug] [MainThread]: Executing "git --help"
[0m20:57:23.746286 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:57:23.746876 [debug] [MainThread]: STDERR: "b''"
[0m20:57:23.747085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:57:23.747266 [info ] [MainThread]: Connection:
[0m20:57:23.747448 [info ] [MainThread]:   host: 172.19.0.3
[0m20:57:23.747568 [info ] [MainThread]:   port: 5432
[0m20:57:23.747683 [info ] [MainThread]:   user: airflow
[0m20:57:23.747796 [info ] [MainThread]:   database: re
[0m20:57:23.747910 [info ] [MainThread]:   schema: public
[0m20:57:23.748021 [info ] [MainThread]:   connect_timeout: 10
[0m20:57:23.748135 [info ] [MainThread]:   role: None
[0m20:57:23.748249 [info ] [MainThread]:   search_path: None
[0m20:57:23.748360 [info ] [MainThread]:   keepalives_idle: 0
[0m20:57:23.748471 [info ] [MainThread]:   sslmode: None
[0m20:57:23.748582 [info ] [MainThread]:   sslcert: None
[0m20:57:23.748689 [info ] [MainThread]:   sslkey: None
[0m20:57:23.748801 [info ] [MainThread]:   sslrootcert: None
[0m20:57:23.748909 [info ] [MainThread]:   application_name: dbt
[0m20:57:23.749020 [info ] [MainThread]:   retries: 1
[0m20:57:23.749319 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:57:23.790537 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:57:23.812057 [debug] [MainThread]: Using postgres connection "debug"
[0m20:57:23.812306 [debug] [MainThread]: On debug: select 1 as id
[0m20:57:23.812447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:33.816310 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m20:57:43.820121 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:57:43.821474 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:57:43.821828 [debug] [MainThread]: On debug: No close available on handle
[0m20:57:43.822153 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:57:43.822434 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:57:43.822625 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:57:43.825631 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.215263, "process_in_blocks": "0", "process_kernel_time": 0.159558, "process_mem_max_rss": "116719616", "process_out_blocks": "0", "process_user_time": 0.688049}
[0m20:57:43.826284 [debug] [MainThread]: Command `dbt debug` failed at 20:57:43.826157 after 20.22 seconds
[0m20:57:43.826779 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:57:43.827126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a41050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba5d10>]}
[0m20:57:43.827553 [debug] [MainThread]: Flushing usage events
[0m20:57:44.925486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:56.120132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111394b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111410850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111410ed0>]}


============================== 20:58:56.122847 | 257563bb-60bf-4f17-9b6b-12e7ac89123f ==============================
[0m20:58:56.122847 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:58:56.123175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:58:56.132729 [info ] [MainThread]: dbt version: 1.9.2
[0m20:58:56.132976 [info ] [MainThread]: python version: 3.11.10
[0m20:58:56.133358 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:58:56.133537 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:58:56.177998 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:58:56.178321 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:58:56.178477 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:58:56.178934 [info ] [MainThread]: adapter type: postgres
[0m20:58:56.179129 [info ] [MainThread]: adapter version: 1.9.0
[0m20:58:56.220265 [info ] [MainThread]: Configuration:
[0m20:58:56.220580 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:58:56.220730 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:58:56.220859 [info ] [MainThread]: Required dependencies:
[0m20:58:56.221043 [debug] [MainThread]: Executing "git --help"
[0m20:58:56.247998 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:58:56.248610 [debug] [MainThread]: STDERR: "b''"
[0m20:58:56.248831 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:58:56.248992 [info ] [MainThread]: Connection:
[0m20:58:56.249172 [info ] [MainThread]:   host: 172.19.0.3
[0m20:58:56.249296 [info ] [MainThread]:   port: 5432
[0m20:58:56.249414 [info ] [MainThread]:   user: airflow
[0m20:58:56.249529 [info ] [MainThread]:   database: re
[0m20:58:56.249641 [info ] [MainThread]:   schema: public
[0m20:58:56.249755 [info ] [MainThread]:   connect_timeout: 10
[0m20:58:56.249874 [info ] [MainThread]:   role: None
[0m20:58:56.249987 [info ] [MainThread]:   search_path: None
[0m20:58:56.250098 [info ] [MainThread]:   keepalives_idle: 0
[0m20:58:56.250209 [info ] [MainThread]:   sslmode: None
[0m20:58:56.250317 [info ] [MainThread]:   sslcert: None
[0m20:58:56.250428 [info ] [MainThread]:   sslkey: None
[0m20:58:56.250535 [info ] [MainThread]:   sslrootcert: None
[0m20:58:56.250647 [info ] [MainThread]:   application_name: dbt
[0m20:58:56.250759 [info ] [MainThread]:   retries: 1
[0m20:58:56.251098 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:58:56.296799 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:58:56.321789 [debug] [MainThread]: Using postgres connection "debug"
[0m20:58:56.322002 [debug] [MainThread]: On debug: select 1 as id
[0m20:58:56.322140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:06.327234 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m20:59:16.332823 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:59:16.334848 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:59:16.336142 [debug] [MainThread]: On debug: No close available on handle
[0m20:59:16.337284 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:59:16.338303 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:59:16.339131 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:59:16.344602 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.25947, "process_in_blocks": "0", "process_kernel_time": 0.177409, "process_mem_max_rss": "116080640", "process_out_blocks": "0", "process_user_time": 0.701114}
[0m20:59:16.345232 [debug] [MainThread]: Command `dbt debug` failed at 20:59:16.345112 after 20.26 seconds
[0m20:59:16.345664 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:59:16.346046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111410d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111410c90>]}
[0m20:59:16.346496 [debug] [MainThread]: Flushing usage events
[0m20:59:17.475408 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:20.365122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113794ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114010c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114011250>]}


============================== 20:59:20.367839 | b15a2e1a-8ad6-41d8-9f27-3f969ca0ea61 ==============================
[0m20:59:20.367839 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:59:20.368165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:59:20.378133 [info ] [MainThread]: dbt version: 1.9.2
[0m20:59:20.378411 [info ] [MainThread]: python version: 3.11.10
[0m20:59:20.378574 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:59:20.378717 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m20:59:20.414324 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m20:59:20.414636 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m20:59:20.414780 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m20:59:20.415071 [info ] [MainThread]: adapter type: postgres
[0m20:59:20.415241 [info ] [MainThread]: adapter version: 1.9.0
[0m20:59:20.456082 [info ] [MainThread]: Configuration:
[0m20:59:20.456370 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:59:20.456514 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:59:20.456637 [info ] [MainThread]: Required dependencies:
[0m20:59:20.456823 [debug] [MainThread]: Executing "git --help"
[0m20:59:20.480079 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:59:20.480743 [debug] [MainThread]: STDERR: "b''"
[0m20:59:20.480951 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:59:20.481120 [info ] [MainThread]: Connection:
[0m20:59:20.481320 [info ] [MainThread]:   host: 172.19.0.2
[0m20:59:20.481444 [info ] [MainThread]:   port: 5432
[0m20:59:20.481561 [info ] [MainThread]:   user: airflow
[0m20:59:20.481675 [info ] [MainThread]:   database: re
[0m20:59:20.481787 [info ] [MainThread]:   schema: public
[0m20:59:20.481898 [info ] [MainThread]:   connect_timeout: 10
[0m20:59:20.482013 [info ] [MainThread]:   role: None
[0m20:59:20.482125 [info ] [MainThread]:   search_path: None
[0m20:59:20.482235 [info ] [MainThread]:   keepalives_idle: 0
[0m20:59:20.482348 [info ] [MainThread]:   sslmode: None
[0m20:59:20.482457 [info ] [MainThread]:   sslcert: None
[0m20:59:20.482566 [info ] [MainThread]:   sslkey: None
[0m20:59:20.482682 [info ] [MainThread]:   sslrootcert: None
[0m20:59:20.482791 [info ] [MainThread]:   application_name: dbt
[0m20:59:20.482900 [info ] [MainThread]:   retries: 1
[0m20:59:20.483310 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:59:20.528013 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:59:20.549854 [debug] [MainThread]: Using postgres connection "debug"
[0m20:59:20.550078 [debug] [MainThread]: On debug: select 1 as id
[0m20:59:20.550222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:30.554275 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: timeout expired

[0m20:59:40.559499 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:59:40.561428 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:59:40.562623 [debug] [MainThread]: On debug: No close available on handle
[0m20:59:40.563735 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:59:40.564634 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:59:40.565036 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: timeout expired
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:59:40.569289 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.23954, "process_in_blocks": "0", "process_kernel_time": 0.14867, "process_mem_max_rss": "116572160", "process_out_blocks": "0", "process_user_time": 0.705345}
[0m20:59:40.570278 [debug] [MainThread]: Command `dbt debug` failed at 20:59:40.570075 after 20.24 seconds
[0m20:59:40.570856 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:59:40.571586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114609e10>]}
[0m20:59:40.572286 [debug] [MainThread]: Flushing usage events
[0m20:59:41.950566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:41.176800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106746650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0f0d0>]}


============================== 21:00:41.179100 | fd004382-6143-4023-bba7-7460f6ba1523 ==============================
[0m21:00:41.179100 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:00:41.179430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:00:41.304652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd004382-6143-4023-bba7-7460f6ba1523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b66090>]}
[0m21:00:41.329672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd004382-6143-4023-bba7-7460f6ba1523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8c650>]}
[0m21:00:41.330205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:41.379283 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:00:41.460235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:41.460510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:41.483067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd004382-6143-4023-bba7-7460f6ba1523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a0390>]}
[0m21:00:41.524420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m21:00:41.527813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m21:00:41.536986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd004382-6143-4023-bba7-7460f6ba1523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f7f10>]}
[0m21:00:41.537295 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m21:00:41.537477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd004382-6143-4023-bba7-7460f6ba1523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107032950>]}
[0m21:00:41.538434 [info ] [MainThread]: 
[0m21:00:41.538607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:41.538735 [info ] [MainThread]: 
[0m21:00:41.539004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:41.541020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m21:00:41.567731 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m21:00:41.567985 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m21:00:41.568128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:51.572044 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.3", port 5432 failed: timeout expired

[0m21:01:01.576450 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m21:01:01.579825 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:01:01.580869 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m21:01:01.581302 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:01:01.581859 [debug] [ThreadPool]: On list_re: No close available on handle
[0m21:01:01.583384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:01.583951 [debug] [MainThread]: Connection 'list_re' was properly closed.
[0m21:01:01.584469 [info ] [MainThread]: 
[0m21:01:01.584931 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m21:01:01.585757 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "172.19.0.3", port 5432 failed: timeout expired
  
[0m21:01:01.588811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.446941, "process_in_blocks": "0", "process_kernel_time": 0.184079, "process_mem_max_rss": "123355136", "process_out_blocks": "0", "process_user_time": 0.873395}
[0m21:01:01.589373 [debug] [MainThread]: Command `dbt run` failed at 21:01:01.589259 after 20.45 seconds
[0m21:01:01.589945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110238390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6dbd0>]}
[0m21:01:01.590485 [debug] [MainThread]: Flushing usage events
[0m21:01:02.843662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:02:07.708668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942d510>]}


============================== 21:02:07.711990 | 59b9fa32-612a-42f2-a99b-9f48a2763ea3 ==============================
[0m21:02:07.711990 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:02:07.712341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:02:07.723613 [info ] [MainThread]: dbt version: 1.9.2
[0m21:02:07.723876 [info ] [MainThread]: python version: 3.11.10
[0m21:02:07.724043 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m21:02:07.724187 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m21:02:07.770280 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m21:02:07.770580 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m21:02:07.770729 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m21:02:07.771168 [info ] [MainThread]: adapter type: postgres
[0m21:02:07.771349 [info ] [MainThread]: adapter version: 1.9.0
[0m21:02:07.815782 [info ] [MainThread]: Configuration:
[0m21:02:07.816098 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:02:07.816246 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:02:07.816371 [info ] [MainThread]: Required dependencies:
[0m21:02:07.816561 [debug] [MainThread]: Executing "git --help"
[0m21:02:07.842685 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:02:07.843337 [debug] [MainThread]: STDERR: "b''"
[0m21:02:07.843532 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:02:07.843712 [info ] [MainThread]: Connection:
[0m21:02:07.843892 [info ] [MainThread]:   host: localhost
[0m21:02:07.844016 [info ] [MainThread]:   port: 5432
[0m21:02:07.844135 [info ] [MainThread]:   user: airflow
[0m21:02:07.844250 [info ] [MainThread]:   database: re
[0m21:02:07.844362 [info ] [MainThread]:   schema: public
[0m21:02:07.844475 [info ] [MainThread]:   connect_timeout: 10
[0m21:02:07.844589 [info ] [MainThread]:   role: None
[0m21:02:07.844705 [info ] [MainThread]:   search_path: None
[0m21:02:07.844815 [info ] [MainThread]:   keepalives_idle: 0
[0m21:02:07.844927 [info ] [MainThread]:   sslmode: None
[0m21:02:07.845036 [info ] [MainThread]:   sslcert: None
[0m21:02:07.845144 [info ] [MainThread]:   sslkey: None
[0m21:02:07.845265 [info ] [MainThread]:   sslrootcert: None
[0m21:02:07.845375 [info ] [MainThread]:   application_name: dbt
[0m21:02:07.845489 [info ] [MainThread]:   retries: 1
[0m21:02:07.845815 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:02:07.890846 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:02:07.916381 [debug] [MainThread]: Using postgres connection "debug"
[0m21:02:07.916607 [debug] [MainThread]: On debug: select 1 as id
[0m21:02:07.916749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:07.949294 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m21:02:07.949953 [debug] [MainThread]: On debug: Close
[0m21:02:07.950168 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:02:07.950339 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:02:07.951561 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27976868, "process_in_blocks": "0", "process_kernel_time": 0.194943, "process_mem_max_rss": "120668160", "process_out_blocks": "0", "process_user_time": 0.706588}
[0m21:02:07.951825 [debug] [MainThread]: Command `dbt debug` succeeded at 21:02:07.951771 after 0.28 seconds
[0m21:02:07.952002 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:02:07.952192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105063f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32c590>]}
[0m21:02:07.952415 [debug] [MainThread]: Flushing usage events
[0m21:02:09.712381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:57.962238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105171650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051730d0>]}


============================== 21:03:57.965241 | 6d80e6eb-3b35-4775-8b3c-3a43cd9dad96 ==============================
[0m21:03:57.965241 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:03:57.965627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:58.105286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105214750>]}
[0m21:03:58.130694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032d7590>]}
[0m21:03:58.131477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:03:58.182140 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:03:58.227337 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:03:58.227743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8ba50>]}
[0m21:03:58.797407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106143090>]}
[0m21:03:58.836788 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m21:03:58.839795 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m21:03:58.853153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ca510>]}
[0m21:03:58.853458 [info ] [MainThread]: Found 5 models, 9 data tests, 1 source, 433 macros
[0m21:03:58.853638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106254bd0>]}
[0m21:03:58.854607 [info ] [MainThread]: 
[0m21:03:58.854773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:03:58.854901 [info ] [MainThread]: 
[0m21:03:58.855126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:03:58.857034 [debug] [ThreadPool]: Acquiring new postgres connection 'list_re'
[0m21:03:58.887568 [debug] [ThreadPool]: Using postgres connection "list_re"
[0m21:03:58.887858 [debug] [ThreadPool]: On list_re: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re"} */

    select distinct nspname from pg_namespace
  
[0m21:03:58.888006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:58.914128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m21:03:58.914908 [debug] [ThreadPool]: On list_re: Close
[0m21:03:58.915737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_re, now list_re_public)
[0m21:03:58.918713 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m21:03:58.918922 [debug] [ThreadPool]: On list_re_public: BEGIN
[0m21:03:58.919056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:58.925806 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m21:03:58.926069 [debug] [ThreadPool]: Using postgres connection "list_re_public"
[0m21:03:58.926229 [debug] [ThreadPool]: On list_re_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "list_re_public"} */
select
      're' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      're' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:03:58.928192 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:03:58.928887 [debug] [ThreadPool]: On list_re_public: ROLLBACK
[0m21:03:58.929457 [debug] [ThreadPool]: On list_re_public: Close
[0m21:03:58.932257 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.932442 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.932567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:58.939516 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:03:58.939742 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.939939 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:03:58.942073 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m21:03:58.942649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652dd10>]}
[0m21:03:58.942928 [debug] [MainThread]: On master: ROLLBACK
[0m21:03:58.943474 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.943613 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.944986 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:03:58.945120 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.945287 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.945442 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.945939 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:03:58.946089 [debug] [MainThread]: On master: Close
[0m21:03:58.946854 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m21:03:58.947088 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m21:03:58.947313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_re_public, now model.real_estate.staging_table)
[0m21:03:58.947524 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m21:03:58.951396 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m21:03:58.952318 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m21:03:58.969060 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m21:03:58.969584 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m21:03:58.969759 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m21:03:58.969911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:03:58.977076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:03:58.977354 [debug] [Thread-1 (]: Using postgres connection "model.real_estate.staging_table"
[0m21:03:58.977539 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table "re"."public"."staging_table__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "re"."public"."staging_table"  -- Reference your PostgreSQL table
  );
  
[0m21:03:58.978145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.staging_table" does not exist
LINE 34: FROM "re"."public"."staging_table"  -- Reference your Postgr...
              ^

[0m21:03:58.978341 [debug] [Thread-1 (]: On model.real_estate.staging_table: ROLLBACK
[0m21:03:58.978864 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m21:03:58.983618 [debug] [Thread-1 (]: Database Error in model staging_table (models/staging/staging_table.sql)
  relation "public.staging_table" does not exist
  LINE 34: FROM "re"."public"."staging_table"  -- Reference your Postgr...
                ^
  compiled code at target/run/real_estate/models/staging/staging_table.sql
[0m21:03:58.984696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d80e6eb-3b35-4775-8b3c-3a43cd9dad96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ea750>]}
[0m21:03:58.985028 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model public.staging_table ..................... [[31mERROR[0m in 0.04s]
[0m21:03:58.985306 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m21:03:58.985547 [debug] [Thread-7 (]: Marking all children of 'model.real_estate.staging_table' to be skipped because of status 'error'.  Reason: Database Error in model staging_table (models/staging/staging_table.sql)
  relation "public.staging_table" does not exist
  LINE 34: FROM "re"."public"."staging_table"  -- Reference your Postgr...
                ^
  compiled code at target/run/real_estate/models/staging/staging_table.sql.
[0m21:03:58.986193 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m21:03:58.986365 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m21:03:58.986507 [debug] [Thread-2 (]: Began running node model.real_estate.dim_project
[0m21:03:58.986698 [info ] [Thread-3 (]: 2 of 5 SKIP relation public.dim_broker ......................................... [[33mSKIP[0m]
[0m21:03:58.986911 [info ] [Thread-4 (]: 3 of 5 SKIP relation public.dim_post ........................................... [[33mSKIP[0m]
[0m21:03:58.987132 [info ] [Thread-2 (]: 4 of 5 SKIP relation public.dim_project ........................................ [[33mSKIP[0m]
[0m21:03:58.987333 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m21:03:58.987508 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m21:03:58.987670 [debug] [Thread-2 (]: Finished running node model.real_estate.dim_project
[0m21:03:58.988020 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m21:03:58.988202 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_all_apartment ................................. [[33mSKIP[0m]
[0m21:03:58.988388 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m21:03:58.988941 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.989085 [debug] [MainThread]: On master: BEGIN
[0m21:03:58.989204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:58.996031 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:03:58.996257 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.996393 [debug] [MainThread]: Using postgres connection "master"
[0m21:03:58.996515 [debug] [MainThread]: On master: COMMIT
[0m21:03:58.996956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:03:58.997124 [debug] [MainThread]: On master: Close
[0m21:03:58.997323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:58.997451 [debug] [MainThread]: Connection 'model.real_estate.staging_table' was properly closed.
[0m21:03:58.997725 [info ] [MainThread]: 
[0m21:03:58.997893 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m21:03:58.998227 [debug] [MainThread]: Command end result
[0m21:03:59.008985 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m21:03:59.009717 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m21:03:59.012554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m21:03:59.012790 [info ] [MainThread]: 
[0m21:03:59.012971 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:03:59.013121 [info ] [MainThread]: 
[0m21:03:59.013296 [error] [MainThread]:   Database Error in model staging_table (models/staging/staging_table.sql)
  relation "public.staging_table" does not exist
  LINE 34: FROM "re"."public"."staging_table"  -- Reference your Postgr...
                ^
  compiled code at target/run/real_estate/models/staging/staging_table.sql
[0m21:03:59.013447 [info ] [MainThread]: 
[0m21:03:59.013589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m21:03:59.014768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0914105, "process_in_blocks": "0", "process_kernel_time": 0.243836, "process_mem_max_rss": "137199616", "process_out_blocks": "0", "process_user_time": 1.463972}
[0m21:03:59.014969 [debug] [MainThread]: Command `dbt run` failed at 21:03:59.014930 after 1.09 seconds
[0m21:03:59.015160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105763650>]}
[0m21:03:59.015350 [debug] [MainThread]: Flushing usage events
[0m21:04:00.032321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:27.610566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919079e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ed2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91907da0>]}


============================== 15:20:27.614967 | 5df13911-9ec3-46a2-92c3-620e8217cd09 ==============================
[0m15:20:27.614967 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:20:27.615399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:20:27.615659 [info ] [MainThread]: dbt version: 1.5.0
[0m15:20:27.615895 [info ] [MainThread]: python version: 3.12.8
[0m15:20:27.616207 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m15:20:27.616500 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m15:20:27.616788 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m15:20:27.617122 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m15:20:27.617471 [info ] [MainThread]: Configuration:
[0m15:20:27.639159 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:20:27.649934 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:20:27.650216 [info ] [MainThread]: Required dependencies:
[0m15:20:27.650514 [debug] [MainThread]: Executing "git --help"
[0m15:20:27.651158 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:20:27.651545 [info ] [MainThread]: Connection:
[0m15:20:27.651823 [info ] [MainThread]:   host: localhost
[0m15:20:27.652076 [info ] [MainThread]:   port: 5432
[0m15:20:27.652324 [info ] [MainThread]:   user: airflow
[0m15:20:27.652573 [info ] [MainThread]:   database: re
[0m15:20:27.652805 [info ] [MainThread]:   schema: public
[0m15:20:27.653022 [info ] [MainThread]:   search_path: None
[0m15:20:27.653286 [info ] [MainThread]:   keepalives_idle: 0
[0m15:20:27.653548 [info ] [MainThread]:   sslmode: None
[0m15:20:27.653999 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:20:27.654175 [debug] [MainThread]: Using postgres connection "debug"
[0m15:20:27.654331 [debug] [MainThread]: On debug: select 1 as id
[0m15:20:27.654480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:27.655104 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:20:27.656629 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:20:27.656794 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:20:27.656962 [debug] [MainThread]: On debug: No close available on handle
[0m15:20:27.657103 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:20:27.657294 [info ] [MainThread]: [31m2 checks failed:[0m
[0m15:20:27.657528 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m15:20:27.657808 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:20:27.658285 [debug] [MainThread]: Command `dbt debug` failed at 15:20:27.658225 after 0.05 seconds
[0m15:20:27.658460 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:20:27.658622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92771c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91963770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a913a0>]}
[0m15:20:27.658809 [debug] [MainThread]: Flushing usage events
[0m17:17:12.971408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1afce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d592ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cffa300>]}


============================== 17:17:12.975802 | dd9e116a-e1b8-4405-93c8-825d74422077 ==============================
[0m17:17:12.975802 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:17:12.976187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:17:12.977982 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'real_estate' does not have a target named 'prod_redshift'. The valid target names for this profile are:
   - dev_postgres
   - dev_redshift
[0m17:17:12.978369 [debug] [MainThread]: Command `dbt run` failed at 17:17:12.978282 after 0.01 seconds
[0m17:17:12.978610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc9aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cffb9e0>]}
[0m17:17:12.978812 [debug] [MainThread]: Flushing usage events
[0m17:17:27.603834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6107a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b32d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1d1100>]}


============================== 17:17:27.608030 | c7c0ccff-7293-4370-b84c-5c6fc7df37f3 ==============================
[0m17:17:27.608030 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:17:27.608395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:17:27.658828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b22c290>]}
[0m17:17:27.666502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5c7cb0>]}
[0m17:17:27.674410 [debug] [MainThread]: checksum: 6e157d37ad47f2306b96b5d86ad41da87d89edbbef2ad58270584e97aa2c27b1, vars: {}, profile: , target: dev_redshift, version: 1.5.0
[0m17:17:27.680996 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:17:27.681306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a349190>]}
[0m17:17:27.983851 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m17:17:27.990885 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m17:17:27.992835 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m17:17:27.994611 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m17:17:27.996422 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m17:17:28.061587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2f49b0>]}
[0m17:17:28.065936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a19f050>]}
[0m17:17:28.066227 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:17:28.066632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c0ccff-7293-4370-b84c-5c6fc7df37f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2f6570>]}
[0m17:17:28.067822 [info ] [MainThread]: 
[0m17:17:28.068399 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:17:28.069214 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:17:28.075940 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:17:28.076222 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m17:17:28.076390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:28.076591 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:17:28.111607 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m17:17:28.112012 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m17:17:28.112240 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m17:17:28.112438 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m17:17:28.112843 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m17:17:28.113840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:28.114077 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:17:28.114290 [info ] [MainThread]: 
[0m17:17:28.114546 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m17:17:28.115096 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m17:17:28.115548 [debug] [MainThread]: Command `dbt run` failed at 17:17:28.115450 after 0.52 seconds
[0m17:17:28.115811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b32d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f727e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9add7aa0>]}
[0m17:17:28.116083 [debug] [MainThread]: Flushing usage events
[0m17:20:39.035813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c64230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f4c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1286b0>]}


============================== 17:20:39.039953 | 82c6489b-90fc-4a29-832a-b5abb94ffc86 ==============================
[0m17:20:39.039953 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:20:39.040291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:20:39.040654 [info ] [MainThread]: dbt version: 1.5.0
[0m17:20:39.040898 [info ] [MainThread]: python version: 3.12.8
[0m17:20:39.041156 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:20:39.041412 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:20:39.041808 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:20:39.042175 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:20:39.042495 [info ] [MainThread]: Configuration:
[0m17:20:39.044782 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m17:20:39.055571 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:20:39.055869 [info ] [MainThread]: Required dependencies:
[0m17:20:39.056188 [debug] [MainThread]: Executing "git --help"
[0m17:20:39.056790 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:20:39.057050 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:20:39.057297 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'real_estate' does not have a target named 'prod_redshift'. The valid target names for this profile are:
   - dev_postgres
   - dev_redshift


[0m17:20:39.057627 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:20:39.058112 [debug] [MainThread]: Command `dbt debug` failed at 17:20:39.058019 after 0.03 seconds
[0m17:20:39.058412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa852ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa1286b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa03e1b0>]}
[0m17:20:39.058639 [debug] [MainThread]: Flushing usage events
[0m17:20:52.049819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaecbcbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9ad610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb4c800>]}


============================== 17:20:52.054004 | f2e7d1cf-7847-4ade-9a72-2ea44d3e5622 ==============================
[0m17:20:52.054004 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:20:52.054349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:20:52.054773 [info ] [MainThread]: dbt version: 1.5.0
[0m17:20:52.055116 [info ] [MainThread]: python version: 3.12.8
[0m17:20:52.055400 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:20:52.055681 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:20:52.055957 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:20:52.056188 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:20:52.056494 [info ] [MainThread]: Configuration:
[0m17:20:52.097178 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:20:52.108320 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:20:52.108642 [info ] [MainThread]: Required dependencies:
[0m17:20:52.108953 [debug] [MainThread]: Executing "git --help"
[0m17:20:52.109744 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:20:52.110016 [info ] [MainThread]: Connection:
[0m17:20:52.110313 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:20:52.110593 [info ] [MainThread]:   port: 5439
[0m17:20:52.110832 [info ] [MainThread]:   user: quyendinh
[0m17:20:52.111070 [info ] [MainThread]:   database: dev
[0m17:20:52.111362 [info ] [MainThread]:   schema: public
[0m17:20:52.111653 [info ] [MainThread]:   method: database
[0m17:20:52.111910 [info ] [MainThread]:   cluster_id: None
[0m17:20:52.112227 [info ] [MainThread]:   iam_profile: None
[0m17:20:52.112614 [info ] [MainThread]:   sslmode: None
[0m17:20:52.113097 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:20:52.113518 [debug] [MainThread]: Using redshift connection "debug"
[0m17:20:52.113699 [debug] [MainThread]: On debug: select 1 as id
[0m17:20:52.113865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:52.114046 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:20:52.142957 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:20:52.143220 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:20:52.143400 [debug] [MainThread]: On debug: No close available on handle
[0m17:20:52.143555 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:20:52.143788 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:20:52.144089 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:20:52.144330 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:20:52.144762 [debug] [MainThread]: Command `dbt debug` failed at 17:20:52.144695 after 0.10 seconds
[0m17:20:52.144968 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:20:52.145158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaedf38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed02960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3d4b90>]}
[0m17:20:52.145399 [debug] [MainThread]: Flushing usage events
[0m00:23:39.036228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110695c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f5410>]}


============================== 00:23:39.038803 | 473da16d-d6e5-488b-8704-26981c143b35 ==============================
[0m00:23:39.038803 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:23:39.039121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --target dev_postgres', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:39.049567 [info ] [MainThread]: dbt version: 1.9.2
[0m00:23:39.049858 [info ] [MainThread]: python version: 3.11.10
[0m00:23:39.050029 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:23:39.050169 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:23:39.097933 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:23:39.098232 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:23:39.098375 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:23:39.098871 [info ] [MainThread]: adapter type: postgres
[0m00:23:39.099121 [info ] [MainThread]: adapter version: 1.9.0
[0m00:23:39.142403 [info ] [MainThread]: Configuration:
[0m00:23:39.142707 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:23:39.142851 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:23:39.142972 [info ] [MainThread]: Required dependencies:
[0m00:23:39.143161 [debug] [MainThread]: Executing "git --help"
[0m00:23:39.168668 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:23:39.169290 [debug] [MainThread]: STDERR: "b''"
[0m00:23:39.169478 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:23:39.169669 [info ] [MainThread]: Connection:
[0m00:23:39.169869 [info ] [MainThread]:   host: localhost
[0m00:23:39.169993 [info ] [MainThread]:   port: 5432
[0m00:23:39.170117 [info ] [MainThread]:   user: airflow
[0m00:23:39.170236 [info ] [MainThread]:   database: re
[0m00:23:39.170353 [info ] [MainThread]:   schema: public
[0m00:23:39.170468 [info ] [MainThread]:   connect_timeout: 10
[0m00:23:39.170583 [info ] [MainThread]:   role: None
[0m00:23:39.170699 [info ] [MainThread]:   search_path: None
[0m00:23:39.170815 [info ] [MainThread]:   keepalives_idle: 0
[0m00:23:39.170926 [info ] [MainThread]:   sslmode: None
[0m00:23:39.171038 [info ] [MainThread]:   sslcert: None
[0m00:23:39.171146 [info ] [MainThread]:   sslkey: None
[0m00:23:39.171258 [info ] [MainThread]:   sslrootcert: None
[0m00:23:39.171371 [info ] [MainThread]:   application_name: dbt
[0m00:23:39.171480 [info ] [MainThread]:   retries: 1
[0m00:23:39.171822 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:23:39.215865 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:23:39.241879 [debug] [MainThread]: Using postgres connection "debug"
[0m00:23:39.242081 [debug] [MainThread]: On debug: select 1 as id
[0m00:23:39.242220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:39.273006 [debug] [MainThread]: SQL status: SELECT 1 in 0.031 seconds
[0m00:23:39.273618 [debug] [MainThread]: On debug: Close
[0m00:23:39.273809 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:23:39.273983 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:23:39.275197 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2744548, "process_in_blocks": "0", "process_kernel_time": 0.186818, "process_mem_max_rss": "121454592", "process_out_blocks": "0", "process_user_time": 0.702833}
[0m00:23:39.275506 [debug] [MainThread]: Command `dbt debug` succeeded at 00:23:39.275443 after 0.27 seconds
[0m00:23:39.275723 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:23:39.275927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110beda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a87d0>]}
[0m00:23:39.276155 [debug] [MainThread]: Flushing usage events
[0m00:23:40.332990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:47.132040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e96550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef59d0>]}


============================== 00:23:47.134215 | a769e8ec-e191-41c9-aa03-f03d117eb4b2 ==============================
[0m00:23:47.134215 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:23:47.134527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --target dev_redshift', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:47.139525 [info ] [MainThread]: dbt version: 1.9.2
[0m00:23:47.139726 [info ] [MainThread]: python version: 3.11.10
[0m00:23:47.139966 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:23:47.140168 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:23:47.143745 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.redshift'
[0m00:23:47.144114 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:23:47.144393 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:23:47.144568 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:23:47.186283 [info ] [MainThread]: Configuration:
[0m00:23:47.186645 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:23:47.186786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:23:47.186911 [info ] [MainThread]: Required dependencies:
[0m00:23:47.187105 [debug] [MainThread]: Executing "git --help"
[0m00:23:47.210474 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:23:47.211068 [debug] [MainThread]: STDERR: "b''"
[0m00:23:47.211266 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:23:47.211440 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:23:47.211635 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:23:47.211826 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev_redshift" invalid: Runtime Error
    Could not find adapter type redshift!


[0m00:23:47.213293 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.11523187, "process_in_blocks": "0", "process_kernel_time": 0.106421, "process_mem_max_rss": "107839488", "process_out_blocks": "0", "process_user_time": 0.629039}
[0m00:23:47.213580 [debug] [MainThread]: Command `dbt debug` failed at 00:23:47.213502 after 0.12 seconds
[0m00:23:47.213848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ee6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102323fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db4690>]}
[0m00:23:47.214079 [debug] [MainThread]: Flushing usage events
[0m00:23:48.319823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:09.371090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae6cd0>]}


============================== 00:28:09.374350 | 39324077-3fc6-4c2c-a62c-52e29522433c ==============================
[0m00:28:09.374350 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:28:09.374703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --target dev_redshift', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:09.385417 [info ] [MainThread]: dbt version: 1.9.2
[0m00:28:09.385708 [info ] [MainThread]: python version: 3.11.10
[0m00:28:09.385887 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:28:09.386031 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:28:09.389156 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.redshift'
[0m00:28:09.389468 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:28:09.389616 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:28:09.389751 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:28:09.432234 [info ] [MainThread]: Configuration:
[0m00:28:09.432576 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:28:09.432786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:28:09.432976 [info ] [MainThread]: Required dependencies:
[0m00:28:09.433222 [debug] [MainThread]: Executing "git --help"
[0m00:28:09.458330 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:28:09.458957 [debug] [MainThread]: STDERR: "b''"
[0m00:28:09.459152 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:28:09.459335 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:28:09.459506 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:28:09.459638 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev_redshift" invalid: Runtime Error
    Could not find adapter type redshift!


[0m00:28:09.461046 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13000658, "process_in_blocks": "0", "process_kernel_time": 0.154899, "process_mem_max_rss": "107216896", "process_out_blocks": "0", "process_user_time": 0.67249}
[0m00:28:09.461333 [debug] [MainThread]: Command `dbt debug` failed at 00:28:09.461279 after 0.13 seconds
[0m00:28:09.461607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ae6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026e3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104125010>]}
[0m00:28:09.461856 [debug] [MainThread]: Flushing usage events
[0m00:28:10.451355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:16.172571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92890710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9192a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918be810>]}


============================== 17:31:16.177807 | 6641dc5f-7897-4a28-aaef-e1907ead93cf ==============================
[0m17:31:16.177807 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:31:16.178189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:31:16.178495 [info ] [MainThread]: dbt version: 1.5.0
[0m17:31:16.178722 [info ] [MainThread]: python version: 3.12.8
[0m17:31:16.179037 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:31:16.179293 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:31:16.179550 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:31:16.179838 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:31:16.180173 [info ] [MainThread]: Configuration:
[0m17:31:16.221661 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:31:16.232626 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:31:16.233012 [info ] [MainThread]: Required dependencies:
[0m17:31:16.233304 [debug] [MainThread]: Executing "git --help"
[0m17:31:16.234021 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:31:16.234258 [info ] [MainThread]: Connection:
[0m17:31:16.234542 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:31:16.234797 [info ] [MainThread]:   port: 5439
[0m17:31:16.235099 [info ] [MainThread]:   user: quyendinh
[0m17:31:16.235372 [info ] [MainThread]:   database: dev
[0m17:31:16.235638 [info ] [MainThread]:   schema: public
[0m17:31:16.235880 [info ] [MainThread]:   method: database
[0m17:31:16.236140 [info ] [MainThread]:   cluster_id: None
[0m17:31:16.236383 [info ] [MainThread]:   iam_profile: None
[0m17:31:16.236603 [info ] [MainThread]:   sslmode: verify-full
[0m17:31:16.236997 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:31:16.237344 [debug] [MainThread]: Using redshift connection "debug"
[0m17:31:16.237510 [debug] [MainThread]: On debug: select 1 as id
[0m17:31:16.237657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:16.237836 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:31:16.265921 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:31:16.266182 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:31:16.266350 [debug] [MainThread]: On debug: No close available on handle
[0m17:31:16.266511 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:31:16.266714 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:31:16.266993 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:31:16.267327 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:31:16.267888 [debug] [MainThread]: Command `dbt debug` failed at 17:31:16.267804 after 0.10 seconds
[0m17:31:16.268088 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:31:16.268262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91572540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92890710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91585af0>]}
[0m17:31:16.268466 [debug] [MainThread]: Flushing usage events
[0m17:33:17.845188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa465be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4866de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa465ab10>]}


============================== 17:33:17.849315 | 3180c51a-ced3-445e-99ff-fc699d428ab9 ==============================
[0m17:33:17.849315 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:33:17.849664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:17.898521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa480ed20>]}
[0m17:33:17.905701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4659e20>]}
[0m17:33:17.913372 [debug] [MainThread]: checksum: 6e157d37ad47f2306b96b5d86ad41da87d89edbbef2ad58270584e97aa2c27b1, vars: {}, profile: , target: dev_redshift, version: 1.5.0
[0m17:33:17.920194 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:33:17.920512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa379e150>]}
[0m17:33:18.215775 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m17:33:18.222750 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m17:33:18.224656 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m17:33:18.226377 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m17:33:18.228052 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m17:33:18.294287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36126f0>]}
[0m17:33:18.298927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37cc590>]}
[0m17:33:18.299199 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m17:33:18.299442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3180c51a-ced3-445e-99ff-fc699d428ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa362b5f0>]}
[0m17:33:18.300456 [info ] [MainThread]: 
[0m17:33:18.301036 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m17:33:18.301781 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m17:33:18.308380 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m17:33:18.308675 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m17:33:18.308891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:18.309078 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:18.344297 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m17:33:18.344546 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m17:33:18.344740 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m17:33:18.344885 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m17:33:18.345076 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m17:33:18.345660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:18.345846 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:33:18.346009 [info ] [MainThread]: 
[0m17:33:18.346240 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m17:33:18.346534 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m17:33:18.346965 [debug] [MainThread]: Command `dbt run` failed at 17:33:18.346874 after 0.51 seconds
[0m17:33:18.347197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa480f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37f4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37ce270>]}
[0m17:33:18.347393 [debug] [MainThread]: Flushing usage events
[0m17:33:26.533448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8840a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84011100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848c2ab0>]}


============================== 17:33:26.538629 | 6bfd2b52-bf22-453c-abce-c8752e2ec54d ==============================
[0m17:33:26.538629 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:33:26.538998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:33:26.539317 [info ] [MainThread]: dbt version: 1.5.0
[0m17:33:26.539565 [info ] [MainThread]: python version: 3.12.8
[0m17:33:26.539832 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:33:26.540105 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:33:26.540540 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:33:26.540800 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:33:26.541086 [info ] [MainThread]: Configuration:
[0m17:33:26.582787 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:33:26.594009 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:33:26.594332 [info ] [MainThread]: Required dependencies:
[0m17:33:26.594725 [debug] [MainThread]: Executing "git --help"
[0m17:33:26.595324 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:33:26.595558 [info ] [MainThread]: Connection:
[0m17:33:26.595965 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:33:26.596241 [info ] [MainThread]:   port: 5439
[0m17:33:26.596498 [info ] [MainThread]:   user: quyendinh
[0m17:33:26.596774 [info ] [MainThread]:   database: dev
[0m17:33:26.597189 [info ] [MainThread]:   schema: public
[0m17:33:26.597463 [info ] [MainThread]:   method: database
[0m17:33:26.597738 [info ] [MainThread]:   cluster_id: None
[0m17:33:26.598045 [info ] [MainThread]:   iam_profile: None
[0m17:33:26.598353 [info ] [MainThread]:   sslmode: verify-full
[0m17:33:26.598821 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:33:26.599255 [debug] [MainThread]: Using redshift connection "debug"
[0m17:33:26.599460 [debug] [MainThread]: On debug: select 1 as id
[0m17:33:26.599612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:26.599783 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:33:26.629058 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:33:26.629307 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:33:26.629478 [debug] [MainThread]: On debug: No close available on handle
[0m17:33:26.629636 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:33:26.629854 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:33:26.630198 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:33:26.630461 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:33:26.630993 [debug] [MainThread]: Command `dbt debug` failed at 17:33:26.630901 after 0.10 seconds
[0m17:33:26.631208 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:33:26.631391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8497f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88417e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885b70b0>]}
[0m17:33:26.631606 [debug] [MainThread]: Flushing usage events
[0m00:35:40.888301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694d110>]}


============================== 00:35:40.891592 | 6a296ff6-d29d-4bd0-b8a2-549e61ff63e8 ==============================
[0m00:35:40.891592 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:35:40.891946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --target dev_redshift', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:35:40.903209 [info ] [MainThread]: dbt version: 1.9.2
[0m00:35:40.903478 [info ] [MainThread]: python version: 3.11.10
[0m00:35:40.903648 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:35:40.903791 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:35:40.906619 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.redshift'
[0m00:35:40.906881 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:35:40.907028 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:35:40.907158 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:35:40.949789 [info ] [MainThread]: Configuration:
[0m00:35:40.950116 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:35:40.950261 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:35:40.950393 [info ] [MainThread]: Required dependencies:
[0m00:35:40.950585 [debug] [MainThread]: Executing "git --help"
[0m00:35:40.973922 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:35:40.974530 [debug] [MainThread]: STDERR: "b''"
[0m00:35:40.974716 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:35:40.974883 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:35:40.975034 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:35:40.975160 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev_redshift" invalid: Runtime Error
    Could not find adapter type redshift!


[0m00:35:40.976424 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12583813, "process_in_blocks": "0", "process_kernel_time": 0.144779, "process_mem_max_rss": "107298816", "process_out_blocks": "0", "process_user_time": 0.639014}
[0m00:35:40.976651 [debug] [MainThread]: Command `dbt debug` failed at 00:35:40.976598 after 0.13 seconds
[0m00:35:40.976930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10259ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a14b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52d10>]}
[0m00:35:40.977172 [debug] [MainThread]: Flushing usage events
[0m00:35:42.244747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:49.205576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd9f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bca2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5c2960>]}


============================== 17:35:49.211529 | fa3da132-f374-491d-affe-d40f8a49ad81 ==============================
[0m17:35:49.211529 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:35:49.211885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:35:49.212600 [info ] [MainThread]: dbt version: 1.5.0
[0m17:35:49.212874 [info ] [MainThread]: python version: 3.12.8
[0m17:35:49.213088 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:35:49.213326 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:35:49.213609 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:35:49.213869 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:35:49.214093 [info ] [MainThread]: Configuration:
[0m17:35:49.255482 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:35:49.267100 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:35:49.267532 [info ] [MainThread]: Required dependencies:
[0m17:35:49.267935 [debug] [MainThread]: Executing "git --help"
[0m17:35:49.268629 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:35:49.268897 [info ] [MainThread]: Connection:
[0m17:35:49.269258 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:35:49.269585 [info ] [MainThread]:   port: 5439
[0m17:35:49.269882 [info ] [MainThread]:   user: quyendinh
[0m17:35:49.270175 [info ] [MainThread]:   database: dev
[0m17:35:49.270515 [info ] [MainThread]:   schema: public
[0m17:35:49.270786 [info ] [MainThread]:   method: database
[0m17:35:49.271057 [info ] [MainThread]:   cluster_id: None
[0m17:35:49.271332 [info ] [MainThread]:   iam_profile: None
[0m17:35:49.271590 [info ] [MainThread]:   sslmode: verify-full
[0m17:35:49.272122 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:35:49.272609 [debug] [MainThread]: Using redshift connection "debug"
[0m17:35:49.272811 [debug] [MainThread]: On debug: select 1 as id
[0m17:35:49.272958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:49.273133 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:35:49.302649 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:35:49.302900 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:35:49.303079 [debug] [MainThread]: On debug: No close available on handle
[0m17:35:49.303243 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:35:49.303570 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:35:49.303831 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:35:49.304076 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:35:49.304429 [debug] [MainThread]: Command `dbt debug` failed at 17:35:49.304369 after 0.11 seconds
[0m17:35:49.304605 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:35:49.304860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb838c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b110e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b57df40>]}
[0m17:35:49.305085 [debug] [MainThread]: Flushing usage events
[0m00:40:51.463425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b497f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4ed510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4e7a50>]}


============================== 00:40:51.466433 | 2ad21a37-97f2-4049-9713-891dcb2d3f52 ==============================
[0m00:40:51.466433 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:40:51.466782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --target dev_redshift', 'send_anonymous_usage_stats': 'True'}
[0m00:40:51.478416 [info ] [MainThread]: dbt version: 1.9.2
[0m00:40:51.478704 [info ] [MainThread]: python version: 3.11.10
[0m00:40:51.478878 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:40:51.479020 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:40:51.481864 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.redshift'
[0m00:40:51.482122 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:40:51.482260 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:40:51.482395 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:40:51.524531 [info ] [MainThread]: Configuration:
[0m00:40:51.524834 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:40:51.524976 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:40:51.525203 [info ] [MainThread]: Required dependencies:
[0m00:40:51.525422 [debug] [MainThread]: Executing "git --help"
[0m00:40:51.551023 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:40:51.551623 [debug] [MainThread]: STDERR: "b''"
[0m00:40:51.551803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:40:51.551975 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:40:51.552117 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:40:51.552246 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev_redshift" invalid: Runtime Error
    Could not find adapter type redshift!


[0m00:40:51.553528 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12526391, "process_in_blocks": "0", "process_kernel_time": 0.140302, "process_mem_max_rss": "106971136", "process_out_blocks": "0", "process_user_time": 0.638691}
[0m00:40:51.553770 [debug] [MainThread]: Command `dbt debug` failed at 00:40:51.553715 after 0.13 seconds
[0m00:40:51.554064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4ed650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5fb190>]}
[0m00:40:51.554306 [debug] [MainThread]: Flushing usage events
[0m00:40:52.646490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:40.462054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e1a50>]}


============================== 00:41:40.464960 | c4ca9e1b-62a9-4019-afd7-d35bad4a178e ==============================
[0m00:41:40.464960 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:41:40.465292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --target dev_redshift', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:40.474688 [info ] [MainThread]: dbt version: 1.9.2
[0m00:41:40.475066 [info ] [MainThread]: python version: 3.11.10
[0m00:41:40.475291 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m00:41:40.475438 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m00:41:40.592192 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:41:40.592539 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:41:40.636457 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m00:41:40.636720 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m00:41:40.636896 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m00:41:40.637310 [info ] [MainThread]: adapter type: redshift
[0m00:41:40.637448 [info ] [MainThread]: adapter version: 1.9.0
[0m00:41:40.677516 [info ] [MainThread]: Configuration:
[0m00:41:40.677837 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:41:40.677984 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:41:40.678109 [info ] [MainThread]: Required dependencies:
[0m00:41:40.678296 [debug] [MainThread]: Executing "git --help"
[0m00:41:40.705708 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:41:40.706353 [debug] [MainThread]: STDERR: "b''"
[0m00:41:40.706584 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:41:40.706772 [info ] [MainThread]: Connection:
[0m00:41:40.706995 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m00:41:40.707130 [info ] [MainThread]:   user: quyendinh
[0m00:41:40.707260 [info ] [MainThread]:   port: 5439
[0m00:41:40.707379 [info ] [MainThread]:   database: dev
[0m00:41:40.707501 [info ] [MainThread]:   method: database
[0m00:41:40.707620 [info ] [MainThread]:   cluster_id: None
[0m00:41:40.707737 [info ] [MainThread]:   iam_profile: None
[0m00:41:40.707856 [info ] [MainThread]:   schema: public
[0m00:41:40.707973 [info ] [MainThread]:   sslmode: verify-full
[0m00:41:40.708086 [info ] [MainThread]:   region: None
[0m00:41:40.708202 [info ] [MainThread]:   sslmode: verify-full
[0m00:41:40.708320 [info ] [MainThread]:   region: None
[0m00:41:40.708434 [info ] [MainThread]:   autocreate: False
[0m00:41:40.708551 [info ] [MainThread]:   db_groups: []
[0m00:41:40.708665 [info ] [MainThread]:   ra3_node: True
[0m00:41:40.708774 [info ] [MainThread]:   connect_timeout: 10
[0m00:41:40.708890 [info ] [MainThread]:   role: None
[0m00:41:40.708999 [info ] [MainThread]:   retries: 1
[0m00:41:40.709716 [info ] [MainThread]:   autocommit: True
[0m00:41:40.709984 [info ] [MainThread]:   access_key_id: None
[0m00:41:40.710421 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m00:41:40.765484 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m00:41:40.768823 [debug] [MainThread]: Using redshift connection "debug"
[0m00:41:40.769082 [debug] [MainThread]: On debug: select 1 as id
[0m00:41:40.769232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:41:40.769411 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:41:40.771917 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:41:43.732579 [debug] [MainThread]: SQL status: SUCCESS in 2.963 seconds
[0m00:41:43.780244 [debug] [MainThread]: On debug: Close
[0m00:41:43.780776 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:41:43.780995 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:41:43.782557 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.3563035, "process_in_blocks": "0", "process_kernel_time": 0.216903, "process_mem_max_rss": "134447104", "process_out_blocks": "0", "process_user_time": 0.796226}
[0m00:41:43.782811 [debug] [MainThread]: Command `dbt debug` succeeded at 00:41:43.782756 after 3.36 seconds
[0m00:41:43.782996 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:41:43.783192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e92990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbe5d0>]}
[0m00:41:43.783419 [debug] [MainThread]: Flushing usage events
[0m00:41:44.790235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:52.817869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106716650>]}


============================== 00:41:52.819995 | cffbad37-29ae-4259-9178-7e0f83aa8a67 ==============================
[0m00:41:52.819995 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:41:52.820311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:41:52.822265 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'real_estate' does not have a target named 'dev'. The valid target names for this profile are:
   - dev_postgres
   - dev_redshift
[0m00:41:52.823089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.038859833, "process_in_blocks": "0", "process_kernel_time": 0.114219, "process_mem_max_rss": "102678528", "process_out_blocks": "0", "process_user_time": 0.578854}
[0m00:41:52.823304 [debug] [MainThread]: Command `dbt run` failed at 00:41:52.823259 after 0.04 seconds
[0m00:41:52.823486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10268ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a45610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a45d10>]}
[0m00:41:52.823658 [debug] [MainThread]: Flushing usage events
[0m00:41:53.898830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:12.564252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad95b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfdc10>]}


============================== 00:42:12.566331 | 025a775d-f757-41a9-89df-314bf2383ed4 ==============================
[0m00:42:12.566331 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:42:12.566655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev_redshift', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:12.658485 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:42:12.658799 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:42:12.752788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc95f90>]}
[0m00:42:12.776680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4810>]}
[0m00:42:12.777308 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m00:42:12.833248 [debug] [MainThread]: checksum: d14ca3ebecd27f6d058b5f8da783370a5cb8a29c0ee296ecc351f7cd93d67ef1, vars: {}, profile: , target: dev_redshift, version: 1.9.2
[0m00:42:12.876248 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m00:42:12.876550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab9050>]}
[0m00:42:13.494608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6d59d0>]}
[0m00:42:13.534055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:42:13.535467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:42:13.542859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6a9c10>]}
[0m00:42:13.543120 [info ] [MainThread]: Found 5 models, 16 data tests, 1 source, 502 macros
[0m00:42:13.543291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd61590>]}
[0m00:42:13.544275 [info ] [MainThread]: 
[0m00:42:13.544452 [info ] [MainThread]: Concurrency: 5 threads (target='dev_redshift')
[0m00:42:13.544582 [info ] [MainThread]: 
[0m00:42:13.544812 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:42:13.546605 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m00:42:13.554102 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m00:42:13.554320 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m00:42:13.554464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:13.554616 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:13.556366 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:15.182801 [debug] [ThreadPool]: SQL status: SUCCESS in 1.628 seconds
[0m00:42:15.226541 [debug] [ThreadPool]: On list_dev: Close
[0m00:42:15.227692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m00:42:15.232023 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:42:15.232231 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m00:42:15.232394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:42:15.232582 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:15.232827 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:16.875313 [debug] [ThreadPool]: SQL status: SUCCESS in 1.642 seconds
[0m00:42:16.877677 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:42:16.878486 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m00:42:17.208257 [debug] [ThreadPool]: SQL status: SUCCESS in 0.329 seconds
[0m00:42:17.212901 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m00:42:17.532157 [debug] [ThreadPool]: On list_dev_public: Close
[0m00:42:17.544742 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:17.545416 [debug] [MainThread]: On master: BEGIN
[0m00:42:17.545964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:42:17.546545 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:17.547149 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:20.412295 [debug] [MainThread]: SQL status: SUCCESS in 2.865 seconds
[0m00:42:20.414066 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:20.414577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:42:20.756134 [debug] [MainThread]: SQL status: SUCCESS in 0.341 seconds
[0m00:42:20.759515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf18910>]}
[0m00:42:20.760530 [debug] [MainThread]: On master: ROLLBACK
[0m00:42:21.062903 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:21.064997 [debug] [MainThread]: On master: BEGIN
[0m00:42:21.216578 [debug] [MainThread]: SQL status: SUCCESS in 0.150 seconds
[0m00:42:21.218297 [debug] [MainThread]: On master: COMMIT
[0m00:42:21.219393 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:21.220039 [debug] [MainThread]: On master: COMMIT
[0m00:42:21.524656 [debug] [MainThread]: SQL status: SUCCESS in 0.303 seconds
[0m00:42:21.525994 [debug] [MainThread]: On master: Close
[0m00:42:21.529506 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m00:42:21.530336 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m00:42:21.530998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.real_estate.staging_table)
[0m00:42:21.531424 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m00:42:21.535467 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m00:42:21.536963 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m00:42:21.615029 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m00:42:21.617348 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:21.617556 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:42:21.617778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:42:21.617981 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:21.618236 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:23.228446 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.610 seconds
[0m00:42:23.230860 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:23.231975 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table
    "dev"."public"."staging_table__dbt_tmp"
    
    
    
  as (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "dev"."public"."staging_table"
  );
[0m00:42:29.996526 [debug] [Thread-1 (]: SQL status: SUCCESS in 6.763 seconds
[0m00:42:30.008425 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:30.008876 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m00:42:30.942304 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.932 seconds
[0m00:42:30.949608 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:30.950207 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m00:42:31.421476 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.470 seconds
[0m00:42:31.447284 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:42:31.448068 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:31.448371 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:42:32.130097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.681 seconds
[0m00:42:32.133506 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:32.134222 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:42:32.447688 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.312 seconds
[0m00:42:32.457648 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."staging_table__dbt_backup"
[0m00:42:32.463057 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:32.463446 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
drop table if exists "dev"."public"."staging_table__dbt_backup" cascade
[0m00:42:32.776593 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.312 seconds
[0m00:42:32.783333 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:42:32.784350 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:32.785286 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:42:33.282659 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.496 seconds
[0m00:42:33.284322 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:42:33.284826 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:42:33.442015 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.156 seconds
[0m00:42:33.448689 [debug] [Thread-1 (]: On model.real_estate.staging_table: ROLLBACK
[0m00:42:33.760446 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m00:42:33.767193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e594c50>]}
[0m00:42:33.768501 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSUCCESS[0m in 12.23s]
[0m00:42:33.769341 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m00:42:33.770679 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m00:42:33.771211 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m00:42:33.771589 [debug] [Thread-5 (]: Began running node model.real_estate.dim_project
[0m00:42:33.772206 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m00:42:33.772978 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m00:42:33.773830 [info ] [Thread-5 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m00:42:33.774824 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.real_estate.dim_broker'
[0m00:42:33.775412 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.real_estate.dim_post'
[0m00:42:33.775919 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.real_estate.dim_project'
[0m00:42:33.776579 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m00:42:33.776946 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m00:42:33.777266 [debug] [Thread-5 (]: Began compiling node model.real_estate.dim_project
[0m00:42:33.781546 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m00:42:33.784262 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m00:42:33.786798 [debug] [Thread-5 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m00:42:33.788109 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m00:42:33.788529 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m00:42:33.788836 [debug] [Thread-5 (]: Began executing node model.real_estate.dim_project
[0m00:42:33.792710 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m00:42:33.795742 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m00:42:33.800318 [debug] [Thread-5 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m00:42:33.803995 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:42:33.805471 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:42:33.805723 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m00:42:33.807882 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:42:33.808120 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m00:42:33.808354 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:42:33.808572 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m00:42:33.808758 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:42:33.808979 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:33.809163 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:42:33.809358 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:33.809700 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:33.809907 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:33.810158 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:33.811169 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:35.379463 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.570 seconds
[0m00:42:35.383272 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:42:35.384062 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table
    "dev"."public"."dim_broker__dbt_tmp"
    
    
    
  as (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "dev"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
[0m00:42:35.455609 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.646 seconds
[0m00:42:35.456999 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:42:35.457659 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table
    "dev"."public"."dim_post__dbt_tmp"
    
    
    
  as (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "dev"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
[0m00:42:36.697113 [debug] [Thread-5 (]: SQL status: SUCCESS in 2.888 seconds
[0m00:42:36.699372 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:42:36.700110 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table
    "dev"."public"."dim_project__dbt_tmp"
    
    
    
  as (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "dev"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
[0m00:42:45.696371 [debug] [Thread-3 (]: Redshift adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table
    "dev"."public"."dim_broker__dbt_tmp"
    
    
    
  as (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "dev"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
[0m00:42:45.697910 [debug] [Thread-3 (]: Redshift adapter: Rolling back transaction.
[0m00:42:45.698662 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m00:42:45.703785 [debug] [Thread-3 (]: Failed to rollback 'model.real_estate.dim_broker'
[0m00:42:45.704150 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m00:42:45.706457 [debug] [Thread-3 (]: Runtime Error in model dim_broker (models/marts/dim_broker.sql)
  The read operation timed out
[0m00:42:45.706767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce51690>]}
[0m00:42:45.707104 [error] [Thread-3 (]: 2 of 5 ERROR creating sql table model public.dim_broker ........................ [[31mERROR[0m in 11.93s]
[0m00:42:45.707367 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m00:42:45.707622 [debug] [Thread-8 (]: Marking all children of 'model.real_estate.dim_broker' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_broker (models/marts/dim_broker.sql)
  The read operation timed out.
[0m00:42:45.786666 [debug] [Thread-4 (]: Redshift adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table
    "dev"."public"."dim_post__dbt_tmp"
    
    
    
  as (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "dev"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
[0m00:42:45.788071 [debug] [Thread-4 (]: Redshift adapter: Rolling back transaction.
[0m00:42:45.788639 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m00:42:45.790890 [debug] [Thread-4 (]: Failed to rollback 'model.real_estate.dim_post'
[0m00:42:45.791288 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m00:42:45.793319 [debug] [Thread-4 (]: Runtime Error in model dim_post (models/marts/dim_post.sql)
  The read operation timed out
[0m00:42:45.793635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce52890>]}
[0m00:42:45.794126 [error] [Thread-4 (]: 3 of 5 ERROR creating sql table model public.dim_post .......................... [[31mERROR[0m in 12.02s]
[0m00:42:45.794938 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m00:42:45.795673 [debug] [Thread-8 (]: Marking all children of 'model.real_estate.dim_post' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_post (models/marts/dim_post.sql)
  The read operation timed out.
[0m00:42:47.026823 [debug] [Thread-5 (]: Redshift adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table
    "dev"."public"."dim_project__dbt_tmp"
    
    
    
  as (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "dev"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
[0m00:42:47.028651 [debug] [Thread-5 (]: Redshift adapter: Rolling back transaction.
[0m00:42:47.029364 [debug] [Thread-5 (]: On model.real_estate.dim_project: ROLLBACK
[0m00:42:47.031674 [debug] [Thread-5 (]: Failed to rollback 'model.real_estate.dim_project'
[0m00:42:47.032047 [debug] [Thread-5 (]: On model.real_estate.dim_project: Close
[0m00:42:47.033725 [debug] [Thread-5 (]: Runtime Error in model dim_project (models/marts/dim_project.sql)
  The read operation timed out
[0m00:42:47.033996 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '025a775d-f757-41a9-89df-314bf2383ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d54c1d0>]}
[0m00:42:47.034321 [error] [Thread-5 (]: 4 of 5 ERROR creating sql table model public.dim_project ....................... [[31mERROR[0m in 13.26s]
[0m00:42:47.034586 [debug] [Thread-5 (]: Finished running node model.real_estate.dim_project
[0m00:42:47.034801 [debug] [Thread-8 (]: Marking all children of 'model.real_estate.dim_project' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_project (models/marts/dim_project.sql)
  The read operation timed out.
[0m00:42:47.035177 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m00:42:47.035459 [info ] [Thread-1 (]: 5 of 5 SKIP relation public.fact_all_apartment ................................. [[33mSKIP[0m]
[0m00:42:47.035698 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m00:42:47.036409 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:47.036555 [debug] [MainThread]: On master: BEGIN
[0m00:42:47.036677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:42:47.036817 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:42:47.037024 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:42:48.641624 [debug] [MainThread]: SQL status: SUCCESS in 1.605 seconds
[0m00:42:48.642957 [debug] [MainThread]: On master: COMMIT
[0m00:42:48.643881 [debug] [MainThread]: Using redshift connection "master"
[0m00:42:48.644342 [debug] [MainThread]: On master: COMMIT
[0m00:42:48.954938 [debug] [MainThread]: SQL status: SUCCESS in 0.310 seconds
[0m00:42:48.957186 [debug] [MainThread]: On master: Close
[0m00:42:48.959094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:48.959810 [debug] [MainThread]: Connection 'model.real_estate.staging_table' was properly closed.
[0m00:42:48.960217 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m00:42:48.960563 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m00:42:48.960906 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m00:42:48.961472 [info ] [MainThread]: 
[0m00:42:48.961935 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 35.42 seconds (35.42s).
[0m00:42:48.963118 [debug] [MainThread]: Command end result
[0m00:42:48.995629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:42:48.997379 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:42:49.001137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m00:42:49.001336 [info ] [MainThread]: 
[0m00:42:49.001563 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:42:49.001736 [info ] [MainThread]: 
[0m00:42:49.001938 [error] [MainThread]:   Runtime Error in model dim_broker (models/marts/dim_broker.sql)
  The read operation timed out
[0m00:42:49.002099 [info ] [MainThread]: 
[0m00:42:49.002294 [error] [MainThread]:   Runtime Error in model dim_post (models/marts/dim_post.sql)
  The read operation timed out
[0m00:42:49.002448 [info ] [MainThread]: 
[0m00:42:49.002621 [error] [MainThread]:   Runtime Error in model dim_project (models/marts/dim_project.sql)
  The read operation timed out
[0m00:42:49.002772 [info ] [MainThread]: 
[0m00:42:49.002939 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
[0m00:42:49.004268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 36.472507, "process_in_blocks": "0", "process_kernel_time": 0.266889, "process_mem_max_rss": "153174016", "process_out_blocks": "0", "process_user_time": 1.993257}
[0m00:42:49.004503 [debug] [MainThread]: Command `dbt run` failed at 00:42:49.004457 after 36.47 seconds
[0m00:42:49.004729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104547fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c98990>]}
[0m00:42:49.004943 [debug] [MainThread]: Flushing usage events
[0m00:42:50.002399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:27.259645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050de150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105145950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105145fd0>]}


============================== 00:45:27.262684 | cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8 ==============================
[0m00:45:27.262684 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:45:27.263023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --target dev_redshift', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:45:27.389334 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:45:27.389705 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:45:27.528034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f57610>]}
[0m00:45:27.552869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325c450>]}
[0m00:45:27.553573 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m00:45:27.614475 [debug] [MainThread]: checksum: d14ca3ebecd27f6d058b5f8da783370a5cb8a29c0ee296ecc351f7cd93d67ef1, vars: {}, profile: , target: dev_redshift, version: 1.9.2
[0m00:45:27.691142 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:45:27.691488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c5010>]}
[0m00:45:28.303769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107342910>]}
[0m00:45:28.344607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:45:28.345892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:45:28.353199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739d990>]}
[0m00:45:28.353484 [info ] [MainThread]: Found 5 models, 16 data tests, 1 source, 502 macros
[0m00:45:28.353658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033af750>]}
[0m00:45:28.354645 [info ] [MainThread]: 
[0m00:45:28.354827 [info ] [MainThread]: Concurrency: 5 threads (target='dev_redshift')
[0m00:45:28.354963 [info ] [MainThread]: 
[0m00:45:28.355182 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:45:28.356993 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m00:45:28.364918 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m00:45:28.365185 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m00:45:28.365329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:28.365478 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:28.367415 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:30.106311 [debug] [ThreadPool]: SQL status: SUCCESS in 1.741 seconds
[0m00:45:30.185703 [debug] [ThreadPool]: On list_dev: Close
[0m00:45:30.186627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m00:45:30.190233 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:45:30.190400 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m00:45:30.190527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:45:30.190667 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:30.190876 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:31.781941 [debug] [ThreadPool]: SQL status: SUCCESS in 1.591 seconds
[0m00:45:31.783172 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:45:31.783882 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m00:45:32.104638 [debug] [ThreadPool]: SQL status: SUCCESS in 0.320 seconds
[0m00:45:32.108380 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m00:45:32.417814 [debug] [ThreadPool]: On list_dev_public: Close
[0m00:45:32.433119 [debug] [MainThread]: Using redshift connection "master"
[0m00:45:32.433717 [debug] [MainThread]: On master: BEGIN
[0m00:45:32.434056 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:45:32.434420 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:32.434940 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:34.044557 [debug] [MainThread]: SQL status: SUCCESS in 1.610 seconds
[0m00:45:34.045834 [debug] [MainThread]: Using redshift connection "master"
[0m00:45:34.046896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:45:34.393666 [debug] [MainThread]: SQL status: SUCCESS in 0.346 seconds
[0m00:45:34.396957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c24d0>]}
[0m00:45:34.397717 [debug] [MainThread]: On master: ROLLBACK
[0m00:45:34.706785 [debug] [MainThread]: Using redshift connection "master"
[0m00:45:34.708060 [debug] [MainThread]: On master: BEGIN
[0m00:45:34.864206 [debug] [MainThread]: SQL status: SUCCESS in 0.155 seconds
[0m00:45:34.865206 [debug] [MainThread]: On master: COMMIT
[0m00:45:34.865924 [debug] [MainThread]: Using redshift connection "master"
[0m00:45:34.866373 [debug] [MainThread]: On master: COMMIT
[0m00:45:35.180228 [debug] [MainThread]: SQL status: SUCCESS in 0.312 seconds
[0m00:45:35.182220 [debug] [MainThread]: On master: Close
[0m00:45:35.186163 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m00:45:35.186987 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m00:45:35.187601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.real_estate.staging_table)
[0m00:45:35.187962 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m00:45:35.192217 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m00:45:35.193607 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m00:45:35.229645 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m00:45:35.231275 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:35.231544 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:45:35.231753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:35.231973 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:35.232263 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:38.045853 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.813 seconds
[0m00:45:38.047650 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:38.048258 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table
    "dev"."public"."staging_table__dbt_tmp"
    
    
    
  as (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "dev"."public"."staging_table"
  );
[0m00:45:41.824820 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.775 seconds
[0m00:45:41.832783 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:41.833176 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m00:45:42.719193 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.885 seconds
[0m00:45:42.727896 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:42.728490 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m00:45:43.172882 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.443 seconds
[0m00:45:43.196819 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:45:43.197487 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:43.197769 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:45:43.972262 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.773 seconds
[0m00:45:43.975465 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:43.976135 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:45:44.277059 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.299 seconds
[0m00:45:44.288798 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."staging_table__dbt_backup"
[0m00:45:44.296794 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:44.297240 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
drop table if exists "dev"."public"."staging_table__dbt_backup" cascade
[0m00:45:44.597141 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.299 seconds
[0m00:45:44.600785 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:45:44.601714 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:44.602401 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m00:45:45.095176 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.492 seconds
[0m00:45:45.098012 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m00:45:45.098970 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m00:45:45.247972 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.148 seconds
[0m00:45:45.255102 [debug] [Thread-1 (]: On model.real_estate.staging_table: ROLLBACK
[0m00:45:45.551878 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m00:45:45.559624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785a110>]}
[0m00:45:45.560901 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSUCCESS[0m in 10.37s]
[0m00:45:45.561702 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m00:45:45.562889 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m00:45:45.563352 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m00:45:45.563755 [debug] [Thread-5 (]: Began running node model.real_estate.dim_project
[0m00:45:45.564254 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m00:45:45.564822 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m00:45:45.565492 [info ] [Thread-5 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m00:45:45.566216 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.real_estate.dim_broker'
[0m00:45:45.566741 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.real_estate.dim_post'
[0m00:45:45.567211 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.real_estate.dim_project'
[0m00:45:45.567630 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m00:45:45.567966 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m00:45:45.568264 [debug] [Thread-5 (]: Began compiling node model.real_estate.dim_project
[0m00:45:45.572230 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m00:45:45.575339 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m00:45:45.578417 [debug] [Thread-5 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m00:45:45.580479 [debug] [Thread-5 (]: Began executing node model.real_estate.dim_project
[0m00:45:45.580857 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m00:45:45.581116 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m00:45:45.584300 [debug] [Thread-5 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m00:45:45.587184 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m00:45:45.589830 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m00:45:45.593242 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:45.593552 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m00:45:45.595678 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:45.597202 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:45.597408 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:45:45.597626 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m00:45:45.597843 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m00:45:45.598056 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:45.598250 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:45:45.598432 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:45:45.598716 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:45.598919 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:45.599115 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:45.600092 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:45.600388 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:47.240553 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.641 seconds
[0m00:45:47.242826 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:47.243928 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table
    "dev"."public"."dim_broker__dbt_tmp"
    
    
    
  as (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "dev"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
[0m00:45:47.268187 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.670 seconds
[0m00:45:47.269774 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:47.270927 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table
    "dev"."public"."dim_project__dbt_tmp"
    
    
    
  as (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "dev"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
[0m00:45:48.010313 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.765 seconds
[0m00:45:48.021531 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:48.022041 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
alter table "dev"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m00:45:48.236507 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.964 seconds
[0m00:45:48.246092 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:48.246581 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
alter table "dev"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m00:45:48.522421 [debug] [Thread-4 (]: SQL status: SUCCESS in 2.923 seconds
[0m00:45:48.525516 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:48.526081 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table
    "dev"."public"."dim_post__dbt_tmp"
    
    
    
  as (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "dev"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
[0m00:45:48.961695 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.939 seconds
[0m00:45:48.970085 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m00:45:48.972106 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:48.972489 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m00:45:49.193706 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.946 seconds
[0m00:45:49.198503 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m00:45:49.199211 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:49.199661 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m00:45:49.706974 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.733 seconds
[0m00:45:49.710197 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:49.711314 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m00:45:49.779856 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.253 seconds
[0m00:45:50.003442 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.803 seconds
[0m00:45:50.026149 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.314 seconds
[0m00:45:50.033044 [debug] [Thread-3 (]: Applying DROP to: "dev"."public"."dim_broker__dbt_backup"
[0m00:45:50.034813 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:50.035398 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "dev"."public"."dim_broker__dbt_backup" cascade
[0m00:45:50.350455 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.314 seconds
[0m00:45:50.355575 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m00:45:50.356323 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:50.356694 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m00:45:50.518636 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.161 seconds
[0m00:45:50.521293 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m00:45:50.521899 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m00:45:50.680780 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.156 seconds
[0m00:45:50.683802 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:50.684622 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:50.685311 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
alter table "dev"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m00:45:50.685825 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m00:45:51.009479 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.322 seconds
[0m00:45:51.019395 [debug] [Thread-5 (]: Applying DROP to: "dev"."public"."dim_project__dbt_backup"
[0m00:45:51.020485 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:51.020753 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
drop table if exists "dev"."public"."dim_project__dbt_backup" cascade
[0m00:45:51.340464 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.319 seconds
[0m00:45:51.343251 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m00:45:51.344134 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:51.344879 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m00:45:51.508223 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.162 seconds
[0m00:45:51.510723 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m00:45:51.511739 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m00:45:51.631743 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.945 seconds
[0m00:45:51.671348 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.159 seconds
[0m00:45:51.671936 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m00:45:51.672157 [debug] [Thread-5 (]: On model.real_estate.dim_project: ROLLBACK
[0m00:45:51.672376 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m00:45:51.672749 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:51.672931 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m00:45:51.985350 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m00:45:51.989303 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788a5d0>]}
[0m00:45:51.990788 [debug] [Thread-5 (]: On model.real_estate.dim_project: Close
[0m00:45:51.993484 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107833e50>]}
[0m00:45:51.992727 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSUCCESS[0m in 6.42s]
[0m00:45:51.994448 [info ] [Thread-5 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSUCCESS[0m in 6.43s]
[0m00:45:51.995189 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m00:45:51.995800 [debug] [Thread-5 (]: Finished running node model.real_estate.dim_project
[0m00:45:52.296941 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.623 seconds
[0m00:45:52.300164 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:52.301148 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m00:45:52.617206 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.315 seconds
[0m00:45:52.624601 [debug] [Thread-4 (]: Applying DROP to: "dev"."public"."dim_post__dbt_backup"
[0m00:45:52.626295 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:52.626750 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
drop table if exists "dev"."public"."dim_post__dbt_backup" cascade
[0m00:45:52.943124 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.315 seconds
[0m00:45:52.946706 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m00:45:52.947544 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:52.948009 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m00:45:53.114863 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.166 seconds
[0m00:45:53.117356 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m00:45:53.118336 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m00:45:53.277574 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.158 seconds
[0m00:45:53.280481 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m00:45:53.596844 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m00:45:53.601370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107830c90>]}
[0m00:45:53.602782 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSUCCESS[0m in 8.03s]
[0m00:45:53.603615 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m00:45:53.604844 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m00:45:53.605392 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m00:45:53.605951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m00:45:53.606338 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m00:45:53.611902 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m00:45:53.613266 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m00:45:53.617994 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m00:45:53.623343 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:45:53.623719 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m00:45:53.623995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:45:53.624304 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:45:53.624708 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:45:55.171982 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.547 seconds
[0m00:45:55.174316 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:45:55.175604 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table
    "dev"."public"."fact_all_apartment__dbt_tmp"
    
    
    
  as (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "dev"."public"."staging_table" s   
                    LEFT JOIN "dev"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "dev"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "dev"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
[0m00:46:10.837060 [debug] [Thread-1 (]: SQL status: SUCCESS in 15.660 seconds
[0m00:46:10.841785 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:10.842045 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "dev"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m00:46:11.727813 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.885 seconds
[0m00:46:11.733872 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m00:46:11.734808 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:11.735282 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m00:46:12.387069 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.651 seconds
[0m00:46:12.388913 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:12.389854 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m00:46:12.685264 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.295 seconds
[0m00:46:12.691786 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."fact_all_apartment__dbt_backup"
[0m00:46:12.692433 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:12.692615 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "dev"."public"."fact_all_apartment__dbt_backup" cascade
[0m00:46:12.989553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.296 seconds
[0m00:46:12.992344 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m00:46:12.993209 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:12.993780 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m00:46:13.146055 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.151 seconds
[0m00:46:13.147541 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m00:46:13.148696 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m00:46:13.299554 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.150 seconds
[0m00:46:13.301428 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m00:46:13.621809 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m00:46:13.623718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7107c2-a001-4b5d-b6e6-4b5bf2ebd4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ec4d0>]}
[0m00:46:13.624814 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSUCCESS[0m in 20.02s]
[0m00:46:13.626134 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m00:46:13.627687 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:13.627986 [debug] [MainThread]: On master: BEGIN
[0m00:46:13.628130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:46:13.628293 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:13.628517 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:15.173662 [debug] [MainThread]: SQL status: SUCCESS in 1.545 seconds
[0m00:46:15.174911 [debug] [MainThread]: On master: COMMIT
[0m00:46:15.175572 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:15.176033 [debug] [MainThread]: On master: COMMIT
[0m00:46:15.473319 [debug] [MainThread]: SQL status: SUCCESS in 0.297 seconds
[0m00:46:15.474537 [debug] [MainThread]: On master: Close
[0m00:46:15.475758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:15.476340 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m00:46:15.476819 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m00:46:15.477252 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m00:46:15.477653 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m00:46:15.477886 [info ] [MainThread]: 
[0m00:46:15.478065 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 47.12 seconds (47.12s).
[0m00:46:15.478600 [debug] [MainThread]: Command end result
[0m00:46:15.492541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:46:15.494708 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:46:15.497874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m00:46:15.498157 [info ] [MainThread]: 
[0m00:46:15.498400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:15.498555 [info ] [MainThread]: 
[0m00:46:15.498707 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:46:15.500517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 48.27988, "process_in_blocks": "0", "process_kernel_time": 0.336775, "process_mem_max_rss": "155648000", "process_out_blocks": "0", "process_user_time": 2.280863}
[0m00:46:15.500800 [debug] [MainThread]: Command `dbt run` succeeded at 00:46:15.500755 after 48.28 seconds
[0m00:46:15.500990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d8ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e225d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104555290>]}
[0m00:46:15.501181 [debug] [MainThread]: Flushing usage events
[0m00:46:16.970205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:30.253134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107695d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fe290>]}


============================== 00:46:30.255707 | eb811c5e-9935-4942-9bb2-74d6afd24dc6 ==============================
[0m00:46:30.255707 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:46:30.256036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --target dev_redshift', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:30.364712 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m00:46:30.365029 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m00:46:30.453122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073f350>]}
[0m00:46:30.478112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b40d0>]}
[0m00:46:30.479549 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m00:46:30.536479 [debug] [MainThread]: checksum: d14ca3ebecd27f6d058b5f8da783370a5cb8a29c0ee296ecc351f7cd93d67ef1, vars: {}, profile: , target: dev_redshift, version: 1.9.2
[0m00:46:30.650556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:30.650793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:30.671010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110fc150>]}
[0m00:46:30.710251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:46:30.711125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:46:30.724029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce1310>]}
[0m00:46:30.724295 [info ] [MainThread]: Found 5 models, 16 data tests, 1 source, 502 macros
[0m00:46:30.724463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f2a90>]}
[0m00:46:30.725609 [info ] [MainThread]: 
[0m00:46:30.725782 [info ] [MainThread]: Concurrency: 5 threads (target='dev_redshift')
[0m00:46:30.725914 [info ] [MainThread]: 
[0m00:46:30.726145 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:46:30.727976 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m00:46:30.736786 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:46:30.737036 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m00:46:30.737169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:30.737314 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:30.739455 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:32.279738 [debug] [ThreadPool]: SQL status: SUCCESS in 1.542 seconds
[0m00:46:32.281429 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m00:46:32.281977 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m00:46:32.590750 [debug] [ThreadPool]: SQL status: SUCCESS in 0.308 seconds
[0m00:46:32.626479 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m00:46:32.920716 [debug] [ThreadPool]: On list_dev_public: Close
[0m00:46:32.935662 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:32.936145 [debug] [MainThread]: On master: BEGIN
[0m00:46:32.936565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:46:32.936880 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:32.937327 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:35.877183 [debug] [MainThread]: SQL status: SUCCESS in 2.940 seconds
[0m00:46:35.880678 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:35.881415 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:46:36.229661 [debug] [MainThread]: SQL status: SUCCESS in 0.346 seconds
[0m00:46:36.234906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb811c5e-9935-4942-9bb2-74d6afd24dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cce7d0>]}
[0m00:46:36.235935 [debug] [MainThread]: On master: ROLLBACK
[0m00:46:36.545832 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:36.550424 [debug] [MainThread]: On master: BEGIN
[0m00:46:36.706475 [debug] [MainThread]: SQL status: SUCCESS in 0.155 seconds
[0m00:46:36.708373 [debug] [MainThread]: On master: COMMIT
[0m00:46:36.709574 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:36.710243 [debug] [MainThread]: On master: COMMIT
[0m00:46:37.018258 [debug] [MainThread]: SQL status: SUCCESS in 0.307 seconds
[0m00:46:37.020386 [debug] [MainThread]: On master: Close
[0m00:46:37.024820 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m00:46:37.025522 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5
[0m00:46:37.026076 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_broker_update_date.0700f46371
[0m00:46:37.026574 [debug] [Thread-4 (]: Began running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m00:46:37.028675 [debug] [Thread-5 (]: Began running node test.real_estate.not_null_dim_post_title.da11f83ad3
[0m00:46:37.029121 [info ] [Thread-1 (]: 1 of 16 START test not_null_dim_broker_broker_id ............................... [RUN]
[0m00:46:37.029800 [info ] [Thread-2 (]: 2 of 16 START test not_null_dim_broker_broker_name ............................. [RUN]
[0m00:46:37.030339 [info ] [Thread-3 (]: 3 of 16 START test not_null_dim_broker_update_date ............................. [RUN]
[0m00:46:37.030787 [info ] [Thread-4 (]: 4 of 16 START test not_null_dim_post_post_id ................................... [RUN]
[0m00:46:37.031241 [info ] [Thread-5 (]: 5 of 16 START test not_null_dim_post_title ..................................... [RUN]
[0m00:46:37.031826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now test.real_estate.not_null_dim_broker_broker_id.b2317a90a1)
[0m00:46:37.032407 [debug] [Thread-2 (]: Acquiring new redshift connection 'test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5'
[0m00:46:37.032918 [debug] [Thread-3 (]: Acquiring new redshift connection 'test.real_estate.not_null_dim_broker_update_date.0700f46371'
[0m00:46:37.033386 [debug] [Thread-4 (]: Acquiring new redshift connection 'test.real_estate.not_null_dim_post_post_id.5d776b2d46'
[0m00:46:37.033845 [debug] [Thread-5 (]: Acquiring new redshift connection 'test.real_estate.not_null_dim_post_title.da11f83ad3'
[0m00:46:37.034187 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m00:46:37.034497 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5
[0m00:46:37.034789 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_broker_update_date.0700f46371
[0m00:46:37.035068 [debug] [Thread-4 (]: Began compiling node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m00:46:37.035348 [debug] [Thread-5 (]: Began compiling node test.real_estate.not_null_dim_post_title.da11f83ad3
[0m00:46:37.047672 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m00:46:37.050898 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5"
[0m00:46:37.053917 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_broker_update_date.0700f46371"
[0m00:46:37.056702 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m00:46:37.059228 [debug] [Thread-5 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_title.da11f83ad3"
[0m00:46:37.060914 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_broker_update_date.0700f46371
[0m00:46:37.061232 [debug] [Thread-5 (]: Began executing node test.real_estate.not_null_dim_post_title.da11f83ad3
[0m00:46:37.070484 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_update_date.0700f46371"
[0m00:46:37.070732 [debug] [Thread-4 (]: Began executing node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m00:46:37.070938 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5
[0m00:46:37.072443 [debug] [Thread-5 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_title.da11f83ad3"
[0m00:46:37.072655 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m00:46:37.074062 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m00:46:37.075449 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5"
[0m00:46:37.076249 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_dim_broker_update_date.0700f46371"
[0m00:46:37.078471 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m00:46:37.079240 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.not_null_dim_post_title.da11f83ad3"
[0m00:46:37.079506 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_broker_update_date.0700f46371: BEGIN
[0m00:46:37.080272 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5"
[0m00:46:37.080472 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_title.da11f83ad3: BEGIN
[0m00:46:37.081202 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m00:46:37.081414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:46:37.082074 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m00:46:37.082258 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5: BEGIN
[0m00:46:37.082435 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m00:46:37.082613 [debug] [Thread-4 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: BEGIN
[0m00:46:37.082806 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:37.082984 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: BEGIN
[0m00:46:37.083149 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:46:37.083330 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:37.083493 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:46:37.083760 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:37.083943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:37.084129 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:37.084364 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:37.084543 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:37.085393 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:37.085742 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:37.086404 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:37.086893 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:38.646909 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.563 seconds
[0m00:46:38.649637 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.not_null_dim_post_title.da11f83ad3"
[0m00:46:38.650337 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_title.da11f83ad3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_post_title.da11f83ad3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select title
from "dev"."public"."dim_post"
where title is null



      
    ) dbt_internal_test
[0m00:46:38.691909 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.610 seconds
[0m00:46:38.693509 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_dim_broker_update_date.0700f46371"
[0m00:46:38.694137 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_broker_update_date.0700f46371: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_broker_update_date.0700f46371"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select update_date
from "dev"."public"."dim_broker"
where update_date is null



      
    ) dbt_internal_test
[0m00:46:38.701083 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.618 seconds
[0m00:46:38.701684 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5"
[0m00:46:38.702263 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_name
from "dev"."public"."dim_broker"
where broker_name is null



      
    ) dbt_internal_test
[0m00:46:38.707495 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.623 seconds
[0m00:46:38.708718 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"
[0m00:46:38.709911 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_broker_broker_id.b2317a90a1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "dev"."public"."dim_broker"
where broker_id is null



      
    ) dbt_internal_test
[0m00:46:38.726674 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.643 seconds
[0m00:46:38.728101 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.not_null_dim_post_post_id.5d776b2d46"
[0m00:46:38.728640 [debug] [Thread-4 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_post_post_id.5d776b2d46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."public"."dim_post"
where post_id is null



      
    ) dbt_internal_test
[0m00:46:39.287970 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.636 seconds
[0m00:46:39.289623 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.587 seconds
[0m00:46:39.290507 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.561 seconds
[0m00:46:39.292021 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.577 seconds
[0m00:46:39.297730 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_title.da11f83ad3: ROLLBACK
[0m00:46:39.298171 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.603 seconds
[0m00:46:39.299812 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5: ROLLBACK
[0m00:46:39.301137 [debug] [Thread-4 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: ROLLBACK
[0m00:46:39.302506 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: ROLLBACK
[0m00:46:39.303999 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_broker_update_date.0700f46371: ROLLBACK
[0m00:46:39.602438 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_title.da11f83ad3: Close
[0m00:46:39.605811 [info ] [Thread-5 (]: 5 of 16 PASS not_null_dim_post_title ........................................... [[32mPASS[0m in 2.57s]
[0m00:46:39.606889 [debug] [Thread-5 (]: Finished running node test.real_estate.not_null_dim_post_title.da11f83ad3
[0m00:46:39.607483 [debug] [Thread-5 (]: Began running node test.real_estate.not_null_dim_post_update_date.497b20bf12
[0m00:46:39.608058 [info ] [Thread-5 (]: 6 of 16 START test not_null_dim_post_update_date ............................... [RUN]
[0m00:46:39.608658 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_title.da11f83ad3, now test.real_estate.not_null_dim_post_update_date.497b20bf12)
[0m00:46:39.609066 [debug] [Thread-5 (]: Began compiling node test.real_estate.not_null_dim_post_update_date.497b20bf12
[0m00:46:39.616068 [debug] [Thread-5 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_update_date.497b20bf12"
[0m00:46:39.616984 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5: Close
[0m00:46:39.617442 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_broker_update_date.0700f46371: Close
[0m00:46:39.618105 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_broker_broker_id.b2317a90a1: Close
[0m00:46:39.619274 [info ] [Thread-2 (]: 2 of 16 PASS not_null_dim_broker_broker_name ................................... [[32mPASS[0m in 2.59s]
[0m00:46:39.619691 [debug] [Thread-5 (]: Began executing node test.real_estate.not_null_dim_post_update_date.497b20bf12
[0m00:46:39.620318 [debug] [Thread-4 (]: On test.real_estate.not_null_dim_post_post_id.5d776b2d46: Close
[0m00:46:39.621144 [info ] [Thread-3 (]: 3 of 16 PASS not_null_dim_broker_update_date ................................... [[32mPASS[0m in 2.59s]
[0m00:46:39.622605 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5
[0m00:46:39.622015 [info ] [Thread-1 (]: 1 of 16 PASS not_null_dim_broker_broker_id ..................................... [[32mPASS[0m in 2.59s]
[0m00:46:39.625735 [debug] [Thread-5 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_update_date.497b20bf12"
[0m00:46:39.626545 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_broker_update_date.0700f46371
[0m00:46:39.627003 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_dim_post_url.a0e99ba04f
[0m00:46:39.627637 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_broker_broker_id.b2317a90a1
[0m00:46:39.628157 [info ] [Thread-4 (]: 4 of 16 PASS not_null_dim_post_post_id ......................................... [[32mPASS[0m in 2.59s]
[0m00:46:39.628821 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m00:46:39.629241 [info ] [Thread-2 (]: 7 of 16 START test not_null_dim_post_url ....................................... [RUN]
[0m00:46:39.629677 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_dim_project_update_date.b82248cd18
[0m00:46:39.630946 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.not_null_dim_post_update_date.497b20bf12"
[0m00:46:39.631624 [debug] [Thread-4 (]: Finished running node test.real_estate.not_null_dim_post_post_id.5d776b2d46
[0m00:46:39.631902 [info ] [Thread-3 (]: 8 of 16 START test not_null_dim_project_project_id ............................. [RUN]
[0m00:46:39.632254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_name.77b02dc2d5, now test.real_estate.not_null_dim_post_url.a0e99ba04f)
[0m00:46:39.632550 [info ] [Thread-1 (]: 9 of 16 START test not_null_dim_project_update_date ............................ [RUN]
[0m00:46:39.632850 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_update_date.497b20bf12: BEGIN
[0m00:46:39.633183 [debug] [Thread-4 (]: Began running node test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48
[0m00:46:39.633514 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_update_date.0700f46371, now test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3)
[0m00:46:39.633790 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_dim_post_url.a0e99ba04f
[0m00:46:39.634178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_broker_broker_id.b2317a90a1, now test.real_estate.not_null_dim_project_update_date.b82248cd18)
[0m00:46:39.634520 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m00:46:39.634878 [info ] [Thread-4 (]: 10 of 16 START test not_null_fact_all_apartment_broker_id ...................... [RUN]
[0m00:46:39.635280 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m00:46:39.638821 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_dim_post_url.a0e99ba04f"
[0m00:46:39.639159 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_dim_project_update_date.b82248cd18
[0m00:46:39.639449 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:39.639745 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_post_id.5d776b2d46, now test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48)
[0m00:46:39.642859 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m00:46:39.646205 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_dim_project_update_date.b82248cd18"
[0m00:46:39.646639 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:39.646939 [debug] [Thread-4 (]: Began compiling node test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48
[0m00:46:39.647281 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_dim_post_url.a0e99ba04f
[0m00:46:39.648128 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m00:46:39.651136 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48"
[0m00:46:39.651415 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_dim_project_update_date.b82248cd18
[0m00:46:39.653148 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_dim_post_url.a0e99ba04f"
[0m00:46:39.654899 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m00:46:39.657998 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_dim_project_update_date.b82248cd18"
[0m00:46:39.658534 [debug] [Thread-4 (]: Began executing node test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48
[0m00:46:39.659788 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_dim_post_url.a0e99ba04f"
[0m00:46:39.662075 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_dim_project_update_date.b82248cd18"
[0m00:46:39.663564 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m00:46:39.665042 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48"
[0m00:46:39.666017 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_url.a0e99ba04f: BEGIN
[0m00:46:39.666480 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_project_update_date.b82248cd18: BEGIN
[0m00:46:39.666873 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: BEGIN
[0m00:46:39.668258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:46:39.669285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:39.670105 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48"
[0m00:46:39.670385 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:46:39.670626 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:39.670988 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:39.671232 [debug] [Thread-4 (]: On test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48: BEGIN
[0m00:46:39.671543 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:39.671808 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:39.672029 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:39.672197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:46:39.672397 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:39.673266 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:39.674281 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:41.261695 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.593 seconds
[0m00:46:41.263546 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_dim_post_url.a0e99ba04f"
[0m00:46:41.264483 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_url.a0e99ba04f: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_post_url.a0e99ba04f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select url
from "dev"."public"."dim_post"
where url is null



      
    ) dbt_internal_test
[0m00:46:41.269895 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.600 seconds
[0m00:46:41.271005 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_dim_project_update_date.b82248cd18"
[0m00:46:41.271667 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_project_update_date.b82248cd18: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_project_update_date.b82248cd18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select update_date
from "dev"."public"."dim_project"
where update_date is null



      
    ) dbt_internal_test
[0m00:46:41.278100 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.607 seconds
[0m00:46:41.279303 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"
[0m00:46:41.280103 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "dev"."public"."dim_project"
where project_id is null



      
    ) dbt_internal_test
[0m00:46:41.298229 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.663 seconds
[0m00:46:41.299955 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.627 seconds
[0m00:46:41.304958 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.not_null_dim_post_update_date.497b20bf12"
[0m00:46:41.305618 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48"
[0m00:46:41.306281 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_update_date.497b20bf12: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_dim_post_update_date.497b20bf12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select update_date
from "dev"."public"."dim_post"
where update_date is null



      
    ) dbt_internal_test
[0m00:46:41.306869 [debug] [Thread-4 (]: On test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select broker_id
from "dev"."public"."fact_all_apartment"
where broker_id is null



      
    ) dbt_internal_test
[0m00:46:41.595160 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.328 seconds
[0m00:46:41.599202 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_url.a0e99ba04f: ROLLBACK
[0m00:46:41.603815 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.332 seconds
[0m00:46:41.605271 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_project_update_date.b82248cd18: ROLLBACK
[0m00:46:41.614065 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.333 seconds
[0m00:46:41.616308 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: ROLLBACK
[0m00:46:41.653887 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.346 seconds
[0m00:46:41.654964 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.347 seconds
[0m00:46:41.657531 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_update_date.497b20bf12: ROLLBACK
[0m00:46:41.658809 [debug] [Thread-4 (]: On test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48: ROLLBACK
[0m00:46:41.905305 [debug] [Thread-2 (]: On test.real_estate.not_null_dim_post_url.a0e99ba04f: Close
[0m00:46:41.907047 [info ] [Thread-2 (]: 7 of 16 PASS not_null_dim_post_url ............................................. [[32mPASS[0m in 2.27s]
[0m00:46:41.907459 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_dim_post_url.a0e99ba04f
[0m00:46:41.907671 [debug] [Thread-2 (]: Began running node test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1
[0m00:46:41.907923 [info ] [Thread-2 (]: 11 of 16 START test not_null_fact_all_apartment_post_id ........................ [RUN]
[0m00:46:41.908184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_url.a0e99ba04f, now test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1)
[0m00:46:41.908360 [debug] [Thread-2 (]: Began compiling node test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1
[0m00:46:41.912155 [debug] [Thread-2 (]: Writing injected SQL for node "test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1"
[0m00:46:41.912764 [debug] [Thread-1 (]: On test.real_estate.not_null_dim_project_update_date.b82248cd18: Close
[0m00:46:41.913343 [info ] [Thread-1 (]: 9 of 16 PASS not_null_dim_project_update_date .................................. [[32mPASS[0m in 2.28s]
[0m00:46:41.913696 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_dim_project_update_date.b82248cd18
[0m00:46:41.913914 [debug] [Thread-1 (]: Began running node test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3
[0m00:46:41.914100 [info ] [Thread-1 (]: 12 of 16 START test not_null_fact_all_apartment_project_id ..................... [RUN]
[0m00:46:41.914376 [debug] [Thread-2 (]: Began executing node test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1
[0m00:46:41.914698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_update_date.b82248cd18, now test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3)
[0m00:46:41.916294 [debug] [Thread-2 (]: Writing runtime sql for node "test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1"
[0m00:46:41.916542 [debug] [Thread-1 (]: Began compiling node test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3
[0m00:46:41.919547 [debug] [Thread-1 (]: Writing injected SQL for node "test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3"
[0m00:46:41.920637 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1"
[0m00:46:41.920935 [debug] [Thread-2 (]: On test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1: BEGIN
[0m00:46:41.921114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:46:41.921297 [debug] [Thread-1 (]: Began executing node test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3
[0m00:46:41.921529 [debug] [Thread-2 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:41.923355 [debug] [Thread-1 (]: Writing runtime sql for node "test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3"
[0m00:46:41.923840 [debug] [Thread-2 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:41.926421 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3"
[0m00:46:41.926819 [debug] [Thread-3 (]: On test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3: Close
[0m00:46:41.927214 [debug] [Thread-1 (]: On test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3: BEGIN
[0m00:46:41.928221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:46:41.928033 [info ] [Thread-3 (]: 8 of 16 PASS not_null_dim_project_project_id ................................... [[32mPASS[0m in 2.29s]
[0m00:46:41.928580 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:41.928974 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3
[0m00:46:41.929405 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:41.929744 [debug] [Thread-3 (]: Began running node test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e
[0m00:46:41.932881 [info ] [Thread-3 (]: 13 of 16 START test not_null_fact_all_apartment_update_date .................... [RUN]
[0m00:46:41.933498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_project_project_id.d4ad8f6bc3, now test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e)
[0m00:46:41.935009 [debug] [Thread-3 (]: Began compiling node test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e
[0m00:46:41.938819 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e"
[0m00:46:41.939984 [debug] [Thread-3 (]: Began executing node test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e
[0m00:46:41.942454 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e"
[0m00:46:41.946507 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e"
[0m00:46:41.946842 [debug] [Thread-3 (]: On test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e: BEGIN
[0m00:46:41.947093 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:46:41.947341 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:41.947648 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:41.977491 [debug] [Thread-4 (]: On test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48: Close
[0m00:46:41.977903 [debug] [Thread-5 (]: On test.real_estate.not_null_dim_post_update_date.497b20bf12: Close
[0m00:46:41.978605 [info ] [Thread-4 (]: 10 of 16 PASS not_null_fact_all_apartment_broker_id ............................ [[32mPASS[0m in 2.34s]
[0m00:46:41.979009 [info ] [Thread-5 (]: 6 of 16 PASS not_null_dim_post_update_date ..................................... [[32mPASS[0m in 2.37s]
[0m00:46:41.979509 [debug] [Thread-4 (]: Finished running node test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48
[0m00:46:41.979847 [debug] [Thread-5 (]: Finished running node test.real_estate.not_null_dim_post_update_date.497b20bf12
[0m00:46:41.980105 [debug] [Thread-4 (]: Began running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m00:46:41.980404 [debug] [Thread-5 (]: Began running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m00:46:41.980683 [info ] [Thread-4 (]: 14 of 16 START test unique_dim_broker_broker_id ................................ [RUN]
[0m00:46:41.980951 [info ] [Thread-5 (]: 15 of 16 START test unique_dim_post_post_id .................................... [RUN]
[0m00:46:41.981230 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_fact_all_apartment_broker_id.bb13a8ed48, now test.real_estate.unique_dim_broker_broker_id.4fb11e03af)
[0m00:46:41.981467 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_dim_post_update_date.497b20bf12, now test.real_estate.unique_dim_post_post_id.91979bbf4d)
[0m00:46:41.981678 [debug] [Thread-4 (]: Began compiling node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m00:46:41.981901 [debug] [Thread-5 (]: Began compiling node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m00:46:41.986194 [debug] [Thread-4 (]: Writing injected SQL for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m00:46:41.988676 [debug] [Thread-5 (]: Writing injected SQL for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m00:46:41.989357 [debug] [Thread-4 (]: Began executing node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m00:46:41.989708 [debug] [Thread-5 (]: Began executing node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m00:46:41.991242 [debug] [Thread-4 (]: Writing runtime sql for node "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m00:46:41.992517 [debug] [Thread-5 (]: Writing runtime sql for node "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m00:46:41.993906 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m00:46:41.994917 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m00:46:41.995166 [debug] [Thread-5 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: BEGIN
[0m00:46:41.995389 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: BEGIN
[0m00:46:41.995596 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m00:46:41.995773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:46:41.995968 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:41.996169 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:41.996437 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:41.996681 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:43.519103 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.572 seconds
[0m00:46:43.520207 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e"
[0m00:46:43.520754 [debug] [Thread-3 (]: On test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select update_date
from "dev"."public"."fact_all_apartment"
where update_date is null



      
    ) dbt_internal_test
[0m00:46:43.540460 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.612 seconds
[0m00:46:43.541346 [debug] [Thread-1 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3"
[0m00:46:43.541884 [debug] [Thread-1 (]: On test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select project_id
from "dev"."public"."fact_all_apartment"
where project_id is null



      
    ) dbt_internal_test
[0m00:46:43.551775 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.630 seconds
[0m00:46:43.552478 [debug] [Thread-2 (]: Using redshift connection "test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1"
[0m00:46:43.552957 [debug] [Thread-2 (]: On test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select post_id
from "dev"."public"."fact_all_apartment"
where post_id is null



      
    ) dbt_internal_test
[0m00:46:43.618816 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.622 seconds
[0m00:46:43.620447 [debug] [Thread-4 (]: Using redshift connection "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"
[0m00:46:43.620998 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.unique_dim_broker_broker_id.4fb11e03af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    broker_id as unique_field,
    count(*) as n_records

from "dev"."public"."dim_broker"
where broker_id is not null
group by broker_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:46:43.653205 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.657 seconds
[0m00:46:43.654830 [debug] [Thread-5 (]: Using redshift connection "test.real_estate.unique_dim_post_post_id.91979bbf4d"
[0m00:46:43.655430 [debug] [Thread-5 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.unique_dim_post_post_id.91979bbf4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    post_id as unique_field,
    count(*) as n_records

from "dev"."public"."dim_post"
where post_id is not null
group by post_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:46:43.846882 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.325 seconds
[0m00:46:43.851354 [debug] [Thread-3 (]: On test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e: ROLLBACK
[0m00:46:43.873697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.330 seconds
[0m00:46:43.877649 [debug] [Thread-1 (]: On test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3: ROLLBACK
[0m00:46:43.888759 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.335 seconds
[0m00:46:43.892389 [debug] [Thread-2 (]: On test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1: ROLLBACK
[0m00:46:44.059243 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.437 seconds
[0m00:46:44.064697 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: ROLLBACK
[0m00:46:44.065529 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.410 seconds
[0m00:46:44.067679 [debug] [Thread-5 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: ROLLBACK
[0m00:46:44.163440 [debug] [Thread-3 (]: On test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e: Close
[0m00:46:44.166268 [info ] [Thread-3 (]: 13 of 16 PASS not_null_fact_all_apartment_update_date .......................... [[32mPASS[0m in 2.23s]
[0m00:46:44.166904 [debug] [Thread-3 (]: Finished running node test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e
[0m00:46:44.167243 [debug] [Thread-3 (]: Began running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m00:46:44.167702 [info ] [Thread-3 (]: 16 of 16 START test unique_dim_project_project_id .............................. [RUN]
[0m00:46:44.168295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.real_estate.not_null_fact_all_apartment_update_date.adc382e36e, now test.real_estate.unique_dim_project_project_id.87b4f343a2)
[0m00:46:44.168611 [debug] [Thread-3 (]: Began compiling node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m00:46:44.173007 [debug] [Thread-3 (]: Writing injected SQL for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m00:46:44.173834 [debug] [Thread-3 (]: Began executing node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m00:46:44.176982 [debug] [Thread-3 (]: Writing runtime sql for node "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m00:46:44.179234 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m00:46:44.179682 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: BEGIN
[0m00:46:44.179974 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:46:44.180299 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:44.180747 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:44.188868 [debug] [Thread-1 (]: On test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3: Close
[0m00:46:44.191355 [info ] [Thread-1 (]: 12 of 16 PASS not_null_fact_all_apartment_project_id ........................... [[32mPASS[0m in 2.28s]
[0m00:46:44.192267 [debug] [Thread-1 (]: Finished running node test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3
[0m00:46:44.208524 [debug] [Thread-2 (]: On test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1: Close
[0m00:46:44.209633 [info ] [Thread-2 (]: 11 of 16 PASS not_null_fact_all_apartment_post_id .............................. [[32mPASS[0m in 2.30s]
[0m00:46:44.210177 [debug] [Thread-2 (]: Finished running node test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1
[0m00:46:44.379361 [debug] [Thread-4 (]: On test.real_estate.unique_dim_broker_broker_id.4fb11e03af: Close
[0m00:46:44.380817 [info ] [Thread-4 (]: 14 of 16 PASS unique_dim_broker_broker_id ...................................... [[32mPASS[0m in 2.40s]
[0m00:46:44.381408 [debug] [Thread-4 (]: Finished running node test.real_estate.unique_dim_broker_broker_id.4fb11e03af
[0m00:46:44.388879 [debug] [Thread-5 (]: On test.real_estate.unique_dim_post_post_id.91979bbf4d: Close
[0m00:46:44.389609 [info ] [Thread-5 (]: 15 of 16 PASS unique_dim_post_post_id .......................................... [[32mPASS[0m in 2.41s]
[0m00:46:44.390371 [debug] [Thread-5 (]: Finished running node test.real_estate.unique_dim_post_post_id.91979bbf4d
[0m00:46:45.808186 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.627 seconds
[0m00:46:45.811187 [debug] [Thread-3 (]: Using redshift connection "test.real_estate.unique_dim_project_project_id.87b4f343a2"
[0m00:46:45.811886 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "test.real_estate.unique_dim_project_project_id.87b4f343a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    project_id as unique_field,
    count(*) as n_records

from "dev"."public"."dim_project"
where project_id is not null
group by project_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:46:46.153961 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.341 seconds
[0m00:46:46.158335 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: ROLLBACK
[0m00:46:46.471417 [debug] [Thread-3 (]: On test.real_estate.unique_dim_project_project_id.87b4f343a2: Close
[0m00:46:46.485771 [info ] [Thread-3 (]: 16 of 16 PASS unique_dim_project_project_id .................................... [[32mPASS[0m in 2.32s]
[0m00:46:46.486863 [debug] [Thread-3 (]: Finished running node test.real_estate.unique_dim_project_project_id.87b4f343a2
[0m00:46:46.488980 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:46.489277 [debug] [MainThread]: On master: BEGIN
[0m00:46:46.489461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:46:46.489660 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m00:46:46.490009 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:46:48.181212 [debug] [MainThread]: SQL status: SUCCESS in 1.691 seconds
[0m00:46:48.185979 [debug] [MainThread]: On master: COMMIT
[0m00:46:48.187006 [debug] [MainThread]: Using redshift connection "master"
[0m00:46:48.187425 [debug] [MainThread]: On master: COMMIT
[0m00:46:48.493426 [debug] [MainThread]: SQL status: SUCCESS in 0.305 seconds
[0m00:46:48.495320 [debug] [MainThread]: On master: Close
[0m00:46:48.496238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:48.496649 [debug] [MainThread]: Connection 'test.real_estate.not_null_fact_all_apartment_project_id.241402e5f3' was properly closed.
[0m00:46:48.497048 [debug] [MainThread]: Connection 'test.real_estate.not_null_fact_all_apartment_post_id.c306dfe3f1' was properly closed.
[0m00:46:48.497434 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_project_project_id.87b4f343a2' was properly closed.
[0m00:46:48.497781 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_broker_broker_id.4fb11e03af' was properly closed.
[0m00:46:48.498436 [debug] [MainThread]: Connection 'test.real_estate.unique_dim_post_post_id.91979bbf4d' was properly closed.
[0m00:46:48.498992 [info ] [MainThread]: 
[0m00:46:48.499408 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 17.77 seconds (17.77s).
[0m00:46:48.500702 [debug] [MainThread]: Command end result
[0m00:46:48.520275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m00:46:48.522250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m00:46:48.526546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m00:46:48.526933 [info ] [MainThread]: 
[0m00:46:48.527242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:48.527409 [info ] [MainThread]: 
[0m00:46:48.527569 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m00:46:48.529425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 18.310337, "process_in_blocks": "0", "process_kernel_time": 0.352635, "process_mem_max_rss": "162234368", "process_out_blocks": "0", "process_user_time": 1.710076}
[0m00:46:48.529743 [debug] [MainThread]: Command `dbt test` succeeded at 00:46:48.529695 after 18.31 seconds
[0m00:46:48.529993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e93fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f265d0>]}
[0m00:46:48.530231 [debug] [MainThread]: Flushing usage events
[0m00:46:49.557057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:11.234704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8966210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d422d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a5aab0>]}


============================== 17:53:11.240067 | 5676a48e-9f6f-4191-9cd4-6063b6615262 ==============================
[0m17:53:11.240067 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:53:11.240578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:11.240966 [info ] [MainThread]: dbt version: 1.5.0
[0m17:53:11.241274 [info ] [MainThread]: python version: 3.12.8
[0m17:53:11.241614 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:53:11.241890 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:53:11.242129 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:53:11.242384 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:53:11.242754 [info ] [MainThread]: Configuration:
[0m17:53:11.284980 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:53:11.296426 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:53:11.296792 [info ] [MainThread]: Required dependencies:
[0m17:53:11.297093 [debug] [MainThread]: Executing "git --help"
[0m17:53:11.297783 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:53:11.298151 [info ] [MainThread]: Connection:
[0m17:53:11.298449 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:53:11.298804 [info ] [MainThread]:   port: 5439
[0m17:53:11.299095 [info ] [MainThread]:   user: quyendinh
[0m17:53:11.299392 [info ] [MainThread]:   database: dev
[0m17:53:11.299692 [info ] [MainThread]:   schema: public
[0m17:53:11.299983 [info ] [MainThread]:   method: database
[0m17:53:11.300269 [info ] [MainThread]:   cluster_id: None
[0m17:53:11.300530 [info ] [MainThread]:   iam_profile: None
[0m17:53:11.300802 [info ] [MainThread]:   sslmode: verify-full
[0m17:53:11.301272 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:53:11.301732 [debug] [MainThread]: Using redshift connection "debug"
[0m17:53:11.301939 [debug] [MainThread]: On debug: select 1 as id
[0m17:53:11.302095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:11.302273 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:11.334095 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:53:11.334355 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:53:11.334532 [debug] [MainThread]: On debug: No close available on handle
[0m17:53:11.334698 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:53:11.334891 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:53:11.335124 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:53:11.335468 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:53:11.335962 [debug] [MainThread]: Command `dbt debug` failed at 17:53:11.335858 after 0.11 seconds
[0m17:53:11.336159 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:53:11.336329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8dd8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface9d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a404a0>]}
[0m17:53:11.336522 [debug] [MainThread]: Flushing usage events
[0m17:53:45.081867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9f9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d64d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acec800>]}


============================== 17:53:45.086258 | 58fdfb1c-f1ab-49b7-8fd9-8adbd8b4e3f5 ==============================
[0m17:53:45.086258 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:53:45.086630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:53:45.087031 [info ] [MainThread]: dbt version: 1.5.0
[0m17:53:45.087240 [info ] [MainThread]: python version: 3.12.8
[0m17:53:45.087445 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:53:45.087655 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:53:45.088036 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:53:45.088380 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:53:45.088657 [info ] [MainThread]: Configuration:
[0m17:53:45.130499 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:53:45.142283 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:53:45.142746 [info ] [MainThread]: Required dependencies:
[0m17:53:45.143121 [debug] [MainThread]: Executing "git --help"
[0m17:53:45.143766 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:53:45.144043 [info ] [MainThread]: Connection:
[0m17:53:45.144346 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:53:45.144604 [info ] [MainThread]:   port: 5439
[0m17:53:45.144924 [info ] [MainThread]:   user: quyendinh
[0m17:53:45.145251 [info ] [MainThread]:   database: dev
[0m17:53:45.145540 [info ] [MainThread]:   schema: public
[0m17:53:45.145860 [info ] [MainThread]:   method: database
[0m17:53:45.146131 [info ] [MainThread]:   cluster_id: None
[0m17:53:45.146406 [info ] [MainThread]:   iam_profile: None
[0m17:53:45.146629 [info ] [MainThread]:   sslmode: verify-full
[0m17:53:45.147079 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:53:45.147430 [debug] [MainThread]: Using redshift connection "debug"
[0m17:53:45.147588 [debug] [MainThread]: On debug: select 1 as id
[0m17:53:45.147722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:45.147883 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:53:45.176488 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:53:45.176810 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:53:45.177009 [debug] [MainThread]: On debug: No close available on handle
[0m17:53:45.177170 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:53:45.177366 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:53:45.177821 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:53:45.178092 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:53:45.178505 [debug] [MainThread]: Command `dbt debug` failed at 17:53:45.178445 after 0.10 seconds
[0m17:53:45.178669 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:53:45.178826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d64d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef6a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7acec800>]}
[0m17:53:45.179037 [debug] [MainThread]: Flushing usage events
[0m17:54:15.325470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab73e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf520f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9f2030>]}


============================== 17:54:15.329674 | 2b544caf-3920-49f5-af2f-72d68166aedc ==============================
[0m17:54:15.329674 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:54:15.330024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:54:15.330305 [info ] [MainThread]: dbt version: 1.5.0
[0m17:54:15.330534 [info ] [MainThread]: python version: 3.12.8
[0m17:54:15.330758 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:54:15.331175 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:54:15.331546 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:54:15.331925 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:54:15.332239 [info ] [MainThread]: Configuration:
[0m17:54:15.353604 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:54:15.364393 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:54:15.364676 [info ] [MainThread]: Required dependencies:
[0m17:54:15.364973 [debug] [MainThread]: Executing "git --help"
[0m17:54:15.365570 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:54:15.365809 [info ] [MainThread]: Connection:
[0m17:54:15.366062 [info ] [MainThread]:   host: localhost
[0m17:54:15.366352 [info ] [MainThread]:   port: 5432
[0m17:54:15.366678 [info ] [MainThread]:   user: airflow
[0m17:54:15.366986 [info ] [MainThread]:   database: re
[0m17:54:15.367265 [info ] [MainThread]:   schema: public
[0m17:54:15.367573 [info ] [MainThread]:   search_path: None
[0m17:54:15.367845 [info ] [MainThread]:   keepalives_idle: 0
[0m17:54:15.368145 [info ] [MainThread]:   sslmode: None
[0m17:54:15.368632 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:54:15.368827 [debug] [MainThread]: Using postgres connection "debug"
[0m17:54:15.369048 [debug] [MainThread]: On debug: select 1 as id
[0m17:54:15.369210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:15.369763 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:54:15.370633 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:54:15.370807 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:54:15.370999 [debug] [MainThread]: On debug: No close available on handle
[0m17:54:15.371154 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:54:15.371375 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:54:15.371631 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:54:15.371898 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:54:15.372414 [debug] [MainThread]: Command `dbt debug` failed at 17:54:15.372341 after 0.05 seconds
[0m17:54:15.372619 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:54:15.372795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5e88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad73680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac7e2a0>]}
[0m17:54:15.373006 [debug] [MainThread]: Flushing usage events
[0m17:54:49.474362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aaee090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aae5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abe2960>]}


============================== 17:54:49.480204 | c64feea8-bef7-4a1c-962a-48c57a77c628 ==============================
[0m17:54:49.480204 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:54:49.480532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:54:49.480839 [info ] [MainThread]: dbt version: 1.5.0
[0m17:54:49.481095 [info ] [MainThread]: python version: 3.12.8
[0m17:54:49.481376 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:54:49.481622 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:54:49.481862 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:54:49.482151 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:54:49.482454 [info ] [MainThread]: Configuration:
[0m17:54:49.522313 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:54:49.533182 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:54:49.533476 [info ] [MainThread]: Required dependencies:
[0m17:54:49.533773 [debug] [MainThread]: Executing "git --help"
[0m17:54:49.534391 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:54:49.534613 [info ] [MainThread]: Connection:
[0m17:54:49.534892 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:54:49.535185 [info ] [MainThread]:   port: 5439
[0m17:54:49.535574 [info ] [MainThread]:   user: quyendinh
[0m17:54:49.535909 [info ] [MainThread]:   database: dev
[0m17:54:49.536230 [info ] [MainThread]:   schema: public
[0m17:54:49.536531 [info ] [MainThread]:   method: database
[0m17:54:49.536799 [info ] [MainThread]:   cluster_id: None
[0m17:54:49.537063 [info ] [MainThread]:   iam_profile: None
[0m17:54:49.537315 [info ] [MainThread]:   sslmode: verify-full
[0m17:54:49.537806 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:54:49.538233 [debug] [MainThread]: Using redshift connection "debug"
[0m17:54:49.538519 [debug] [MainThread]: On debug: select 1 as id
[0m17:54:49.538680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:49.538862 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:54:49.567728 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:54:49.568013 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:54:49.568199 [debug] [MainThread]: On debug: No close available on handle
[0m17:54:49.568374 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:54:49.568673 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:54:49.568977 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:54:49.569328 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:54:49.569805 [debug] [MainThread]: Command `dbt debug` failed at 17:54:49.569728 after 0.10 seconds
[0m17:54:49.570023 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:54:49.570259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7e8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac3cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac3d610>]}
[0m17:54:49.570520 [debug] [MainThread]: Flushing usage events
[0m17:57:41.218905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac865e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccae750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac865f40>]}


============================== 17:57:41.223266 | d80be4d3-8d07-4278-b0bc-808d3d710004 ==============================
[0m17:57:41.223266 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:41.223744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:41.224087 [info ] [MainThread]: dbt version: 1.5.0
[0m17:57:41.224407 [info ] [MainThread]: python version: 3.12.8
[0m17:57:41.224753 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:57:41.225030 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:57:41.225391 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:57:41.225680 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:57:41.225932 [info ] [MainThread]: Configuration:
[0m17:57:41.267033 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:41.278289 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:41.278617 [info ] [MainThread]: Required dependencies:
[0m17:57:41.279053 [debug] [MainThread]: Executing "git --help"
[0m17:57:41.279803 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:57:41.280037 [info ] [MainThread]: Connection:
[0m17:57:41.280401 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:57:41.280669 [info ] [MainThread]:   port: 5439
[0m17:57:41.280961 [info ] [MainThread]:   user: quyendinh
[0m17:57:41.281269 [info ] [MainThread]:   database: dev
[0m17:57:41.281555 [info ] [MainThread]:   schema: public
[0m17:57:41.281835 [info ] [MainThread]:   method: database
[0m17:57:41.282121 [info ] [MainThread]:   cluster_id: None
[0m17:57:41.282410 [info ] [MainThread]:   iam_profile: None
[0m17:57:41.282633 [info ] [MainThread]:   sslmode: verify-full
[0m17:57:41.283036 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:57:41.283414 [debug] [MainThread]: Using redshift connection "debug"
[0m17:57:41.283572 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:41.283713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:41.283878 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:57:41.312546 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:57:41.312805 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:57:41.312971 [debug] [MainThread]: On debug: No close available on handle
[0m17:57:41.313169 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:57:41.313398 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:57:41.313621 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:57:41.313980 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:57:41.314404 [debug] [MainThread]: Command `dbt debug` failed at 17:57:41.314314 after 0.10 seconds
[0m17:57:41.314598 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:41.314765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad00f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccae750>]}
[0m17:57:41.314972 [debug] [MainThread]: Flushing usage events
[0m17:57:56.008657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9ff020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeaf2960>]}


============================== 17:57:56.012756 | e38e1047-0209-4f7d-8f7d-07236c8c43cf ==============================
[0m17:57:56.012756 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:57:56.013122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:57:56.013416 [info ] [MainThread]: dbt version: 1.5.0
[0m17:57:56.013644 [info ] [MainThread]: python version: 3.12.8
[0m17:57:56.013946 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:57:56.014285 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:57:56.014756 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:57:56.015007 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:57:56.015309 [info ] [MainThread]: Configuration:
[0m17:57:56.036356 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:56.046946 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:56.047233 [info ] [MainThread]: Required dependencies:
[0m17:57:56.047529 [debug] [MainThread]: Executing "git --help"
[0m17:57:56.048226 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:57:56.048431 [info ] [MainThread]: Connection:
[0m17:57:56.048715 [info ] [MainThread]:   host: localhost
[0m17:57:56.048983 [info ] [MainThread]:   port: 5432
[0m17:57:56.049259 [info ] [MainThread]:   user: airflow
[0m17:57:56.049566 [info ] [MainThread]:   database: re
[0m17:57:56.049807 [info ] [MainThread]:   schema: public
[0m17:57:56.050051 [info ] [MainThread]:   search_path: None
[0m17:57:56.050296 [info ] [MainThread]:   keepalives_idle: 0
[0m17:57:56.050515 [info ] [MainThread]:   sslmode: None
[0m17:57:56.050969 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:57:56.051168 [debug] [MainThread]: Using postgres connection "debug"
[0m17:57:56.051336 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:56.051477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:56.051960 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m17:57:56.053502 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:57:56.053683 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:57:56.053843 [debug] [MainThread]: On debug: No close available on handle
[0m17:57:56.053987 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:57:56.054185 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:57:56.054370 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:57:56.054645 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:57:56.055086 [debug] [MainThread]: Command `dbt debug` failed at 17:57:56.054996 after 0.05 seconds
[0m17:57:56.055252 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:56.055426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb138c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf547b60>]}
[0m17:57:56.055624 [debug] [MainThread]: Flushing usage events
[0m17:58:07.363599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9156a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d18cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d6bede0>]}


============================== 17:58:07.367819 | 9c95c741-76ac-40c2-a080-c5e3a1a43723 ==============================
[0m17:58:07.367819 [info ] [MainThread]: Running with dbt=1.5.0
[0m17:58:07.368183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:58:07.368496 [info ] [MainThread]: dbt version: 1.5.0
[0m17:58:07.368717 [info ] [MainThread]: python version: 3.12.8
[0m17:58:07.369089 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m17:58:07.369430 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m17:58:07.369713 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m17:58:07.370050 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m17:58:07.370249 [info ] [MainThread]: Configuration:
[0m17:58:07.410698 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:58:07.421443 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:58:07.421703 [info ] [MainThread]: Required dependencies:
[0m17:58:07.422003 [debug] [MainThread]: Executing "git --help"
[0m17:58:07.422648 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:58:07.422884 [info ] [MainThread]: Connection:
[0m17:58:07.423173 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m17:58:07.423486 [info ] [MainThread]:   port: 5439
[0m17:58:07.423782 [info ] [MainThread]:   user: quyendinh
[0m17:58:07.424050 [info ] [MainThread]:   database: dev
[0m17:58:07.424297 [info ] [MainThread]:   schema: public
[0m17:58:07.424604 [info ] [MainThread]:   method: database
[0m17:58:07.424930 [info ] [MainThread]:   cluster_id: None
[0m17:58:07.425218 [info ] [MainThread]:   iam_profile: None
[0m17:58:07.425504 [info ] [MainThread]:   sslmode: verify-full
[0m17:58:07.425933 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m17:58:07.426284 [debug] [MainThread]: Using redshift connection "debug"
[0m17:58:07.426459 [debug] [MainThread]: On debug: select 1 as id
[0m17:58:07.426623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:07.426826 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m17:58:07.455296 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m17:58:07.455566 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m17:58:07.455738 [debug] [MainThread]: On debug: No close available on handle
[0m17:58:07.455894 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:58:07.456113 [info ] [MainThread]: [31m2 checks failed:[0m
[0m17:58:07.456339 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m17:58:07.456678 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:58:07.457096 [debug] [MainThread]: Command `dbt debug` failed at 17:58:07.457029 after 0.10 seconds
[0m17:58:07.457278 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:58:07.457517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d12c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9156a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1f2ab0>]}
[0m17:58:07.457736 [debug] [MainThread]: Flushing usage events
[0m01:00:55.055604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108877fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108874910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088de550>]}


============================== 01:00:55.058972 | 1d2e8629-5016-41cb-a07f-c406ffddc8d6 ==============================
[0m01:00:55.058972 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:00:55.059383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --target dev_redshift -f', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:00:55.191699 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:00:55.192066 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:00:55.334763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a3a90>]}
[0m01:00:55.361742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069dbdd0>]}
[0m01:00:55.362626 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m01:00:55.422992 [debug] [MainThread]: checksum: d14ca3ebecd27f6d058b5f8da783370a5cb8a29c0ee296ecc351f7cd93d67ef1, vars: {}, profile: , target: dev_redshift, version: 1.9.2
[0m01:00:55.549977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:00:55.550237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:00:55.571620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a832d50>]}
[0m01:00:55.614033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m01:00:55.615552 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m01:00:55.623139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b5810>]}
[0m01:00:55.623454 [info ] [MainThread]: Found 5 models, 16 data tests, 1 source, 502 macros
[0m01:00:55.623639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896e710>]}
[0m01:00:55.624706 [info ] [MainThread]: 
[0m01:00:55.624921 [info ] [MainThread]: Concurrency: 5 threads (target='dev_redshift')
[0m01:00:55.625064 [info ] [MainThread]: 
[0m01:00:55.625326 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:00:55.627224 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:00:55.636324 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:00:55.636588 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:00:55.636727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:00:55.636880 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:00:55.639027 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:00:57.369149 [debug] [ThreadPool]: SQL status: SUCCESS in 1.732 seconds
[0m01:00:57.409244 [debug] [ThreadPool]: On list_dev: Close
[0m01:00:57.410425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m01:00:57.415057 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:00:57.415267 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m01:00:57.415432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:00:57.415609 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:00:57.415869 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:00:59.034096 [debug] [ThreadPool]: SQL status: SUCCESS in 1.618 seconds
[0m01:00:59.036515 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:00:59.037190 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m01:00:59.361289 [debug] [ThreadPool]: SQL status: SUCCESS in 0.323 seconds
[0m01:00:59.366716 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m01:00:59.679217 [debug] [ThreadPool]: On list_dev_public: Close
[0m01:00:59.697104 [debug] [MainThread]: Using redshift connection "master"
[0m01:00:59.697796 [debug] [MainThread]: On master: BEGIN
[0m01:00:59.698122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:00:59.698479 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:00:59.699014 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:01.328035 [debug] [MainThread]: SQL status: SUCCESS in 1.630 seconds
[0m01:01:01.328484 [debug] [MainThread]: Using redshift connection "master"
[0m01:01:01.328767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:01:01.686466 [debug] [MainThread]: SQL status: SUCCESS in 0.357 seconds
[0m01:01:01.687887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d19b10>]}
[0m01:01:01.688323 [debug] [MainThread]: On master: ROLLBACK
[0m01:01:02.002756 [debug] [MainThread]: Using redshift connection "master"
[0m01:01:02.004475 [debug] [MainThread]: On master: BEGIN
[0m01:01:02.162587 [debug] [MainThread]: SQL status: SUCCESS in 0.157 seconds
[0m01:01:02.164766 [debug] [MainThread]: On master: COMMIT
[0m01:01:02.166377 [debug] [MainThread]: Using redshift connection "master"
[0m01:01:02.166914 [debug] [MainThread]: On master: COMMIT
[0m01:01:02.483010 [debug] [MainThread]: SQL status: SUCCESS in 0.313 seconds
[0m01:01:02.485029 [debug] [MainThread]: On master: Close
[0m01:01:02.488682 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m01:01:02.489553 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m01:01:02.490185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.real_estate.staging_table)
[0m01:01:02.490613 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m01:01:02.495006 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m01:01:02.496581 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m01:01:02.532470 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m01:01:02.535986 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:02.536237 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:01:02.536434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:02.536643 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:02.536926 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:04.095112 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.558 seconds
[0m01:01:04.096267 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:04.097014 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table
    "dev"."public"."staging_table__dbt_tmp"
    
    
    
  as (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "dev"."public"."staging_table"
  );
[0m01:01:04.633180 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.534 seconds
[0m01:01:04.646521 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:04.647274 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m01:01:05.538971 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.891 seconds
[0m01:01:05.548907 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:05.549669 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m01:01:05.998638 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.449 seconds
[0m01:01:06.010837 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:01:06.011229 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:06.011420 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:01:06.660891 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.645 seconds
[0m01:01:06.662678 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:06.663165 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:01:06.976838 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.313 seconds
[0m01:01:06.985935 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."staging_table__dbt_backup"
[0m01:01:06.991814 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:06.992266 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
drop table if exists "dev"."public"."staging_table__dbt_backup" cascade
[0m01:01:07.296259 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.303 seconds
[0m01:01:07.298105 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:01:07.298810 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:07.299287 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:01:07.831941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.531 seconds
[0m01:01:07.834372 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:01:07.835292 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:01:07.986237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.149 seconds
[0m01:01:07.990893 [debug] [Thread-1 (]: On model.real_estate.staging_table: ROLLBACK
[0m01:01:08.294135 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m01:01:08.298670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af72e50>]}
[0m01:01:08.300142 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSUCCESS[0m in 5.81s]
[0m01:01:08.300847 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m01:01:08.302118 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m01:01:08.302696 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m01:01:08.303196 [debug] [Thread-5 (]: Began running node model.real_estate.dim_project
[0m01:01:08.303911 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m01:01:08.304549 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m01:01:08.305114 [info ] [Thread-5 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m01:01:08.306293 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.real_estate.dim_broker'
[0m01:01:08.306814 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.real_estate.dim_post'
[0m01:01:08.307236 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.real_estate.dim_project'
[0m01:01:08.307769 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m01:01:08.308219 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m01:01:08.308547 [debug] [Thread-5 (]: Began compiling node model.real_estate.dim_project
[0m01:01:08.312474 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m01:01:08.315319 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m01:01:08.317921 [debug] [Thread-5 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m01:01:08.319027 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m01:01:08.319362 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m01:01:08.322422 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m01:01:08.322726 [debug] [Thread-5 (]: Began executing node model.real_estate.dim_project
[0m01:01:08.325886 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m01:01:08.330323 [debug] [Thread-5 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m01:01:08.332867 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:08.333318 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:01:08.334803 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:08.335085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:01:08.337932 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:08.338154 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:01:08.338389 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:08.338592 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:01:08.338775 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:01:08.339063 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:08.339277 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:01:08.339503 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:08.340186 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:08.340724 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:08.341045 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:09.895534 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.556 seconds
[0m01:01:09.896847 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:09.897883 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table
    "dev"."public"."dim_broker__dbt_tmp"
    
    
    
  as (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "dev"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
[0m01:01:09.899338 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.560 seconds
[0m01:01:09.900090 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:09.900960 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table
    "dev"."public"."dim_project__dbt_tmp"
    
    
    
  as (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "dev"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
[0m01:01:09.944251 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.609 seconds
[0m01:01:09.945520 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:09.946566 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table
    "dev"."public"."dim_post__dbt_tmp"
    
    
    
  as (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "dev"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
[0m01:01:10.300273 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.401 seconds
[0m01:01:10.307343 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:10.307956 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
alter table "dev"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m01:01:10.308393 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.407 seconds
[0m01:01:10.312699 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:10.313258 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
alter table "dev"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m01:01:10.346165 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.399 seconds
[0m01:01:10.350890 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:10.351329 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
alter table "dev"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m01:01:11.196420 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.887 seconds
[0m01:01:11.198708 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:01:11.199160 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:11.199408 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:01:11.202678 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.889 seconds
[0m01:01:11.203861 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:01:11.204168 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:11.204391 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:01:11.278373 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.926 seconds
[0m01:01:11.281747 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:01:11.282423 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:11.282691 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:01:11.960846 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.761 seconds
[0m01:01:11.963059 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:11.964644 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:01:12.261575 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.296 seconds
[0m01:01:12.268228 [debug] [Thread-3 (]: Applying DROP to: "dev"."public"."dim_broker__dbt_backup"
[0m01:01:12.269596 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:12.269954 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "dev"."public"."dim_broker__dbt_backup" cascade
[0m01:01:12.487331 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.283 seconds
[0m01:01:12.488006 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.205 seconds
[0m01:01:12.572448 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.301 seconds
[0m01:01:12.577331 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:01:12.577976 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:12.578209 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:01:12.735763 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.157 seconds
[0m01:01:12.736671 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:01:12.736953 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:01:12.886021 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.149 seconds
[0m01:01:12.887103 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:12.887347 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:01:13.185283 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.298 seconds
[0m01:01:13.189500 [debug] [Thread-5 (]: Applying DROP to: "dev"."public"."dim_project__dbt_backup"
[0m01:01:13.190976 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:13.191387 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
drop table if exists "dev"."public"."dim_project__dbt_backup" cascade
[0m01:01:13.495706 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.301 seconds
[0m01:01:13.497099 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:01:13.497464 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:13.497671 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:01:13.652469 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.154 seconds
[0m01:01:13.653039 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:01:13.653231 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:01:13.806447 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.152 seconds
[0m01:01:13.810475 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:13.810799 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:01:14.121534 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.310 seconds
[0m01:01:14.126823 [debug] [Thread-4 (]: Applying DROP to: "dev"."public"."dim_post__dbt_backup"
[0m01:01:14.127794 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:14.128067 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
drop table if exists "dev"."public"."dim_post__dbt_backup" cascade
[0m01:01:14.439043 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.310 seconds
[0m01:01:14.442962 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:01:14.443716 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:14.444065 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:01:14.604215 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.159 seconds
[0m01:01:14.607429 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:01:14.608026 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:01:14.762703 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.154 seconds
[0m01:01:14.766218 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m01:01:14.766797 [debug] [Thread-5 (]: On model.real_estate.dim_project: ROLLBACK
[0m01:01:14.767437 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m01:01:15.067080 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m01:01:15.069657 [debug] [Thread-5 (]: On model.real_estate.dim_project: Close
[0m01:01:15.071863 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ab410>]}
[0m01:01:15.072686 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0c4590>]}
[0m01:01:15.073837 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSUCCESS[0m in 6.77s]
[0m01:01:15.074882 [info ] [Thread-5 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSUCCESS[0m in 6.77s]
[0m01:01:15.075731 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m01:01:15.076365 [debug] [Thread-5 (]: Finished running node model.real_estate.dim_project
[0m01:01:15.076837 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m01:01:15.077957 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0e1bd0>]}
[0m01:01:15.078665 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSUCCESS[0m in 6.77s]
[0m01:01:15.079264 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m01:01:15.080120 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m01:01:15.080595 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m01:01:15.081452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m01:01:15.082023 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m01:01:15.086548 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m01:01:15.088809 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m01:01:15.094783 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m01:01:15.100064 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:15.100505 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:01:15.100761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:01:15.101027 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:15.101369 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:16.706107 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.605 seconds
[0m01:01:16.706687 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:16.706907 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table
    "dev"."public"."fact_all_apartment__dbt_tmp"
    
    
    
  as (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "dev"."public"."staging_table" s   
                    LEFT JOIN "dev"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "dev"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "dev"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
[0m01:01:17.317760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.611 seconds
[0m01:01:17.320377 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:17.320640 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "dev"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m01:01:18.248536 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.926 seconds
[0m01:01:18.252127 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:01:18.252754 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:18.253007 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:01:19.070667 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.817 seconds
[0m01:01:19.072735 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:19.073562 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:01:19.383194 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.308 seconds
[0m01:01:19.387167 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."fact_all_apartment__dbt_backup"
[0m01:01:19.387888 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:19.388067 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "dev"."public"."fact_all_apartment__dbt_backup" cascade
[0m01:01:19.699315 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.311 seconds
[0m01:01:19.701247 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:01:19.701940 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:19.702160 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:01:19.862043 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.159 seconds
[0m01:01:19.863238 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:01:19.863753 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:01:20.018692 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.154 seconds
[0m01:01:20.020231 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m01:01:20.328293 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m01:01:20.329142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2e8629-5016-41cb-a07f-c406ffddc8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d3750>]}
[0m01:01:20.329644 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSUCCESS[0m in 5.25s]
[0m01:01:20.330075 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m01:01:20.331478 [debug] [MainThread]: Using redshift connection "master"
[0m01:01:20.331794 [debug] [MainThread]: On master: BEGIN
[0m01:01:20.331994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:01:20.332217 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:01:20.332573 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:01:21.931629 [debug] [MainThread]: SQL status: SUCCESS in 1.599 seconds
[0m01:01:21.933159 [debug] [MainThread]: On master: COMMIT
[0m01:01:21.934163 [debug] [MainThread]: Using redshift connection "master"
[0m01:01:21.934651 [debug] [MainThread]: On master: COMMIT
[0m01:01:22.245595 [debug] [MainThread]: SQL status: SUCCESS in 0.310 seconds
[0m01:01:22.247351 [debug] [MainThread]: On master: Close
[0m01:01:22.248666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:01:22.248935 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m01:01:22.249069 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m01:01:22.249189 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m01:01:22.249306 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m01:01:22.249512 [info ] [MainThread]: 
[0m01:01:22.249678 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 26.62 seconds (26.62s).
[0m01:01:22.250181 [debug] [MainThread]: Command end result
[0m01:01:22.265295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m01:01:22.266788 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m01:01:22.270131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m01:01:22.270340 [info ] [MainThread]: 
[0m01:01:22.270539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:01:22.270677 [info ] [MainThread]: 
[0m01:01:22.270823 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:01:22.272043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.258854, "process_in_blocks": "0", "process_kernel_time": 0.348493, "process_mem_max_rss": "150323200", "process_out_blocks": "0", "process_user_time": 1.602021}
[0m01:01:22.272289 [debug] [MainThread]: Command `dbt run` succeeded at 01:01:22.272241 after 27.26 seconds
[0m01:01:22.272505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104527fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ba5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104625010>]}
[0m01:01:22.272693 [debug] [MainThread]: Flushing usage events
[0m01:01:23.496824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:10.756321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f6e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6eb20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa717aab0>]}


============================== 18:02:10.761027 | 6ce5fc75-4db3-4277-8ce6-dae48d506cd0 ==============================
[0m18:02:10.761027 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:02:10.761515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:02:10.763780 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'real_estate' does not have a target named 'dev'. The valid target names for this profile are:
   - dev_postgres
   - dev_redshift
[0m18:02:10.764273 [debug] [MainThread]: Command `dbt compile` failed at 18:02:10.764143 after 0.01 seconds
[0m18:02:10.764526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f89e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ea22a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c1b470>]}
[0m18:02:10.764738 [debug] [MainThread]: Flushing usage events
[0m18:02:32.080208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef361e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafaf8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0eaab0>]}


============================== 18:02:32.084610 | 6e99ecda-9ae0-4daf-b01c-a771d8f76a41 ==============================
[0m18:02:32.084610 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:02:32.085099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:02:32.140430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0eaab0>]}
[0m18:02:32.148399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef3c0b0>]}
[0m18:02:32.156055 [debug] [MainThread]: checksum: 6e157d37ad47f2306b96b5d86ad41da87d89edbbef2ad58270584e97aa2c27b1, vars: {}, profile: , target: dev_redshift, version: 1.5.0
[0m18:02:32.164525 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:02:32.165025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeacf3b0>]}
[0m18:02:32.484674 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m18:02:32.492318 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m18:02:32.494422 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m18:02:32.496319 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m18:02:32.498020 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m18:02:32.566214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf54a70>]}
[0m18:02:32.570797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb2ab10>]}
[0m18:02:32.571063 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 345 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:02:32.571302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e99ecda-9ae0-4daf-b01c-a771d8f76a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef3f290>]}
[0m18:02:32.572452 [info ] [MainThread]: 
[0m18:02:32.572970 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:02:32.573790 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m18:02:32.580817 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m18:02:32.581116 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m18:02:32.581265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:32.581453 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:02:32.616555 [debug] [ThreadPool]: Redshift adapter: Error running SQL: BEGIN
[0m18:02:32.616841 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:02:32.617035 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_relations_without_caching
[0m18:02:32.617183 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:02:32.617335 [debug] [ThreadPool]: On list_dev_public: No close available on handle
[0m18:02:32.618025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:32.618188 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m18:02:32.618397 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m18:02:32.618773 [debug] [MainThread]: Command `dbt compile` failed at 18:02:32.618698 after 0.54 seconds
[0m18:02:32.619047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf322000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfbcd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfb7d40>]}
[0m18:02:32.619243 [debug] [MainThread]: Flushing usage events
[0m18:03:58.806313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb065b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb094c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb065a3c0>]}


============================== 18:03:58.811157 | 559d7e4c-31c7-4bc1-9ad1-fb62221866dd ==============================
[0m18:03:58.811157 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:03:58.811572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/real_estate/logs', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:03:58.811960 [info ] [MainThread]: dbt version: 1.5.0
[0m18:03:58.812193 [info ] [MainThread]: python version: 3.12.8
[0m18:03:58.812606 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:03:58.812853 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:03:58.813144 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m18:03:58.813391 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m18:03:58.813667 [info ] [MainThread]: Configuration:
[0m18:03:58.857971 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:03:58.869615 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:03:58.870041 [info ] [MainThread]: Required dependencies:
[0m18:03:58.870520 [debug] [MainThread]: Executing "git --help"
[0m18:03:58.871129 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:03:58.871340 [info ] [MainThread]: Connection:
[0m18:03:58.871667 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m18:03:58.871966 [info ] [MainThread]:   port: 5439
[0m18:03:58.872216 [info ] [MainThread]:   user: quyendinh
[0m18:03:58.872528 [info ] [MainThread]:   database: dev
[0m18:03:58.872779 [info ] [MainThread]:   schema: public
[0m18:03:58.873139 [info ] [MainThread]:   method: database
[0m18:03:58.873470 [info ] [MainThread]:   cluster_id: None
[0m18:03:58.873837 [info ] [MainThread]:   iam_profile: None
[0m18:03:58.874083 [info ] [MainThread]:   sslmode: verify-full
[0m18:03:58.874397 [info ] [MainThread]:   region: None
[0m18:03:58.874839 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m18:03:58.875278 [debug] [MainThread]: Using redshift connection "debug"
[0m18:03:58.875544 [debug] [MainThread]: On debug: select 1 as id
[0m18:03:58.875716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:58.876420 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:03:58.876661 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:03:58.906262 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m18:03:58.906600 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m18:03:58.906780 [debug] [MainThread]: On debug: No close available on handle
[0m18:03:58.906941 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:03:58.907148 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:03:58.907410 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m18:03:58.907727 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:03:58.908185 [debug] [MainThread]: Command `dbt debug` failed at 18:03:58.908086 after 0.11 seconds
[0m18:03:58.908455 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:03:58.908740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb094c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ca8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2051970>]}
[0m18:03:58.908992 [debug] [MainThread]: Flushing usage events
[0m18:07:25.533996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0630b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1aeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2f6de0>]}


============================== 18:07:25.538462 | dab78be8-b13e-4549-ba32-c90e5f9eb55b ==============================
[0m18:07:25.538462 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:07:25.538807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/real_estate', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:07:25.539114 [info ] [MainThread]: dbt version: 1.5.0
[0m18:07:25.539379 [info ] [MainThread]: python version: 3.12.8
[0m18:07:25.539673 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:07:25.540202 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:07:25.540532 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m18:07:25.540835 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m18:07:25.541294 [info ] [MainThread]: Configuration:
[0m18:07:25.544644 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.redshift'
[0m18:07:25.545015 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:07:25.555815 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:07:25.556234 [info ] [MainThread]: Required dependencies:
[0m18:07:25.556582 [debug] [MainThread]: Executing "git --help"
[0m18:07:25.557302 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:07:25.557614 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:07:25.557949 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "real_estate", target "dev_redshift" invalid: Runtime Error
    Could not find adapter type redshift!


[0m18:07:25.558194 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m18:07:25.558641 [debug] [MainThread]: Command `dbt debug` failed at 18:07:25.558573 after 0.03 seconds
[0m18:07:25.558875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2588f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2f7b00>]}
[0m18:07:25.559175 [debug] [MainThread]: Flushing usage events
[0m18:08:28.756972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff4f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01e4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1690aa0>]}


============================== 18:08:28.761902 | 860ee1ff-04a7-4bf4-b9e4-5ef83356a14f ==============================
[0m18:08:28.761902 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:08:28.762379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:08:28.762787 [info ] [MainThread]: dbt version: 1.5.0
[0m18:08:28.763049 [info ] [MainThread]: python version: 3.12.8
[0m18:08:28.763338 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:08:28.763616 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:08:28.763985 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m18:08:28.764248 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m18:08:28.764556 [info ] [MainThread]: Configuration:
[0m18:08:28.809507 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:08:28.820925 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:28.821349 [info ] [MainThread]: Required dependencies:
[0m18:08:28.821718 [debug] [MainThread]: Executing "git --help"
[0m18:08:28.822365 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:08:28.822599 [info ] [MainThread]: Connection:
[0m18:08:28.822912 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m18:08:28.823197 [info ] [MainThread]:   port: 5439
[0m18:08:28.823554 [info ] [MainThread]:   user: quyendinh
[0m18:08:28.823778 [info ] [MainThread]:   database: dev
[0m18:08:28.824004 [info ] [MainThread]:   schema: public
[0m18:08:28.824299 [info ] [MainThread]:   method: database
[0m18:08:28.824515 [info ] [MainThread]:   cluster_id: None
[0m18:08:28.824716 [info ] [MainThread]:   iam_profile: None
[0m18:08:28.825073 [info ] [MainThread]:   sslmode: verify-full
[0m18:08:28.825288 [info ] [MainThread]:   region: None
[0m18:08:28.825735 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m18:08:28.826095 [debug] [MainThread]: Using redshift connection "debug"
[0m18:08:28.826250 [debug] [MainThread]: On debug: select 1 as id
[0m18:08:28.826398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:28.826966 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:08:28.827143 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:08:28.855654 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m18:08:28.855962 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m18:08:28.856135 [debug] [MainThread]: On debug: No close available on handle
[0m18:08:28.856297 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:08:28.856494 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:08:28.856686 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m18:08:28.857081 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:08:28.857618 [debug] [MainThread]: Command `dbt debug` failed at 18:08:28.857551 after 0.11 seconds
[0m18:08:28.857848 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:08:28.858070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa020a0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00a0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff4b680>]}
[0m18:08:28.858282 [debug] [MainThread]: Flushing usage events
[0m18:08:39.242136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ac5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb517ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4abcdd0>]}


============================== 18:08:39.246469 | 45b4b087-1af4-43ed-abea-25ea5a5735d7 ==============================
[0m18:08:39.246469 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:08:39.246831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:08:39.247079 [info ] [MainThread]: dbt version: 1.5.0
[0m18:08:39.247296 [info ] [MainThread]: python version: 3.12.8
[0m18:08:39.247512 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:08:39.250205 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:08:39.250687 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m18:08:39.251029 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m18:08:39.251365 [info ] [MainThread]: Configuration:
[0m18:08:39.296048 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:08:39.307711 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:39.308152 [info ] [MainThread]: Required dependencies:
[0m18:08:39.308438 [debug] [MainThread]: Executing "git --help"
[0m18:08:39.309363 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:08:39.309609 [info ] [MainThread]: Connection:
[0m18:08:39.309900 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m18:08:39.310229 [info ] [MainThread]:   port: 5439
[0m18:08:39.310512 [info ] [MainThread]:   user: quyendinh
[0m18:08:39.310820 [info ] [MainThread]:   database: dev
[0m18:08:39.311084 [info ] [MainThread]:   schema: public
[0m18:08:39.311333 [info ] [MainThread]:   method: database
[0m18:08:39.311600 [info ] [MainThread]:   cluster_id: None
[0m18:08:39.311829 [info ] [MainThread]:   iam_profile: None
[0m18:08:39.312071 [info ] [MainThread]:   sslmode: verify-full
[0m18:08:39.312349 [info ] [MainThread]:   region: None
[0m18:08:39.312859 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m18:08:39.313343 [debug] [MainThread]: Using redshift connection "debug"
[0m18:08:39.313574 [debug] [MainThread]: On debug: select 1 as id
[0m18:08:39.313742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:39.314429 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:08:39.314643 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:08:39.344005 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m18:08:39.344315 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m18:08:39.344492 [debug] [MainThread]: On debug: No close available on handle
[0m18:08:39.344678 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:08:39.344881 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:08:39.345109 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m18:08:39.345449 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:08:39.345968 [debug] [MainThread]: Command `dbt debug` failed at 18:08:39.345895 after 0.11 seconds
[0m18:08:39.346185 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:08:39.346363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eb3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eb0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57c8a70>]}
[0m18:08:39.346600 [debug] [MainThread]: Flushing usage events
[0m01:12:26.243133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fe550>]}


============================== 01:12:26.246160 | 6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e ==============================
[0m01:12:26.246160 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:12:26.246511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --target dev_redshift -f', 'send_anonymous_usage_stats': 'True'}
[0m01:12:26.369542 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m01:12:26.369866 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m01:12:26.496191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108427610>]}
[0m01:12:26.521412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529bc90>]}
[0m01:12:26.522225 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m01:12:26.581185 [debug] [MainThread]: checksum: d14ca3ebecd27f6d058b5f8da783370a5cb8a29c0ee296ecc351f7cd93d67ef1, vars: {}, profile: , target: dev_redshift, version: 1.9.2
[0m01:12:26.626078 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m01:12:26.626412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a7d90>]}
[0m01:12:27.271500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0ac90>]}
[0m01:12:27.312317 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m01:12:27.313677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m01:12:27.321363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c5aa90>]}
[0m01:12:27.321675 [info ] [MainThread]: Found 5 models, 16 data tests, 1 source, 502 macros
[0m01:12:27.321860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105404d50>]}
[0m01:12:27.323008 [info ] [MainThread]: 
[0m01:12:27.323197 [info ] [MainThread]: Concurrency: 5 threads (target='dev_redshift')
[0m01:12:27.323334 [info ] [MainThread]: 
[0m01:12:27.323552 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m01:12:27.325392 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m01:12:27.333695 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m01:12:27.333916 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m01:12:27.334055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:27.334199 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:27.336153 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:29.104637 [debug] [ThreadPool]: SQL status: SUCCESS in 1.770 seconds
[0m01:12:29.134524 [debug] [ThreadPool]: On list_dev: Close
[0m01:12:29.135569 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_public)
[0m01:12:29.139425 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:12:29.139677 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m01:12:29.139846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:29.140002 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:29.140215 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:30.632767 [debug] [ThreadPool]: SQL status: SUCCESS in 1.492 seconds
[0m01:12:30.639875 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m01:12:30.641751 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m01:12:30.943224 [debug] [ThreadPool]: SQL status: SUCCESS in 0.300 seconds
[0m01:12:30.945730 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m01:12:31.238843 [debug] [ThreadPool]: On list_dev_public: Close
[0m01:12:31.249478 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:31.250033 [debug] [MainThread]: On master: BEGIN
[0m01:12:31.250278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:12:31.250542 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:31.250926 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:32.865096 [debug] [MainThread]: SQL status: SUCCESS in 1.615 seconds
[0m01:12:32.866484 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:32.867101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m01:12:33.216279 [debug] [MainThread]: SQL status: SUCCESS in 0.348 seconds
[0m01:12:33.218906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c088d0>]}
[0m01:12:33.219657 [debug] [MainThread]: On master: ROLLBACK
[0m01:12:33.530403 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:33.532230 [debug] [MainThread]: On master: BEGIN
[0m01:12:33.687744 [debug] [MainThread]: SQL status: SUCCESS in 0.155 seconds
[0m01:12:33.690708 [debug] [MainThread]: On master: COMMIT
[0m01:12:33.693223 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:33.695792 [debug] [MainThread]: On master: COMMIT
[0m01:12:34.005498 [debug] [MainThread]: SQL status: SUCCESS in 0.308 seconds
[0m01:12:34.008573 [debug] [MainThread]: On master: Close
[0m01:12:34.012723 [debug] [Thread-1 (]: Began running node model.real_estate.staging_table
[0m01:12:34.013436 [info ] [Thread-1 (]: 1 of 5 START sql table model public.staging_table .............................. [RUN]
[0m01:12:34.013908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_public, now model.real_estate.staging_table)
[0m01:12:34.014190 [debug] [Thread-1 (]: Began compiling node model.real_estate.staging_table
[0m01:12:34.017479 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.staging_table"
[0m01:12:34.019579 [debug] [Thread-1 (]: Began executing node model.real_estate.staging_table
[0m01:12:34.098475 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.staging_table"
[0m01:12:34.100590 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:34.100764 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:12:34.100907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:34.101066 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:34.101297 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:35.708381 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.607 seconds
[0m01:12:35.709974 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:35.710728 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */

  
    

  create  table
    "dev"."public"."staging_table__dbt_tmp"
    
    
    
  as (
    

SELECT 
  title,
  price_per_m²,
  project_name,
  address,
  price,
  area,
  bedroom,
  bathroom,
  url,
  posted_date,
  expired_date,
  project_status,
  investor,
  broker_name,
  broker_rank,
  project_area_range,
  number_of_apartments,
  number_of_buildings,
  update_date
FROM "dev"."public"."staging_table"
  );
[0m01:12:36.099572 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.387 seconds
[0m01:12:36.110654 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:36.111225 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table" rename to "staging_table__dbt_backup"
[0m01:12:37.035850 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.924 seconds
[0m01:12:37.040350 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:37.040617 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
alter table "dev"."public"."staging_table__dbt_tmp" rename to "staging_table"
[0m01:12:37.503664 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.462 seconds
[0m01:12:37.516501 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:12:37.516868 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:37.517042 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:12:38.257465 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.739 seconds
[0m01:12:38.258970 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:38.259684 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:12:38.570100 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.310 seconds
[0m01:12:38.579085 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."staging_table__dbt_backup"
[0m01:12:38.581550 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:38.581745 [debug] [Thread-1 (]: On model.real_estate.staging_table: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.staging_table"} */
drop table if exists "dev"."public"."staging_table__dbt_backup" cascade
[0m01:12:38.893970 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.312 seconds
[0m01:12:38.899576 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:12:38.901138 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:38.901665 [debug] [Thread-1 (]: On model.real_estate.staging_table: COMMIT
[0m01:12:39.399532 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.497 seconds
[0m01:12:39.402146 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.staging_table"
[0m01:12:39.403009 [debug] [Thread-1 (]: On model.real_estate.staging_table: BEGIN
[0m01:12:39.559811 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.155 seconds
[0m01:12:39.563347 [debug] [Thread-1 (]: On model.real_estate.staging_table: ROLLBACK
[0m01:12:39.874766 [debug] [Thread-1 (]: On model.real_estate.staging_table: Close
[0m01:12:39.880392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109edc390>]}
[0m01:12:39.880827 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.staging_table ......................... [[32mSUCCESS[0m in 5.86s]
[0m01:12:39.881110 [debug] [Thread-1 (]: Finished running node model.real_estate.staging_table
[0m01:12:39.881547 [debug] [Thread-3 (]: Began running node model.real_estate.dim_broker
[0m01:12:39.881760 [info ] [Thread-3 (]: 2 of 5 START sql table model public.dim_broker ................................. [RUN]
[0m01:12:39.881972 [debug] [Thread-4 (]: Began running node model.real_estate.dim_post
[0m01:12:39.882442 [debug] [Thread-3 (]: Acquiring new redshift connection 'model.real_estate.dim_broker'
[0m01:12:39.882626 [debug] [Thread-5 (]: Began running node model.real_estate.dim_project
[0m01:12:39.882865 [info ] [Thread-4 (]: 3 of 5 START sql table model public.dim_post ................................... [RUN]
[0m01:12:39.883055 [debug] [Thread-3 (]: Began compiling node model.real_estate.dim_broker
[0m01:12:39.883258 [info ] [Thread-5 (]: 4 of 5 START sql table model public.dim_project ................................ [RUN]
[0m01:12:39.883486 [debug] [Thread-4 (]: Acquiring new redshift connection 'model.real_estate.dim_post'
[0m01:12:39.885209 [debug] [Thread-3 (]: Writing injected SQL for node "model.real_estate.dim_broker"
[0m01:12:39.885498 [debug] [Thread-5 (]: Acquiring new redshift connection 'model.real_estate.dim_project'
[0m01:12:39.885661 [debug] [Thread-4 (]: Began compiling node model.real_estate.dim_post
[0m01:12:39.885898 [debug] [Thread-5 (]: Began compiling node model.real_estate.dim_project
[0m01:12:39.887510 [debug] [Thread-4 (]: Writing injected SQL for node "model.real_estate.dim_post"
[0m01:12:39.889451 [debug] [Thread-5 (]: Writing injected SQL for node "model.real_estate.dim_project"
[0m01:12:39.889840 [debug] [Thread-3 (]: Began executing node model.real_estate.dim_broker
[0m01:12:39.892068 [debug] [Thread-3 (]: Writing runtime sql for node "model.real_estate.dim_broker"
[0m01:12:39.892440 [debug] [Thread-5 (]: Began executing node model.real_estate.dim_project
[0m01:12:39.892624 [debug] [Thread-4 (]: Began executing node model.real_estate.dim_post
[0m01:12:39.896096 [debug] [Thread-5 (]: Writing runtime sql for node "model.real_estate.dim_project"
[0m01:12:39.898123 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:39.900324 [debug] [Thread-4 (]: Writing runtime sql for node "model.real_estate.dim_post"
[0m01:12:39.900596 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:12:39.900845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:12:39.903002 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:39.903235 [debug] [Thread-3 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:39.904817 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:39.905009 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:12:39.905256 [debug] [Thread-3 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:39.905425 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:12:39.905580 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m01:12:39.906069 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:12:39.906500 [debug] [Thread-5 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:39.906747 [debug] [Thread-4 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:39.907015 [debug] [Thread-5 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:39.907299 [debug] [Thread-4 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:41.510250 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.609 seconds
[0m01:12:41.513969 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:41.515097 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */

  
    

  create  table
    "dev"."public"."dim_broker__dbt_tmp"
    
    
    
  as (
    
WITH broker_data AS (
    SELECT DISTINCT broker_name, broker_rank, update_date
    FROM "dev"."public"."staging_table"
), broker_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY broker_name, update_date ORDER BY broker_name, broker_rank) AS rn,
        broker_name,
        broker_rank,
        update_date
    FROM broker_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY broker_name, broker_rank) as broker_id,
    update_date,
    broker_name,
    broker_rank
FROM broker_table
WHERE rn = 1
  );
[0m01:12:41.520677 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.614 seconds
[0m01:12:41.525447 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:41.526150 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */

  
    

  create  table
    "dev"."public"."dim_post__dbt_tmp"
    
    
    
  as (
    
WITH post_data AS (
    SELECT DISTINCT title,
                    url, 
                    posted_date, 
                    expired_date,
                    update_date
    FROM "dev"."public"."staging_table"
), post_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY url, update_date ORDER BY title, url) AS rn,
        title,
        url, 
        posted_date, 
        expired_date,
        update_date
    FROM post_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY title, 
                                url, 
                                posted_date, 
                                expired_date
    ) as post_id,
    update_date,
    title, 
    url, 
    posted_date, 
    expired_date
FROM post_table
WHERE rn = 1
  );
[0m01:12:41.548511 [debug] [Thread-5 (]: SQL status: SUCCESS in 1.642 seconds
[0m01:12:41.551034 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:41.551954 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */

  
    

  create  table
    "dev"."public"."dim_project__dbt_tmp"
    
    
    
  as (
    
WITH project_data AS (
    SELECT DISTINCT project_name,
                    investor, 
                    project_area_range, 
                    project_status, 
                    address, 
                    number_of_apartments, 
                    number_of_buildings,
                    update_date
    FROM "dev"."public"."staging_table"
), project_table AS (
    SELECT 
        ROW_NUMBER() OVER (PARTITION BY project_name, update_date ORDER BY project_name, address) AS rn,
        project_name,
        investor, 
        project_area_range, 
        project_status, 
        address, 
        number_of_apartments, 
        number_of_buildings,
        update_date
    FROM project_data
)
SELECT 
    ROW_NUMBER() OVER (ORDER BY project_name, 
                                investor, 
                                project_area_range, 
                                project_status, 
                                address, 
                                number_of_apartments, 
                                number_of_buildings
    ) as project_id,
    update_date,
    project_name, 
    investor, 
    project_area_range, 
    project_status, 
    address, 
    number_of_apartments, 
    number_of_buildings
FROM project_table
WHERE rn = 1
  );
[0m01:12:41.925523 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.407 seconds
[0m01:12:41.926643 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.400 seconds
[0m01:12:41.931154 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:41.933657 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:41.933924 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
alter table "dev"."public"."dim_broker" rename to "dim_broker__dbt_backup"
[0m01:12:41.934169 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
alter table "dev"."public"."dim_post" rename to "dim_post__dbt_backup"
[0m01:12:41.962968 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.410 seconds
[0m01:12:41.971465 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:41.971871 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
alter table "dev"."public"."dim_project" rename to "dim_project__dbt_backup"
[0m01:12:42.853530 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.919 seconds
[0m01:12:42.855754 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:42.855970 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
alter table "dev"."public"."dim_broker__dbt_tmp" rename to "dim_broker"
[0m01:12:42.859840 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.925 seconds
[0m01:12:42.862635 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:42.862996 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
alter table "dev"."public"."dim_post__dbt_tmp" rename to "dim_post"
[0m01:12:42.907884 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.936 seconds
[0m01:12:42.909802 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:42.909983 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
alter table "dev"."public"."dim_project__dbt_tmp" rename to "dim_project"
[0m01:12:43.317789 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.461 seconds
[0m01:12:43.319902 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:12:43.320233 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:43.320388 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:12:43.322532 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.459 seconds
[0m01:12:43.323497 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:12:43.323726 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:43.323915 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:12:43.378736 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.468 seconds
[0m01:12:43.381047 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:12:43.381625 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:43.381998 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:12:44.075301 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.754 seconds
[0m01:12:44.076557 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:44.076883 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:12:44.316549 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.992 seconds
[0m01:12:44.323083 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.941 seconds
[0m01:12:44.435069 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.357 seconds
[0m01:12:44.439418 [debug] [Thread-3 (]: Applying DROP to: "dev"."public"."dim_broker__dbt_backup"
[0m01:12:44.440592 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:44.441035 [debug] [Thread-3 (]: On model.real_estate.dim_broker: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_broker"} */
drop table if exists "dev"."public"."dim_broker__dbt_backup" cascade
[0m01:12:44.748549 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.307 seconds
[0m01:12:44.749762 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:12:44.750116 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:44.750378 [debug] [Thread-3 (]: On model.real_estate.dim_broker: COMMIT
[0m01:12:45.255301 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.504 seconds
[0m01:12:45.260644 [debug] [Thread-3 (]: Using redshift connection "model.real_estate.dim_broker"
[0m01:12:45.261505 [debug] [Thread-3 (]: On model.real_estate.dim_broker: BEGIN
[0m01:12:45.417376 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.155 seconds
[0m01:12:45.420729 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:45.421496 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:12:45.729616 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.307 seconds
[0m01:12:45.735104 [debug] [Thread-4 (]: Applying DROP to: "dev"."public"."dim_post__dbt_backup"
[0m01:12:45.736190 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:45.736448 [debug] [Thread-4 (]: On model.real_estate.dim_post: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_post"} */
drop table if exists "dev"."public"."dim_post__dbt_backup" cascade
[0m01:12:46.046703 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.310 seconds
[0m01:12:46.047672 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:12:46.048044 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:46.048299 [debug] [Thread-4 (]: On model.real_estate.dim_post: COMMIT
[0m01:12:46.736938 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.688 seconds
[0m01:12:46.742197 [debug] [Thread-4 (]: Using redshift connection "model.real_estate.dim_post"
[0m01:12:46.742532 [debug] [Thread-4 (]: On model.real_estate.dim_post: BEGIN
[0m01:12:46.901943 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.157 seconds
[0m01:12:46.904605 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:46.905001 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:12:47.217674 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.312 seconds
[0m01:12:47.226094 [debug] [Thread-5 (]: Applying DROP to: "dev"."public"."dim_project__dbt_backup"
[0m01:12:47.227108 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:47.227418 [debug] [Thread-5 (]: On model.real_estate.dim_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.dim_project"} */
drop table if exists "dev"."public"."dim_project__dbt_backup" cascade
[0m01:12:47.544992 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.315 seconds
[0m01:12:47.553102 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:12:47.554250 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:47.554624 [debug] [Thread-5 (]: On model.real_estate.dim_project: COMMIT
[0m01:12:48.066289 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.511 seconds
[0m01:12:48.066895 [debug] [Thread-5 (]: Using redshift connection "model.real_estate.dim_project"
[0m01:12:48.067130 [debug] [Thread-5 (]: On model.real_estate.dim_project: BEGIN
[0m01:12:48.273699 [debug] [Thread-5 (]: SQL status: SUCCESS in 0.206 seconds
[0m01:12:48.277033 [debug] [Thread-3 (]: On model.real_estate.dim_broker: ROLLBACK
[0m01:12:48.277776 [debug] [Thread-4 (]: On model.real_estate.dim_post: ROLLBACK
[0m01:12:48.278534 [debug] [Thread-5 (]: On model.real_estate.dim_project: ROLLBACK
[0m01:12:48.587546 [debug] [Thread-3 (]: On model.real_estate.dim_broker: Close
[0m01:12:48.589333 [debug] [Thread-4 (]: On model.real_estate.dim_post: Close
[0m01:12:48.590821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c89850>]}
[0m01:12:48.592926 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089e7910>]}
[0m01:12:48.592481 [info ] [Thread-3 (]: 2 of 5 OK created sql table model public.dim_broker ............................ [[32mSUCCESS[0m in 8.71s]
[0m01:12:48.593570 [info ] [Thread-4 (]: 3 of 5 OK created sql table model public.dim_post .............................. [[32mSUCCESS[0m in 8.71s]
[0m01:12:48.593870 [debug] [Thread-5 (]: On model.real_estate.dim_project: Close
[0m01:12:48.594254 [debug] [Thread-3 (]: Finished running node model.real_estate.dim_broker
[0m01:12:48.594564 [debug] [Thread-4 (]: Finished running node model.real_estate.dim_post
[0m01:12:48.595110 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbca10>]}
[0m01:12:48.595582 [info ] [Thread-5 (]: 4 of 5 OK created sql table model public.dim_project ........................... [[32mSUCCESS[0m in 8.71s]
[0m01:12:48.595944 [debug] [Thread-5 (]: Finished running node model.real_estate.dim_project
[0m01:12:48.596379 [debug] [Thread-1 (]: Began running node model.real_estate.fact_all_apartment
[0m01:12:48.596682 [info ] [Thread-1 (]: 5 of 5 START sql table model public.fact_all_apartment ......................... [RUN]
[0m01:12:48.596992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.real_estate.staging_table, now model.real_estate.fact_all_apartment)
[0m01:12:48.597229 [debug] [Thread-1 (]: Began compiling node model.real_estate.fact_all_apartment
[0m01:12:48.600166 [debug] [Thread-1 (]: Writing injected SQL for node "model.real_estate.fact_all_apartment"
[0m01:12:48.602052 [debug] [Thread-1 (]: Began executing node model.real_estate.fact_all_apartment
[0m01:12:48.606021 [debug] [Thread-1 (]: Writing runtime sql for node "model.real_estate.fact_all_apartment"
[0m01:12:48.610527 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:48.610831 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:12:48.611049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:48.611284 [debug] [Thread-1 (]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:48.611602 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:50.208325 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.595 seconds
[0m01:12:50.210501 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:50.211314 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */

  
    

  create  table
    "dev"."public"."fact_all_apartment__dbt_tmp"
    
    
    
  as (
    
WITH staging_data AS (
SELECT ROW_NUMBER() OVER (PARTITION BY s.update_date, s.url ORDER BY s.update_date) AS rn,
	   dpo.post_id,
       s.update_date,
       db.broker_id,
       dp.project_id,
       s.price,
       'tỷ đồng'::TEXT AS price_unit,
       s.price_per_m²,
       'triệu đồng'::TEXT AS price_per_m²_unit,
       s.area,
       'm²'::TEXT AS area_unit,
       s.bedroom,
       s.bathroom
FROM "dev"."public"."staging_table" s   
                    LEFT JOIN "dev"."public"."dim_broker" db ON s.broker_name = db.broker_name
											 AND s.broker_rank = db.broker_rank
                                            AND s.update_date::date = db.update_date::date
                    LEFT JOIN "dev"."public"."dim_project" dp ON s.project_name = dp.project_name 
                                            AND s.update_date::date = dp.update_date::date
                    LEFT JOIN "dev"."public"."dim_post" dpo ON s.title = dpo.title 
                                            AND s.url = dpo.url 
                                            AND s.update_date::date = dpo.update_date::date
ORDER BY dpo.post_id
) SELECT post_id,
       update_date,
       broker_id,
       project_id,
       price,
       price_unit,
       price_per_m²,
       price_per_m²_unit,
       area,
       area_unit,
       bedroom,
       bathroom 
FROM staging_data 
WHERE rn = 1
  );
[0m01:12:50.649106 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.437 seconds
[0m01:12:50.663101 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:50.663738 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "dev"."public"."fact_all_apartment" rename to "fact_all_apartment__dbt_backup"
[0m01:12:51.575385 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.911 seconds
[0m01:12:51.580937 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:51.581168 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
alter table "dev"."public"."fact_all_apartment__dbt_tmp" rename to "fact_all_apartment"
[0m01:12:52.039549 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.457 seconds
[0m01:12:52.044818 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:12:52.045186 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:52.045361 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:12:52.713601 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.668 seconds
[0m01:12:52.715544 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:52.716141 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:12:53.023213 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.306 seconds
[0m01:12:53.028222 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."fact_all_apartment__dbt_backup"
[0m01:12:53.028849 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:53.029033 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "real_estate", "target_name": "dev_redshift", "node_id": "model.real_estate.fact_all_apartment"} */
drop table if exists "dev"."public"."fact_all_apartment__dbt_backup" cascade
[0m18:12:53.212275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ddde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81aede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ef1100>]}


============================== 18:12:53.216673 | 9b22b7f9-512b-4268-8959-81698cc7811f ==============================
[0m18:12:53.216673 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:12:53.217023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:53.217506 [info ] [MainThread]: dbt version: 1.5.0
[0m18:12:53.217947 [info ] [MainThread]: python version: 3.12.8
[0m18:12:53.218257 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m18:12:53.218540 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m18:12:53.218844 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m18:12:53.219120 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m18:12:53.219391 [info ] [MainThread]: Configuration:
[0m18:12:53.267381 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:12:53.279307 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:12:53.279710 [info ] [MainThread]: Required dependencies:
[0m18:12:53.280049 [debug] [MainThread]: Executing "git --help"
[0m18:12:53.280743 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m18:12:53.280975 [info ] [MainThread]: Connection:
[0m18:12:53.281296 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m18:12:53.281591 [info ] [MainThread]:   port: 5439
[0m18:12:53.281852 [info ] [MainThread]:   user: quyendinh
[0m18:12:53.282138 [info ] [MainThread]:   database: dev
[0m18:12:53.282385 [info ] [MainThread]:   schema: public
[0m18:12:53.282646 [info ] [MainThread]:   method: database
[0m18:12:53.282896 [info ] [MainThread]:   cluster_id: None
[0m18:12:53.283142 [info ] [MainThread]:   iam_profile: None
[0m18:12:53.283336 [info ] [MainThread]:   sslmode: verify-full
[0m18:12:53.283680 [info ] [MainThread]:   region: ap-southeast-2
[0m18:12:53.284148 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m18:12:53.284602 [debug] [MainThread]: Using redshift connection "debug"
[0m18:12:53.284809 [debug] [MainThread]: On debug: select 1 as id
[0m18:12:53.284970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:53.285623 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:12:53.285803 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:12:53.315469 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m18:12:53.315752 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m18:12:53.315918 [debug] [MainThread]: On debug: No close available on handle
[0m18:12:53.316072 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m18:12:53.316458 [info ] [MainThread]: [31m2 checks failed:[0m
[0m18:12:53.316894 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m18:12:53.317177 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m18:12:53.317667 [debug] [MainThread]: Command `dbt debug` failed at 18:12:53.317564 after 0.11 seconds
[0m18:12:53.317942 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:12:53.318170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87a2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81aede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f049e0>]}
[0m18:12:53.318408 [debug] [MainThread]: Flushing usage events
[0m01:12:53.336197 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.306 seconds
[0m01:12:53.339743 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:12:53.340758 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:53.341385 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: COMMIT
[0m01:12:53.933056 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.591 seconds
[0m01:12:53.935878 [debug] [Thread-1 (]: Using redshift connection "model.real_estate.fact_all_apartment"
[0m01:12:53.936593 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: BEGIN
[0m01:12:54.094372 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.157 seconds
[0m01:12:54.096547 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: ROLLBACK
[0m01:12:54.405987 [debug] [Thread-1 (]: On model.real_estate.fact_all_apartment: Close
[0m01:12:54.408968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cddb2-13d0-4bc9-b61a-a10ad2a8ab8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c636d0>]}
[0m01:12:54.409825 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.fact_all_apartment .................... [[32mSUCCESS[0m in 5.81s]
[0m01:12:54.410321 [debug] [Thread-1 (]: Finished running node model.real_estate.fact_all_apartment
[0m01:12:54.412156 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:54.412611 [debug] [MainThread]: On master: BEGIN
[0m01:12:54.412983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:54.413374 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m01:12:54.413899 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m01:12:56.054675 [debug] [MainThread]: SQL status: SUCCESS in 1.642 seconds
[0m01:12:56.056041 [debug] [MainThread]: On master: COMMIT
[0m01:12:56.056355 [debug] [MainThread]: Using redshift connection "master"
[0m01:12:56.056543 [debug] [MainThread]: On master: COMMIT
[0m01:12:56.376436 [debug] [MainThread]: SQL status: SUCCESS in 0.319 seconds
[0m01:12:56.377484 [debug] [MainThread]: On master: Close
[0m01:12:56.378788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:56.379215 [debug] [MainThread]: Connection 'model.real_estate.fact_all_apartment' was properly closed.
[0m01:12:56.379541 [debug] [MainThread]: Connection 'model.real_estate.dim_broker' was properly closed.
[0m01:12:56.379820 [debug] [MainThread]: Connection 'model.real_estate.dim_post' was properly closed.
[0m01:12:56.380080 [debug] [MainThread]: Connection 'model.real_estate.dim_project' was properly closed.
[0m01:12:56.380536 [info ] [MainThread]: 
[0m01:12:56.380934 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 29.06 seconds (29.06s).
[0m01:12:56.382150 [debug] [MainThread]: Command end result
[0m01:12:56.416096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/manifest.json
[0m01:12:56.417766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/semantic_manifest.json
[0m01:12:56.422325 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/target/run_results.json
[0m01:12:56.422573 [info ] [MainThread]: 
[0m01:12:56.422815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:12:56.422992 [info ] [MainThread]: 
[0m01:12:56.423186 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:12:56.425095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.221458, "process_in_blocks": "0", "process_kernel_time": 0.35312, "process_mem_max_rss": "154386432", "process_out_blocks": "0", "process_user_time": 2.159625}
[0m01:12:56.425401 [debug] [MainThread]: Command `dbt run` succeeded at 01:12:56.425346 after 30.22 seconds
[0m01:12:56.425654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102983fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a165d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a80f90>]}
[0m01:12:56.425903 [debug] [MainThread]: Flushing usage events
[0m01:12:57.693681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:05.801170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86763f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860fa030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857f8d70>]}


============================== 18:13:05.805825 | becd7eb6-c3dd-4b51-ba19-8bb86258e3e9 ==============================
[0m18:13:05.805825 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:13:05.806204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:13:05.863387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8592e030>]}
[0m18:13:05.870721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f54290>]}
[0m18:13:05.878228 [debug] [MainThread]: checksum: 6e157d37ad47f2306b96b5d86ad41da87d89edbbef2ad58270584e97aa2c27b1, vars: {}, profile: , target: dev_redshift, version: 1.5.0
[0m18:13:05.887252 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:05.887684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843587a0>]}
[0m18:13:06.190496 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m18:13:06.198040 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m18:13:06.199963 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m18:13:06.201740 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m18:13:06.203515 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m18:13:06.271277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8437f560>]}
[0m18:13:06.276576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8437e690>]}
[0m18:13:06.276961 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:13:06.277201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'becd7eb6-c3dd-4b51-ba19-8bb86258e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f6e150>]}
[0m18:13:06.278261 [info ] [MainThread]: 
[0m18:13:06.278830 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:13:06.279647 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:13:06.286049 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:13:06.286282 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m18:13:06.286463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:06.287153 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:06.287392 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:06.322924 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m18:13:06.323293 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:06.323649 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m18:13:06.323817 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:06.324013 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m18:13:06.324816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:06.324998 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:13:06.325176 [info ] [MainThread]: 
[0m18:13:06.325392 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m18:13:06.325758 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m18:13:06.326203 [debug] [MainThread]: Command `dbt run` failed at 18:13:06.326099 after 0.53 seconds
[0m18:13:06.326429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff855a38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f42000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845342f0>]}
[0m18:13:06.326681 [debug] [MainThread]: Flushing usage events
[0m18:13:19.452058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8231be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8246d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82704800>]}


============================== 18:13:19.456861 | 5acfbf30-8a12-485e-9c60-752d1cbcc23a ==============================
[0m18:13:19.456861 [info ] [MainThread]: Running with dbt=1.5.0
[0m18:13:19.457240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:13:19.514068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5acfbf30-8a12-485e-9c60-752d1cbcc23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82707b60>]}
[0m18:13:19.521841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5acfbf30-8a12-485e-9c60-752d1cbcc23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ecffb0>]}
[0m18:13:19.529693 [debug] [MainThread]: checksum: 6e157d37ad47f2306b96b5d86ad41da87d89edbbef2ad58270584e97aa2c27b1, vars: {}, profile: , target: dev_redshift, version: 1.5.0
[0m18:13:19.548475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:19.548772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:19.552105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5acfbf30-8a12-485e-9c60-752d1cbcc23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8212af90>]}
[0m18:13:19.557669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5acfbf30-8a12-485e-9c60-752d1cbcc23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f1a090>]}
[0m18:13:19.558056 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 346 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:13:19.558328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5acfbf30-8a12-485e-9c60-752d1cbcc23a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82320e00>]}
[0m18:13:19.559499 [info ] [MainThread]: 
[0m18:13:19.560083 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:13:19.560932 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:13:19.567338 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:13:19.567686 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m18:13:19.568058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:19.568810 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:19.569071 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:19.605893 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m18:13:19.606286 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:19.606603 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m18:13:19.606919 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:19.607240 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m18:13:19.608096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:19.608292 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:13:19.608501 [info ] [MainThread]: 
[0m18:13:19.608753 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m18:13:19.609083 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m18:13:19.609496 [debug] [MainThread]: Command `dbt run` failed at 18:13:19.609414 after 0.16 seconds
[0m18:13:19.609781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82310ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ef2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81edb8c0>]}
[0m18:13:19.610043 [debug] [MainThread]: Flushing usage events
[0m18:13:44.694267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9061520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d2a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8cf4b30>]}


============================== 18:13:44.698579 | c2c58b12-aac7-426c-aa1a-33a517f62420 ==============================
[0m18:13:44.698579 [info ] [MainThread]: Running with dbt=1.5.5
[0m18:13:44.698924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'profiles_dir': '/opt/airflow/real_estate', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:13:44.753593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b0b620>]}
[0m18:13:44.761845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87bb2f0>]}
[0m18:13:44.762417 [info ] [MainThread]: Registered adapter: redshift=1.5.5
[0m18:13:44.769769 [debug] [MainThread]: checksum: 002e66de35dedcb28627e7bc801d3a10ab7d40eac2be5e9778b9951719781f4e, vars: {}, profile: , target: dev_redshift, version: 1.5.5
[0m18:13:44.776182 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:13:44.776563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c52330>]}
[0m18:13:45.106183 [debug] [MainThread]: 1699: static parser successfully parsed staging/staging_table.sql
[0m18:13:45.113438 [debug] [MainThread]: 1699: static parser successfully parsed marts/fact_all_apartment.sql
[0m18:13:45.115523 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_post.sql
[0m18:13:45.117432 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_project.sql
[0m18:13:45.119184 [debug] [MainThread]: 1699: static parser successfully parsed marts/dim_broker.sql
[0m18:13:45.187544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbfd70>]}
[0m18:13:45.192607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d183b0>]}
[0m18:13:45.192912 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m18:13:45.193172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c58b12-aac7-426c-aa1a-33a517f62420', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d514f0>]}
[0m18:13:45.194392 [info ] [MainThread]: 
[0m18:13:45.194962 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m18:13:45.195737 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m18:13:45.202436 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m18:13:45.202690 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m18:13:45.202855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:45.203496 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m18:13:45.203680 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m18:13:45.238637 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m18:13:45.238973 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:45.239216 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m18:13:45.239381 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m18:13:45.239589 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m18:13:45.240253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:45.240525 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m18:13:45.240734 [info ] [MainThread]: 
[0m18:13:45.240964 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m18:13:45.241453 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m18:13:45.241954 [debug] [MainThread]: Command `dbt run` failed at 18:13:45.241881 after 0.55 seconds
[0m18:13:45.242197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8db6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbcd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dabc80>]}
[0m18:13:45.242423 [debug] [MainThread]: Flushing usage events
[0m04:52:48.117524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac783e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6341d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacab47a0>]}


============================== 04:52:48.122169 | f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307 ==============================
[0m04:52:48.122169 [info ] [MainThread]: Running with dbt=1.5.5
[0m04:52:48.122509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/real_estate', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:52:48.175241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacaffa40>]}
[0m04:52:48.182460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1eb3b0>]}
[0m04:52:48.182776 [info ] [MainThread]: Registered adapter: redshift=1.5.5
[0m04:52:48.191092 [debug] [MainThread]: checksum: 002e66de35dedcb28627e7bc801d3a10ab7d40eac2be5e9778b9951719781f4e, vars: {}, profile: , target: dev_redshift, version: 1.5.5
[0m04:52:48.208044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:52:48.208282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:52:48.211251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6343b0>]}
[0m04:52:48.215897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac22a7e0>]}
[0m04:52:48.216162 [info ] [MainThread]: Found 5 models, 16 tests, 0 snapshots, 0 analyses, 347 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m04:52:48.216401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1aa3f0c-a16a-4ec9-a1f0-a2beead9d307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac22a7b0>]}
[0m04:52:48.217430 [info ] [MainThread]: 
[0m04:52:48.217911 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m04:52:48.218619 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m04:52:48.224513 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:52:48.224710 [debug] [ThreadPool]: On list_dev: select distinct nspname from pg_namespace
[0m04:52:48.224849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:48.225420 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:52:48.225576 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:52:48.259946 [debug] [ThreadPool]: Redshift adapter: Error running SQL: select distinct nspname from pg_namespace
[0m04:52:48.260192 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m04:52:48.260382 [debug] [ThreadPool]: Redshift adapter: Error running SQL: macro list_schemas
[0m04:52:48.260525 [debug] [ThreadPool]: Redshift adapter: Rolling back transaction.
[0m04:52:48.260727 [debug] [ThreadPool]: On list_dev: No close available on handle
[0m04:52:48.261507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:48.261703 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m04:52:48.261906 [info ] [MainThread]: 
[0m04:52:48.262175 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m04:52:48.262709 [error] [MainThread]: Encountered an error:
Database Error
  ('communication error', OSError('Int or String expected'))
[0m04:52:48.263214 [debug] [MainThread]: Command `dbt run` failed at 04:52:48.263144 after 0.15 seconds
[0m04:52:48.263488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae41e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac537230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac537a70>]}
[0m04:52:48.263728 [debug] [MainThread]: Flushing usage events
[0m04:52:55.245512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f06e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1bd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f180800>]}


============================== 04:52:55.249893 | af80e347-40e6-4a0f-aae7-abf6bb061f00 ==============================
[0m04:52:55.249893 [info ] [MainThread]: Running with dbt=1.5.5
[0m04:52:55.250234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/real_estate', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:52:55.250633 [info ] [MainThread]: dbt version: 1.5.5
[0m04:52:55.250953 [info ] [MainThread]: python version: 3.12.8
[0m04:52:55.251327 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m04:52:55.251653 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m04:52:55.251983 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/real_estate/profiles.yml
[0m04:52:55.252316 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/real_estate/dbt_project.yml
[0m04:52:55.252695 [info ] [MainThread]: Configuration:
[0m04:52:55.297494 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:52:55.309131 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:52:55.309483 [info ] [MainThread]: Required dependencies:
[0m04:52:55.309721 [debug] [MainThread]: Executing "git --help"
[0m04:52:55.310381 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m04:52:55.310700 [info ] [MainThread]: Connection:
[0m04:52:55.311030 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m04:52:55.311299 [info ] [MainThread]:   port: 5439
[0m04:52:55.311605 [info ] [MainThread]:   user: quyendinh
[0m04:52:55.311894 [info ] [MainThread]:   database: dev
[0m04:52:55.312185 [info ] [MainThread]:   schema: public
[0m04:52:55.312476 [info ] [MainThread]:   method: database
[0m04:52:55.312779 [info ] [MainThread]:   cluster_id: None
[0m04:52:55.313101 [info ] [MainThread]:   iam_profile: None
[0m04:52:55.313381 [info ] [MainThread]:   sslmode: verify-full
[0m04:52:55.313681 [info ] [MainThread]:   region: ap-southeast-2
[0m04:52:55.314184 [info ] [MainThread]: Registered adapter: redshift=1.5.5
[0m04:52:55.314641 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m04:52:55.315051 [debug] [MainThread]: Using redshift connection "debug"
[0m04:52:55.315218 [debug] [MainThread]: On debug: select 1 as id
[0m04:52:55.315366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:52:55.316023 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m04:52:55.316241 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m04:52:55.347094 [debug] [MainThread]: Redshift adapter: Error running SQL: select 1 as id
[0m04:52:55.347460 [debug] [MainThread]: Redshift adapter: Rolling back transaction.
[0m04:52:55.347793 [debug] [MainThread]: On debug: No close available on handle
[0m04:52:55.348155 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m04:52:55.348480 [info ] [MainThread]: [31m2 checks failed:[0m
[0m04:52:55.348759 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m04:52:55.349058 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  ('communication error', OSError('Int or String expected'))

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m04:52:55.349644 [debug] [MainThread]: Command `dbt debug` failed at 04:52:55.349571 after 0.11 seconds
[0m04:52:55.349883 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:52:55.350107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f2238c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4ced80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4f0230>]}
[0m04:52:55.350328 [debug] [MainThread]: Flushing usage events
[0m11:53:07.599382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109396110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093949d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e6cd0>]}


============================== 11:53:07.601992 | 193879d7-b11d-4862-941c-d508897d9f1b ==============================
[0m11:53:07.601992 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:53:07.602302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --target dev_redshift', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:07.612596 [info ] [MainThread]: dbt version: 1.9.2
[0m11:53:07.612855 [info ] [MainThread]: python version: 3.11.10
[0m11:53:07.613015 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m11:53:07.613151 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m11:53:07.726332 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:53:07.726645 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:53:07.770889 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m11:53:07.771170 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m11:53:07.771351 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m11:53:07.771749 [info ] [MainThread]: adapter type: redshift
[0m11:53:07.771920 [info ] [MainThread]: adapter version: 1.9.0
[0m11:53:07.811752 [info ] [MainThread]: Configuration:
[0m11:53:07.812058 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:53:07.812205 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:53:07.812340 [info ] [MainThread]: Required dependencies:
[0m11:53:07.812532 [debug] [MainThread]: Executing "git --help"
[0m11:53:07.847572 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:53:07.848154 [debug] [MainThread]: STDERR: "b''"
[0m11:53:07.848364 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:53:07.848530 [info ] [MainThread]: Connection:
[0m11:53:07.848739 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m11:53:07.848888 [info ] [MainThread]:   user: quyendinh
[0m11:53:07.849020 [info ] [MainThread]:   port: 5439
[0m11:53:07.849139 [info ] [MainThread]:   database: dev
[0m11:53:07.849268 [info ] [MainThread]:   method: database
[0m11:53:07.849385 [info ] [MainThread]:   cluster_id: None
[0m11:53:07.849503 [info ] [MainThread]:   iam_profile: None
[0m11:53:07.849628 [info ] [MainThread]:   schema: public
[0m11:53:07.849747 [info ] [MainThread]:   sslmode: verify-full
[0m11:53:07.849861 [info ] [MainThread]:   region: ap-southeast-2
[0m11:53:07.849974 [info ] [MainThread]:   sslmode: verify-full
[0m11:53:07.850096 [info ] [MainThread]:   region: ap-southeast-2
[0m11:53:07.850207 [info ] [MainThread]:   autocreate: False
[0m11:53:07.850320 [info ] [MainThread]:   db_groups: []
[0m11:53:07.850432 [info ] [MainThread]:   ra3_node: True
[0m11:53:07.850545 [info ] [MainThread]:   connect_timeout: 100
[0m11:53:07.850655 [info ] [MainThread]:   role: None
[0m11:53:07.850765 [info ] [MainThread]:   retries: 1
[0m11:53:07.850874 [info ] [MainThread]:   autocommit: True
[0m11:53:07.850983 [info ] [MainThread]:   access_key_id: None
[0m11:53:07.851321 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m11:53:07.900606 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m11:53:07.903610 [debug] [MainThread]: Using redshift connection "debug"
[0m11:53:07.903782 [debug] [MainThread]: On debug: select 1 as id
[0m11:53:07.903918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:07.904066 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m11:53:07.906270 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:53:11.833148 [debug] [MainThread]: SQL status: SUCCESS in 3.929 seconds
[0m11:53:11.878776 [debug] [MainThread]: On debug: Close
[0m11:53:11.879222 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:53:11.879436 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:53:11.880815 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.318402, "process_in_blocks": "0", "process_kernel_time": 0.219437, "process_mem_max_rss": "133595136", "process_out_blocks": "0", "process_user_time": 0.784881}
[0m11:53:11.881118 [debug] [MainThread]: Command `dbt debug` succeeded at 11:53:11.881054 after 4.32 seconds
[0m11:53:11.881306 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:53:11.881504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103208e90>]}
[0m11:53:11.881733 [debug] [MainThread]: Flushing usage events
[0m11:53:12.948617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:42.014033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109295990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fd510>]}


============================== 11:53:42.016817 | 915dabc5-c38a-4ad5-92c9-156ee8256f2a ==============================
[0m11:53:42.016817 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:53:42.017154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --target dev_redshift', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:42.027709 [info ] [MainThread]: dbt version: 1.9.2
[0m11:53:42.027988 [info ] [MainThread]: python version: 3.11.10
[0m11:53:42.028158 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m11:53:42.028304 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m11:53:42.139083 [debug] [MainThread]: Redshift adapter: Setting redshift_connector to ERROR
[0m11:53:42.139441 [debug] [MainThread]: Redshift adapter: Setting redshift_connector.core to ERROR
[0m11:53:42.186289 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m11:53:42.186600 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m11:53:42.186761 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m11:53:42.187247 [info ] [MainThread]: adapter type: redshift
[0m11:53:42.187420 [info ] [MainThread]: adapter version: 1.9.0
[0m11:53:42.228905 [info ] [MainThread]: Configuration:
[0m11:53:42.229213 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:53:42.229360 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:53:42.229487 [info ] [MainThread]: Required dependencies:
[0m11:53:42.229679 [debug] [MainThread]: Executing "git --help"
[0m11:53:42.252573 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:53:42.253169 [debug] [MainThread]: STDERR: "b''"
[0m11:53:42.253354 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:53:42.253556 [info ] [MainThread]: Connection:
[0m11:53:42.253797 [info ] [MainThread]:   host: quyendinh-redshift-workgroup.841162668345.ap-southeast-2.redshift-serverless.amazonaws.com
[0m11:53:42.253929 [info ] [MainThread]:   user: quyendinh
[0m11:53:42.254054 [info ] [MainThread]:   port: 5439
[0m11:53:42.254236 [info ] [MainThread]:   database: dev
[0m11:53:42.254446 [info ] [MainThread]:   method: database
[0m11:53:42.254590 [info ] [MainThread]:   cluster_id: None
[0m11:53:42.254797 [info ] [MainThread]:   iam_profile: None
[0m11:53:42.254963 [info ] [MainThread]:   schema: public
[0m11:53:42.255098 [info ] [MainThread]:   sslmode: verify-full
[0m11:53:42.255222 [info ] [MainThread]:   region: ap-southeast-2
[0m11:53:42.255345 [info ] [MainThread]:   sslmode: verify-full
[0m11:53:42.255473 [info ] [MainThread]:   region: ap-southeast-2
[0m11:53:42.255623 [info ] [MainThread]:   autocreate: False
[0m11:53:42.255748 [info ] [MainThread]:   db_groups: []
[0m11:53:42.255868 [info ] [MainThread]:   ra3_node: True
[0m11:53:42.255984 [info ] [MainThread]:   connect_timeout: 100
[0m11:53:42.256097 [info ] [MainThread]:   role: None
[0m11:53:42.256211 [info ] [MainThread]:   retries: 1
[0m11:53:42.256322 [info ] [MainThread]:   autocommit: True
[0m11:53:42.256434 [info ] [MainThread]:   access_key_id: None
[0m11:53:42.256779 [info ] [MainThread]: Registered adapter: redshift=1.9.0
[0m11:53:42.306265 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m11:53:42.309323 [debug] [MainThread]: Using redshift connection "debug"
[0m11:53:42.309501 [debug] [MainThread]: On debug: select 1 as id
[0m11:53:42.309640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:42.309797 [debug] [MainThread]: Redshift adapter: Connecting to Redshift with 'database' credentials method
[0m11:53:42.312082 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'verify-full'.To connect without ssl, set `sslmode` to 'disable'.
[0m11:53:43.984856 [debug] [MainThread]: SQL status: SUCCESS in 1.675 seconds
[0m11:53:44.022448 [debug] [MainThread]: On debug: Close
[0m11:53:44.022991 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:53:44.023209 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:53:44.024580 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0470736, "process_in_blocks": "0", "process_kernel_time": 0.209783, "process_mem_max_rss": "135069696", "process_out_blocks": "0", "process_user_time": 0.811594}
[0m11:53:44.024886 [debug] [MainThread]: Command `dbt debug` succeeded at 11:53:44.024809 after 2.05 seconds
[0m11:53:44.025090 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:53:44.025313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092eca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104babfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3e5d0>]}
[0m11:53:44.025564 [debug] [MainThread]: Flushing usage events
[0m11:53:45.126935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:51.194335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e91cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef9950>]}


============================== 11:53:51.196451 | 75bc53f0-9a49-40f2-99df-1210bd598672 ==============================
[0m11:53:51.196451 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:53:51.196769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --target dev_postgres', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:51.201953 [info ] [MainThread]: dbt version: 1.9.2
[0m11:53:51.202163 [info ] [MainThread]: python version: 3.11.10
[0m11:53:51.202537 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m11:53:51.202707 [info ] [MainThread]: os info: macOS-15.1.1-arm64-arm-64bit
[0m11:53:51.231928 [info ] [MainThread]: Using profiles dir at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate
[0m11:53:51.232253 [info ] [MainThread]: Using profiles.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/profiles.yml
[0m11:53:51.232406 [info ] [MainThread]: Using dbt_project.yml file at /Users/dinhvietquyen1803/Data_Engineering/scrape_job/real_estate/dbt_project.yml
[0m11:53:51.232962 [info ] [MainThread]: adapter type: postgres
[0m11:53:51.233099 [info ] [MainThread]: adapter version: 1.9.0
[0m11:53:51.275144 [info ] [MainThread]: Configuration:
[0m11:53:51.275434 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:53:51.275574 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:53:51.275699 [info ] [MainThread]: Required dependencies:
[0m11:53:51.275881 [debug] [MainThread]: Executing "git --help"
[0m11:53:51.296616 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:53:51.297309 [debug] [MainThread]: STDERR: "b''"
[0m11:53:51.297504 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:53:51.297698 [info ] [MainThread]: Connection:
[0m11:53:51.297893 [info ] [MainThread]:   host: localhost
[0m11:53:51.298017 [info ] [MainThread]:   port: 5432
[0m11:53:51.298133 [info ] [MainThread]:   user: airflow
[0m11:53:51.298246 [info ] [MainThread]:   database: re
[0m11:53:51.298372 [info ] [MainThread]:   schema: public
[0m11:53:51.298487 [info ] [MainThread]:   connect_timeout: 10
[0m11:53:51.298605 [info ] [MainThread]:   role: None
[0m11:53:51.298722 [info ] [MainThread]:   search_path: None
[0m11:53:51.298837 [info ] [MainThread]:   keepalives_idle: 0
[0m11:53:51.298946 [info ] [MainThread]:   sslmode: None
[0m11:53:51.299059 [info ] [MainThread]:   sslcert: None
[0m11:53:51.299167 [info ] [MainThread]:   sslkey: None
[0m11:53:51.299281 [info ] [MainThread]:   sslrootcert: None
[0m11:53:51.299393 [info ] [MainThread]:   application_name: dbt
[0m11:53:51.299508 [info ] [MainThread]:   retries: 1
[0m11:53:51.299838 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:53:51.341973 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:53:51.363864 [debug] [MainThread]: Using postgres connection "debug"
[0m11:53:51.364086 [debug] [MainThread]: On debug: select 1 as id
[0m11:53:51.364223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:51.398989 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m11:53:51.399562 [debug] [MainThread]: On debug: Close
[0m11:53:51.399752 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:53:51.399920 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:53:51.400862 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.24156858, "process_in_blocks": "0", "process_kernel_time": 0.159023, "process_mem_max_rss": "122372096", "process_out_blocks": "0", "process_user_time": 0.690702}
[0m11:53:51.401115 [debug] [MainThread]: Command `dbt debug` succeeded at 11:53:51.401057 after 0.24 seconds
[0m11:53:51.401289 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:53:51.401494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b43fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509010>]}
[0m11:53:51.401713 [debug] [MainThread]: Flushing usage events
[0m11:53:52.410381 [debug] [MainThread]: An error was encountered while trying to flush usage events
